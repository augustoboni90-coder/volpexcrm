<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VOLPEX CRM ‚Äì PRO Dashboard (CRUD + CSV + PDF + Grafici)</title>
  <style>

    :root{
      --bg:#f5f7fb;
      --panel:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:#e6e9f0;

      --primary:#2563eb;
      --primary-2:#1d4ed8;
      --primary-soft:#eff6ff;

      --good:#16a34a;
      --warn:#f59e0b;
      --bad:#dc2626;

      --shadow: 0 10px 25px rgba(15, 23, 42, .06);
      --shadow-sm: 0 6px 16px rgba(15, 23, 42, .05);

      --radius:16px;
      --radius-sm:12px;
      --ring: 0 0 0 4px rgba(37, 99, 235, .12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    a{color:inherit}

    /* Layout */
    .app{display:flex;min-height:100vh}
    .sidebar{
      width:290px;
      background:linear-gradient(180deg,#0b1220 0%, #0b1220 55%, #0d172a 100%);
      color:#e5e7eb;
      padding:16px;
      position:sticky;top:0;height:100vh;overflow:auto;
      border-right:1px solid rgba(255,255,255,.06);
    }
    .main{flex:1;display:flex;flex-direction:column;min-width:0}

    .content{
      max-width: 100%;
      margin:0 auto;
      width:100%;
      padding:0 18px;
    }

    /* Sidebar header */
    .logo{
      font-weight:950;
      font-size:16px;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logoMark{
      width:34px;height:34px;border-radius:12px;
      display:grid;place-items:center;
      background:rgba(37,99,235,.18);
      border:1px solid rgba(37,99,235,.35);
      box-shadow: 0 8px 18px rgba(0,0,0,.22);
      font-weight:950;
      color:#bfdbfe;
    }
    .sub{color:rgba(229,231,235,.7);font-size:12px;margin:8px 0 12px}
    .pill{
      display:inline-flex;gap:6px;align-items:center;
      font-size:11px;border:1px solid rgba(191,219,254,.35);
      background:rgba(37,99,235,.12);
      color:#bfdbfe;padding:3px 10px;border-radius:999px;font-weight:900;
      margin-left:auto;
    }

    /* Sidebar nav */
    .nav{margin-top:12px;display:flex;flex-direction:column;gap:6px}
    .nav button{
      width:100%;
      padding:10px 12px;
      border:none;
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.06);
      border-radius:12px;
      text-align:left;
      cursor:pointer;
      color:rgba(229,231,235,.85);
      display:flex;
      gap:10px;
      align-items:center;
      transition: .15s ease;
    }
    .nav button:hover{
      transform: translateY(-1px);
      background:rgba(255,255,255,.06);
      border-color: rgba(191,219,254,.25);
    }
    .nav button.active{
      background:rgba(37,99,235,.14);
      border-color: rgba(191,219,254,.35);
      color:#bfdbfe;
      box-shadow: 0 8px 18px rgba(0,0,0,.18);
      position:relative;
    }
    .nav button.active::before{
      content:"";
      position:absolute;
      left:-16px;
      top:10px;
      bottom:10px;
      width:3px;
      border-radius:999px;
      background:#60a5fa;
    }

    .sideCard{
      margin-top:14px;
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      padding:12px;
      background:rgba(255,255,255,.03);
      backdrop-filter: blur(8px);
    }
    .kv{display:flex;justify-content:space-between;gap:10px;font-size:12px;color:rgba(229,231,235,.75);margin-top:8px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}

    /* Topbar */
    .topbar{
      position:sticky;
      top:0;
      z-index:10;
      background:rgba(245,247,251,.85);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--border);
      padding:14px 0;
    }
    .topbarInner{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }
    #pageTitle{margin:0;font-size:16px;letter-spacing:-.2px}
    .right{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

    /* Views */
    .view{display:none;padding:18px 0}
    .view.active{display:block}

    /* Cards */
    .grid{display:grid;gap:14px}
    .grid-2{grid-template-columns:repeat(auto-fit,minmax(420px,1fr))}
    .grid-3{grid-template-columns:repeat(auto-fit,minmax(360px,1fr))}
    .grid-4{grid-template-columns:repeat(auto-fit,minmax(230px,1fr))}

    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:14px;
      box-shadow: var(--shadow-sm);
    }
    .card h3{margin:0 0 8px 0;font-size:14px}
    .muted{color:var(--muted);font-size:12px}
    .smallNote{font-size:11px;color:var(--muted)}
    .hr{height:1px;background:var(--border);margin:12px 0}

    /* KPI */
    .kpi-label{font-size:12px;color:var(--muted)}
    .kpi-value{font-size:30px;font-weight:950;letter-spacing:-.7px;line-height:1.05}
    .kpi-sub{font-size:12px;color:var(--muted);margin-top:2px}

    /* Inputs */
    input,select,textarea{
      width:100%;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
      color:var(--text);
      outline:none;
      transition:.12s ease;
    }
    input:focus,select:focus,textarea:focus{
      border-color: rgba(37,99,235,.55);
      box-shadow: var(--ring);
    }
    textarea{min-height:88px;resize:vertical}

    /* Buttons */
    .btn{
      border:none;
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      cursor:pointer;
      transition: .12s ease;
      box-shadow:none;
    }
    .btn.primary{background:var(--primary);color:#fff}
    .btn.primary:hover{background:var(--primary-2);transform:translateY(-1px)}
    .btn.secondary{
      background:#fff;
      color:var(--text);
      border:1px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    .btn.secondary:hover{transform:translateY(-1px)}
    .btn.danger{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}
    .btn.danger:hover{transform:translateY(-1px)}
    .btn.small{padding:8px 12px;font-size:12px}

    /* Toolbar */
    .toolbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between
    }
    .toolbar .left,.toolbar .right{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    /* Tables */
    table{width:100%;border-collapse:separate;border-spacing:0;font-size:12.5px}
    th,td{padding:10px 10px;border-bottom:1px solid var(--border);vertical-align:top}
    th{
      color:var(--muted);
      text-align:left;
      font-weight:900;
      font-size:12px;
      white-space:nowrap;
      position:sticky;
      top:0;
      background:#fff;
      z-index:2;
    }
    tbody tr:hover{background:#f7f9ff}
    tbody tr:nth-child(even){background:rgba(241,245,249,.35)}
    .tableWrap{
      overflow:auto;
      border:1px solid var(--border);
      border-radius: var(--radius);
    }
    .tableWrap table{border-radius: var(--radius);}

    /* Badges */
    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:11px;
      padding:3px 10px;
      border-radius:999px;
      background:var(--primary-soft);
      color:#1d4ed8;
      font-weight:900;
      border:1px solid #c7d2fe
    }
    .badge.good{background:#dcfce7;color:#166534;border-color:#bbf7d0}
    .badge.warn{background:#fef9c3;color:#854d0e;border-color:#fde68a}
    .badge.bad{background:#fee2e2;color:#991b1b;border-color:#fecaca}

    /* Timeline */
    .timeline{border-left:3px solid var(--border);padding-left:14px}
    .tItem{margin:12px 0}
    .tTitle{font-weight:950}
    .tMeta{color:var(--muted);font-size:12px;margin-top:3px}

    /* Charts */
    canvas{width:100%;height:260px;border:1px solid var(--border);border-radius:14px;background:#fff}

    /* Toast */
    .toast{
      position:fixed;right:16px;bottom:16px;z-index:50;
      background:#0f172a;color:#fff;padding:10px 12px;border-radius:12px;
      box-shadow:0 10px 24px rgba(0,0,0,.15);max-width: 100%;display:none
    }
    .toast.show{display:block}

    /* Print */
    @media print{
      .sidebar,.topbar,.btn,.toolbar input[type="file"]{display:none!important}
      .view{display:block!important}
      body{background:#fff}
      .card{box-shadow:none;border:1px solid #ddd}
      th{position:static}
      canvas{height:220px}
    }

    /* Responsive */
    @media (max-width: 980px){
      .sidebar{position:fixed;left:-320px;top:0;bottom:0;z-index:40;transition:.2s ease}
      .sidebar.open{left:0}
      .grid-2{grid-template-columns:1fr}
      .grid-3{grid-template-columns:1fr}
      .content{padding:0 14px}
    }

  

/* ===== UX override v26: tab full-page + layout in colonna ===== */
.main, .container, .app, .wrap { max-width: 100% !important; width: 100% !important; }
.page, .tab, .tab-content, .tab-panel, .content, main { width: 100% !important; }
.grid, .grid-2, .grid-3, .row-grid, .two-col, .cols2 { 
  display: grid !important;
  grid-template-columns: 1fr !important;
  gap: 12px !important;
}
.row, .inline, .hstack { flex-wrap: wrap !important; }
.card { width: 100% !important; }
.tab-page, .tabPanel, .panel { width: 100% !important; }


/* ===== v27: Contrasto + page header ===== */
:root{
  --bg:#f1f5f9;
  --panel:#ffffff;
  --border:#cbd5e1;
  --border2:#94a3b8;
  --text:#0f172a;
  --muted:#334155;
  --muted2:#475569;
}
body{ background:var(--bg) !important; color:var(--text) !important; }
.muted{ color:var(--muted2) !important; }
.card, .panel, .tableWrap, .box, .modal__panel, .modal__body, .sectionCard{
  background:var(--panel) !important;
  border-color:var(--border) !important;
}
.card{ box-shadow: 0 6px 18px rgba(2,6,23,.08) !important; }
input, select, textarea{
  border-color: var(--border2) !important;
  background:#ffffff !important;
  color:var(--text) !important;
}
input::placeholder, textarea::placeholder{ color:#64748b !important; }
table th{
  background:#e2e8f0 !important;
  color:var(--text) !important;
  border-bottom:1px solid var(--border) !important;
}
table td{ border-bottom:1px solid #e2e8f0 !important; }
.btn{ border-color: var(--border2) !important; }
.btn-ghost{ background:#ffffff !important; }
.pagehead{
  display:flex; align-items:flex-end; justify-content:space-between;
  gap:12px; padding:14px 14px; margin: 0 0 12px 0;
  border:1px solid var(--border); border-radius:14px; background: #ffffff;
}
.pagehead h2{ margin:0; font-size:18px; letter-spacing:.2px; }
.pagehead p{ margin:6px 0 0 0; font-size:12.5px; color:var(--muted2); }
.pagehead__actions{ display:flex; gap:8px; flex-wrap:wrap; }
</style>
</head>

<body>
<div class="app">
  <aside class="sidebar">
    <div class="logo">VOLPEX CRM <span class="pill">PRO</span></div>
    <div class="sub">CRUD ‚Ä¢ Import CSV smart ‚Ä¢ Export CSV/PDF ‚Ä¢ Report ‚Ä¢ Grafici ‚Ä¢ Timeline</div>

    <div class="nav">
      <button class="active" data-view="dashboard">üìä Dashboard</button>
      <button data-view="console30">üñ• Console 30 giorni</button>
      <button data-view="anagrafica">üë§ Anagrafica (CRUD)</button>
      <button data-view="contratti">üìÑ Contratti (CRUD completo)</button>
      <button data-view="device">üì± Device (CRUD)</button>
      <button data-view="riparazioni">üõ† Riparazioni (CRUD)</button>
      <button data-view="report">üìà Report avanzati</button>
      <button data-view="timeline">üïí Timeline cliente</button>
      <button data-view="importexport">‚¨ÜÔ∏è‚¨áÔ∏è Import / Export</button>
    </div>

    <div class="sideCard">
      <div class="muted">Stato ambiente</div>
      <div class="kv"><span>Modalit√†</span><b id="envMode">DEMO (localStorage)</b></div>
      <div class="kv"><span>Ultimo refresh</span><b id="lastSync" class="mono">‚Äî</b></div>
      <div class="kv"><span>Record totali</span><b id="totalRecords">‚Äî</b></div>
      <div class="kv"><span>PK/FK</span><span class="muted">CF = chiave</span></div>
    </div>

    <div class="sideCard">
      <div class="muted">Azioni rapide</div>
      <div class="row" style="margin-top:10px">
        <button class="btn secondary small" id="btnResetDemo">Reset demo</button>
        <button class="btn primary small" id="btnSaveNow">Salva</button>
      </div>
      <div class="smallNote" style="margin-top:8px">
        Salvataggio automatico su localStorage. Reset = ripristina i dati fittizi.
      </div>
    </div>
  </aside>

  <main class="main">
    <div class="content">
    <header class="topbar"><div class="content topbarInner">
      <b id="pageTitle">Dashboard</b>
      <div class="right">
        <button class="btn secondary small" id="btnRefresh">‚Üª Refresh</button>
        <button class="btn secondary small" id="btnPrint">Stampa / PDF</button>
      </div>
    </div></header>

    <!-- DASHBOARD -->
    <section id="view-dashboard" class="view active">
      <div class="grid grid-4">
        <div class="card">
          <div class="kpi-label">Contratti ultimi 30gg</div>
          <div class="kpi-value" id="kpiContratti30">‚Äî</div>
          <div class="kpi-sub" id="kpiContrattiSub">‚Äî</div>
        </div>
        <div class="card">
          <div class="kpi-label">Device venduti ultimi 30gg</div>
          <div class="kpi-value" id="kpiDevice30">‚Äî</div>
          <div class="kpi-sub" id="kpiDeviceSub">‚Äî</div>
        </div>
        <div class="card">
          <div class="kpi-label">Riparazioni ultimi 30gg</div>
          <div class="kpi-value" id="kpiRip30">‚Äî</div>
          <div class="kpi-sub" id="kpiRipSub">‚Äî</div>
        </div>
        <div class="card">
          <div class="kpi-label">Clienti (Anagrafica)</div>
          <div class="kpi-value" id="kpiClienti">‚Äî</div>
          <div class="kpi-sub" id="kpiClientiSub">‚Äî</div>
        </div>
      </div>

      <div class="grid grid-2" style="margin-top:14px">
        <div class="card">
          <h3>Grafico a torta: attivit√† 30gg per tipo</h3>
          <div class="muted">Torta = distribuzione tra contratti, device e riparazioni negli ultimi 30 giorni.</div>
          <canvas id="chartDaily"></canvas>
        </div>

        <div class="card">
          <h3>Grafico a torta: Top venditori (30gg)</h3>
          <div class="muted">Torta = quota di contratti + device per venditore negli ultimi 30 giorni.</div>
          <canvas id="chartSellers"></canvas>
        </div>
      </div>

      <div class="grid grid-2" style="margin-top:14px">
        <div class="card">
          <h3>Grafico a torta: contratti per compagnia (30gg)</h3>
          <div class="muted">Torta = quota contratti per compagnia negli ultimi 30 giorni.</div>
          <canvas id="chartCompanies"></canvas>
        </div>

        <div class="card">
          <h3>Riepilogo economico (30gg)</h3>
          <div class="muted">Somme su device venduti + riparazioni (se presenti prezzo/costo).</div>
          <div class="grid grid-2" style="margin-top:10px">
            <div class="card" style="border-style:dashed">
              <div class="kpi-label">Totale ‚Ç¨ Device</div>
              <div class="kpi-value" id="kpiDeviceEur">‚Äî</div>
            </div>
            <div class="card" style="border-style:dashed">
              <div class="kpi-label">Totale ‚Ç¨ Riparazioni</div>
              <div class="kpi-value" id="kpiRipEur">‚Äî</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CONSOLE 30 -->
    <section id="view-console30" class="view">
      <div class="card">
        <h3>Console ultimi 30 giorni</h3>
        <div class="muted">Vista completa: contratti, device, riparazioni negli ultimi 30gg.</div>
      </div>

      <div class="grid grid-3" style="margin-top:14px">
        <div class="card">
          <div class="row" style="justify-content:space-between">
            <h3>üìÑ Contratti (30gg)</h3>
            <span class="badge" id="badgeContratti30">‚Äî</span>
          </div>
          <div class="tableWrap">
            <table id="tblContratti30">
              <thead><tr><th>Data</th><th>ID</th><th>CF</th><th>Cliente</th><th>Compagnia</th><th>Offerta</th><th>Tecnologia</th><th>MNP</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <div class="row" style="justify-content:space-between">
            <h3>üì± Device (30gg)</h3>
            <span class="badge good" id="badgeDevice30">‚Äî</span>
          </div>
          <div class="tableWrap">
            <table id="tblDevice30">
              <thead><tr><th>Data</th><th>ID</th><th>CF</th><th>Cliente</th><th>Modello</th><th>IMEI</th><th>Prezzo</th><th>Venditore</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <div class="row" style="justify-content:space-between">
            <h3>üõ† Riparazioni (30gg)</h3>
            <span class="badge warn" id="badgeRip30">‚Äî</span>
          </div>
          <div class="tableWrap">
            <table id="tblRip30">
              <thead><tr><th>Ingresso</th><th>ID</th><th>CF</th><th>Cliente</th><th>Modello</th><th>Problema</th><th>Stato</th><th>Costo</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ANAGRAFICA CRUD -->
    <section id="view-anagrafica" class="view">
      <div class="card">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Anagrafica clienti (PK = CF)</h3>
            <span class="muted">Inserisci/Modifica/Elimina</span>
          </div>
          <div class="right">
            <input id="searchAnag" placeholder="Cerca (CF / nome / telefono / email / citt√†)" style="min-width:280px"/>
            <button class="btn secondary small" id="btnExportAnagCsv">Export CSV</button>
          </div>
        </div>
        <div class="hr"></div>

        <div class="grid grid-4">
          <input id="a_cf" placeholder="Codice Fiscale *"/>
          <input id="a_nome" placeholder="Nome *"/>
          <input id="a_cognome" placeholder="Cognome *"/>
          <input id="a_citta" placeholder="Citt√†"/>
          <input id="a_telefono" placeholder="Telefono"/>
          <input id="a_email" placeholder="Email"/>
          <input id="a_indirizzo" placeholder="Indirizzo"/>
          <input id="a_data_nascita" type="date" placeholder="Data nascita"/>
          <select id="a_tipo">
            <option value="">Tipo cliente</option>
            <option>PRIVATO</option>
            <option>BUSINESS</option>
          </select>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn primary" id="btnSaveAnag">Salva (Upsert)</button>
          <button class="btn secondary" id="btnClearAnag">Pulisci</button>
          <span class="muted">* obbligatori ‚Ä¢ CF viene normalizzato in MAIUSCOLO</span>
        </div>
      </div>

      <div class="card" style="overflow:auto">
        <h3>Clienti</h3>
        <table id="tblAnag">
          <thead>
            <tr>
              <th>CF</th><th>Nome</th><th>Cognome</th><th>Tipo</th><th>Telefono</th><th>Email</th><th>Citt√†</th><th>Azioni</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    
      <div class="card" id="clientSheetCard">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Scheda Cliente (azioni rapide)</h3>
            <span class="muted">Cerca CF e inserisci operazioni senza uscire dalla scheda</span>
          </div>
          <div class="right">
            <input id="cs_search_cf" placeholder="Inserisci CF e premi Cerca" style="min-width:260px"/>
            <button class="btn primary small" id="btnClientLoad">Cerca</button>
          </div>
        </div>

        <div class="hr"></div>

        <div id="cs_summary" class="muted">Nessun cliente selezionato.</div>
        <div class="row" style="margin-top:10px">
          <a id="cs_whatsapp" class="btn secondary small" target="_blank" rel="noopener" style="text-decoration:none;display:none">üí¨ WhatsApp</a>
          <button class="btn secondary small" id="btnClientGoTimeline" style="display:none">üïí Apri Timeline</button>
        </div>

        <div class="hr"></div>

        <div class="grid grid-3">
          <div class="card" style="border-style:dashed">
            <h3>+ Nuovo Contratto</h3>
            <div class="grid grid-2">
              <input id="cs_c_id" placeholder="ID contratto (auto)"/>
              <input id="cs_c_data" type="date"/>
              <input id="cs_c_compagnia" placeholder="Compagnia"/>
              <input id="cs_c_offerta" placeholder="Nome offerta"/>
              <input id="cs_c_numero" placeholder="Numero lavorato"/>
              <select id="cs_c_mnp">
                <option value="">MNP</option>
                <option>SI</option>
                <option>NO</option>
              </select>
            </div>
            <div class="row" style="margin-top:10px">
              <button class="btn primary small" id="btnCS_SaveCon">Salva</button>
              <button class="btn secondary small" id="btnCS_OpenCon">Apri modulo completo</button>
            </div>
          </div>

          <div class="card" style="border-style:dashed">
            <h3>+ Nuovo Device</h3>
            <div class="grid grid-2">
              <input id="cs_d_id" placeholder="ID device (auto)"/>
              <input id="cs_d_data" type="date"/>
              <input id="cs_d_modello" placeholder="Modello *"/>
              <input id="cs_d_imei" placeholder="IMEI"/>
              <input id="cs_d_prezzo" type="number" step="0.01" placeholder="Prezzo (‚Ç¨)"/>
              <input id="cs_d_venditore" placeholder="Venditore"/>
            </div>
            <div class="row" style="margin-top:10px">
              <button class="btn primary small" id="btnCS_SaveDev">Salva</button>
              <button class="btn secondary small" id="btnCS_OpenDev">Apri modulo completo</button>
            </div>
          </div>

          <div class="card" style="border-style:dashed">
            <h3>+ Nuova Riparazione</h3>
            <div class="grid grid-2">
              <input id="cs_r_id" placeholder="ID riparazione (auto)"/>
              <input id="cs_r_data" type="date"/>
              <input id="cs_r_modello" placeholder="Modello *"/>
              <input id="cs_r_imei" placeholder="IMEI"/>
              <input id="cs_r_problema" placeholder="Problema"/>
              <select id="cs_r_stato">
                <option value="">Stato</option>
                <option>APERTA</option>
                <option>IN LAVORAZIONE</option>
                <option>PRONTA</option>
                <option>CONSEGNATA</option>
              </select>
              <input id="cs_r_costo" type="number" step="0.01" placeholder="Costo (‚Ç¨)"/>
            </div>
            <div class="row" style="margin-top:10px">
              <button class="btn primary small" id="btnCS_SaveRip">Salva</button>
              <button class="btn secondary small" id="btnCS_OpenRip">Apri modulo completo</button>
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="grid grid-3">
          <div class="card">
            <h3>Ultimi contratti cliente</h3>
            <div class="tableWrap">
              <table id="cs_tbl_con">
                <thead><tr><th>Data</th><th>Compagnia</th><th>Offerta</th><th>MNP</th></tr></thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
          <div class="card">
            <h3>Ultimi device cliente</h3>
            <div class="tableWrap">
              <table id="cs_tbl_dev">
                <thead><tr><th>Data</th><th>Modello</th><th>IMEI</th><th>Prezzo</th></tr></thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
          <div class="card">
            <h3>Ultime riparazioni cliente</h3>
            <div class="tableWrap">
              <table id="cs_tbl_rip">
                <thead><tr><th>Ingresso</th><th>Modello</th><th>Stato</th><th>Costo</th></tr></thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

</section>

    <!-- CONTRATTI CRUD COMPLETO -->
    <section id="view-contratti" class="view">
      <div class="card">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Contratti (FK = CF) ‚Äì CRUD completo</h3>
            <span class="muted">Tutti i campi del tuo Google Sheet</span>
          </div>
          <div class="right">
            <input id="searchCon" placeholder="Cerca (CF / compagnia / offerta / IMEI / ICCID / numero / MNP)" style="min-width:340px"/>
            <button class="btn secondary small" id="btnExportConCsv">Export CSV</button>
          </div>
        </div>

        <div class="hr"></div>
        <div class="hint">
          Suggerimento: i campi <b>SI/NO</b> e le dropdown sono gi√† ‚Äúguidate‚Äù. Tutto viene salvato in MAIUSCOLO (dove sensato).
        </div>

        <div class="hr"></div>
        
        <div class="grid grid-2">
          <div class="card" style="border-style:dashed">
            <h3 style="margin:0 0 8px 0">1) Cliente</h3>
            <div class="muted">Prima cerca per <b>Codice Fiscale</b>. Se non esiste, compila l‚Äôanagrafica veloce sotto.</div>

            <div class="row" style="margin-top:10px;align-items:flex-end">
              <div style="flex:2;min-width:220px">
                <div class="muted" style="margin-bottom:6px">Codice fiscale *</div>
                <input id="c_cf" placeholder="Codice fiscale (FK)"/>
              </div>
              <button class="btn secondary" id="btnConFindClient" type="button">Cerca cliente</button>
            </div>
            <div id="c_cf_status" class="smallNote" style="margin-top:8px">Inserisci CF e premi ‚ÄúCerca cliente‚Äù.</div>

            
            <div class="hr"></div>

            <h3 style="margin:12px 0 6px 0">2) Contratto & Offerta</h3>
            <div class="muted">Compila i dati dell‚Äôattivazione. I campi essenziali sono evidenziati con *.</div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">ID contratto</div>
                <input id="c_id" placeholder="Auto se vuoto"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">ID cliente</div>
                <input id="c_id_cliente" placeholder="Es. C001"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Data contratto *</div>
                <input id="c_data_contratto" type="date"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Tipo cliente</div>
                <select id="c_tipo_cliente">
                  <option value="">Seleziona</option>
                  <option>PRIVATO</option>
                  <option>BUSINESS</option>
                </select>
              </div>
            </div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">Compagnia *</div>
                <select id="c_compagnia">

                  <option value="">Seleziona</option>
              <option>TIM</option>
              <option>VODAFONE</option>
              <option>WINDTRE</option>
              <option>ILIAD</option>
              <option>FASTWEB</option>
              <option>POSTEMOBILE</option>
              <option>HO.</option>
              <option>KENA</option>
              <option>VERY MOBILE</option>
              <option>COOPVOCE</option>
              <option>LYCAMOBILE</option>
              <option>SPUSU</option>
              <option>1MOBILE</option>
              <option>OPTIMA MOBILE</option>
              <option>TISCALI MOBILE</option>
              <option>RABONA</option>
              <option>DAILY TELECOM</option>
              <option>FEDER MOBILE</option>
              <option>NO.VA</option>
              <option>SKY</option>
              <option>EOLO</option>
              <option>LINKEM</option>
              <option>OPEN FIBER</option>
              <option>FIBERCOP</option>
              <option>ALTRO</option>
                
                </select>
              </div>

              <div>
                <div class="muted" style="margin-bottom:6px">Tecnologia *</div>
                <select id="c_tecnologia">
                  <option value="">Seleziona</option>
                  <option>SIM</option>
                  <option>FTTC</option>
                  <option>FTTH</option>
                  <option>FWA</option>
                </select>
              </div>

              <div>
                <div class="muted" style="margin-bottom:6px">Tipo attivazione</div>
                <select id="c_tipo_attivazione">
                  <option value="">Seleziona</option>
                  <option>NUOVA</option>
                  <option>MNP</option>
                  <option>MIGRAZIONE</option>
                  <option>SUBENTRO</option>
                  <option>UPGRADE</option>
                </select>
              </div>

              <div>
                <div class="muted" style="margin-bottom:6px">Convergenza</div>
                <select id="c_convergenza">
                  <option value="">Seleziona</option>
                  <option>SI</option>
                  <option>NO</option>
                </select>
              </div>
            </div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">Nome offerta</div>
                <input id="c_nome_offerta" placeholder="Es. OFFERTA X"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Costo offerta (‚Ç¨/mese)</div>
                <input id="c_costo_offerta" type="number" step="0.01" placeholder="Es. 9.99"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Vincolo (mesi)</div>
                <input id="c_vincolo_offerta_mesi" type="number" step="1" placeholder="Es. 24"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Tipo pagamento</div>
                <select id="c_tipo_pagamento">
                  <option value="">Seleziona</option>
                  <option>CREDITO RESIDUO</option>
                  <option>SDD</option>
                  <option>CARTA DI CREDITO</option>
                </select>
              </div>
            </div>

            <h3 style="margin:14px 0 6px 0">3) Numero, MNP & SIM</h3>
            <div class="muted">Usa MNP e provenienza solo se necessario. ICCID nuovo √® consigliato.</div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">Numero lavorato</div>
                <input id="c_numero_lavorato" placeholder="Es. 3331234567"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">MNP</div>
                <select id="c_mnp">
                  <option value="">Seleziona</option>
                  <option>SI</option>
                  <option>NO</option>
                </select>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Compagnia di provenienza</div>
                <select id="c_compagnia_provenienza">

                  <option value="">Seleziona</option>
              <option>TIM</option>
              <option>VODAFONE</option>
              <option>WINDTRE</option>
              <option>ILIAD</option>
              <option>FASTWEB</option>
              <option>POSTEMOBILE</option>
              <option>HO.</option>
              <option>KENA</option>
              <option>VERY MOBILE</option>
              <option>COOPVOCE</option>
              <option>LYCAMOBILE</option>
              <option>SPUSU</option>
              <option>1MOBILE</option>
              <option>OPTIMA MOBILE</option>
              <option>TISCALI MOBILE</option>
              <option>RABONA</option>
              <option>DAILY TELECOM</option>
              <option>FEDER MOBILE</option>
              <option>NO.VA</option>
              <option>SKY</option>
              <option>EOLO</option>
              <option>LINKEM</option>
              <option>OPEN FIBER</option>
              <option>FIBERCOP</option>
              <option>ALTRO</option>
                
                </select>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">ICCID vecchio</div>
                <input id="c_iccid_vecchio" placeholder="Es. 8939..."/>
              </div>
            </div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">ICCID nuovo</div>
                <input id="c_iccid_nuovo" placeholder="Es. 8939..."/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Data attivazione</div>
                <input id="c_data_attivazione" type="date"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Data portabilit√†</div>
                <input id="c_data_portabilita" type="date"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Venditore</div>
                <input id="c_venditore" placeholder="Es. AUGUSTO"/>
              </div>
            </div>

            <h3 style="margin:14px 0 6px 0">4) Telefono incluso & rate</h3>
            <div class="muted">Compila questa sezione solo se √® incluso un telefono o un pagamento rateale.</div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">Telefono incluso</div>
                <select id="c_telefono_incluso">
                  <option value="">Seleziona</option>
                  <option>SI</option>
                  <option>NO</option>
                </select>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">IMEI</div>
                <input id="c_imei" placeholder="15 cifre"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Marca</div>
                <input id="c_marca" placeholder="Es. APPLE"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Modello</div>
                <input id="c_modello" placeholder="Es. IPHONE 13"/>
              </div>
            </div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">Mesi vincolo telefono</div>
                <input id="c_mesi_vincolo_telefono" type="number" step="1" placeholder="Es. 24"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Pagamento rate telefono</div>
                <select id="c_modalita_pagamento_rate">
                  <option value="">Seleziona</option>
                  <option>CONTO CORRENTE</option>
                  <option>CARTA DI CREDITO</option>
                  <option>COMPASS</option>
                  <option>FINDOMESTIC</option>
                </select>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Anticipo (‚Ç¨)</div>
                <input id="c_anticipo" type="number" step="0.01" placeholder="Es. 0"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">Data fine vincolo offerta</div>
                <input id="c_data_fine_vincolo_offerta" type="date"/>
              </div>
            </div>

            <div class="grid grid-4" style="margin-top:10px">
              <div>
                <div class="muted" style="margin-bottom:6px">Data fine vincolo telefono</div>
                <input id="c_data_fine_vincolo_telefono" type="date"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">created_at</div>
                <input id="c_created_at" placeholder="Auto o import CSV"/>
              </div>
              <div>
                <div class="muted" style="margin-bottom:6px">updated_at</div>
                <input id="c_updated_at" placeholder="Auto o import CSV"/>
              </div>
              <div></div>
            </div>

            <div id="c_modem_box" class="card" style="border-style:dashed; display:none; margin-top:12px">
              <h3 style="margin:0 0 6px 0">5) Modem (solo FTTC/FTTH/FWA)</h3>
              <div class="muted">Se tecnologia √® FTTC/FTTH/FWA, indica chi spedisce il modem.</div>
              <div class="grid grid-2" style="margin-top:10px">
                <div>
                  <div class="muted" style="margin-bottom:6px">Modem spedito da *</div>
                  <select id="c_modem_spedito_da">
                    <option value="">Seleziona</option>
                    <option>WINDTRE</option>
                    <option>KOLME</option>
                  </select>
                </div>
                <div></div>
              </div>
            </div>

<div id="conQuickAnag"
 class="card" style="border-style:dashed; display:none; margin-top:12px">
          <h3>Cliente non trovato: inserisci Anagrafica (veloce)</h3>
          <div class="muted">Verr√† creato il cliente e poi potrai salvare subito il contratto.</div>
          <div class="grid grid-4" style="margin-top:10px">
            <input id="qa_cf" placeholder="Codice fiscale *" disabled/>
            <input id="qa_nome" placeholder="Nome *"/>
            <input id="qa_cognome" placeholder="Cognome *"/>
            <select id="qa_tipo">
              <option value="">Tipo cliente</option>
              <option>PRIVATO</option>
              <option>BUSINESS</option>
            </select>
            <input id="qa_telefono" placeholder="Telefono"/>
            <input id="qa_email" placeholder="Email"/>
            <input id="qa_citta" placeholder="Citt√†"/>
            <input id="qa_indirizzo" placeholder="Indirizzo"/>
            <input id="qa_data_nascita" type="date" placeholder="Data nascita"/>
          </div>
          <div class="row" style="margin-top:10px">
            <button class="btn primary small" id="btnQASave">Crea cliente</button>
            <button class="btn secondary small" id="btnQACancel">Annulla</button>
          </div>
        </div>


        <div class="row" style="margin-top:12px">
          <button class="btn primary" id="btnSaveCon">Salva</button>
          <button class="btn secondary" id="btnClearCon">Pulisci</button>
          <button class="btn secondary" id="btnPrintConReceipt" type="button" disabled>Stampa ricevuta</button>
          <span class="muted">FK: il CF deve esistere in Anagrafica</span>
        </div>
      </div>

      <div class="card" style="overflow:auto">
        <h3>Contratti</h3>
        <table id="tblCon">
          <thead>
            <tr>
              <th>ID</th><th>ID cliente</th><th>Data</th><th>CF</th><th>Cliente</th><th>Compagnia</th><th>Offerta</th><th>Tecnologia</th><th>MNP</th><th>Numero</th><th>IMEI</th><th>ICCID nuovo</th><th>Azioni</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- DEVICE CRUD -->
    <section id="view-device" class="view">
      <div class="card">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Vendita Device (FK = CF)</h3>
            <span class="muted">Prezzo incluso nei grafici/metriche</span>
          </div>
          <div class="right">
            <input id="searchDev" placeholder="Cerca (CF / modello / IMEI / venditore)" style="min-width:320px"/>
            <button class="btn secondary small" id="btnExportDevCsv">Export CSV</button>
          </div>
        </div>
        
        <div class="hr"></div>

        <div class="card" style="border-style:dashed">
          <h3 style="margin:0 0 8px 0">1) Cliente</h3>
          <div class="muted">Cerca per <b>Codice Fiscale</b>. Se non esiste, crea l‚Äôanagrafica veloce.</div>

          <div class="row" style="margin-top:10px;align-items:flex-end">
            <div style="flex:2;min-width:220px">
              <div class="muted" style="margin-bottom:6px">Codice fiscale *</div>
              <input id="d_cf" placeholder="Codice fiscale (FK)"/>
            </div>
            <button class="btn secondary" id="btnDevFindClient" type="button">Cerca cliente</button>
          </div>
          <div id="d_cf_status" class="smallNote" style="margin-top:8px">Inserisci CF e premi ‚ÄúCerca cliente‚Äù.</div>
        </div>

        <div id="devQuickAnag" class="card" style="border-style:dashed; display:none; margin-top:12px">
          <h3>Cliente non trovato: inserisci Anagrafica (veloce)</h3>
          <div class="muted">Verr√† creato il cliente e poi potrai salvare subito la vendita device.</div>
          <div class="grid grid-4" style="margin-top:10px">
            <input id="qd_cf" placeholder="Codice fiscale *" disabled/>
            <input id="qd_nome" placeholder="Nome *"/>
            <input id="qd_cognome" placeholder="Cognome *"/>
            <select id="qd_tipo">
              <option value="">Tipo cliente</option>
              <option>PRIVATO</option>
              <option>BUSINESS</option>
            </select>
            <input id="qd_telefono" placeholder="Telefono"/>
            <input id="qd_email" placeholder="Email"/>
            <input id="qd_citta" placeholder="Citt√†"/>
            <input id="qd_indirizzo" placeholder="Indirizzo"/>
            <input id="qd_data_nascita" type="date" placeholder="Data nascita"/>
          </div>
          <div class="row" style="margin-top:10px">
            <button class="btn primary" id="btnDevCreateClient" type="button">Crea cliente</button>
            <button class="btn secondary" id="btnDevCancelCreate" type="button">Annulla</button>
          </div>
        </div>

        <div class="card" style="border-style:dashed; margin-top:12px">
          <h3 style="margin:0 0 8px 0">2) Dettagli vendita device</h3>
          <div class="grid grid-4" style="margin-top:10px">
            <div>
              <div class="muted" style="margin-bottom:6px">ID vendita</div>
              <input id="d_id" placeholder="Auto se vuoto"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Data vendita *</div>
              <input id="d_data" type="date"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Modello *</div>
              <input id="d_modello" placeholder="Es. IPHONE 13"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">IMEI</div>
              <input id="d_imei" placeholder="15 cifre"/>
            </div>
          </div>

          <div class="grid grid-4" style="margin-top:10px">
            <div>
              <div class="muted" style="margin-bottom:6px">Prezzo (‚Ç¨)</div>
              <input id="d_prezzo" type="number" step="0.01" placeholder="Es. 699"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Venditore</div>
              <input id="d_venditore" placeholder="Es. AUGUSTO"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Tipo pagamento</div>
              <select id="d_pagamento">
                <option value="">Seleziona</option>
                <option>CARTA</option>
                <option>BANCOMAT</option>
                <option>CONTANTI</option>
                <option>FATTURA</option>
              </select>
            </div>
            <div></div>
          </div>

          <div class="row" style="margin-top:12px">
            <button class="btn primary" id="btnSaveDev">Salva</button>
            <button class="btn secondary" id="btnClearDev">Pulisci</button>
            <button class="btn secondary" id="btnPrintDevReceipt" type="button" disabled>Stampa ricevuta</button>
            <span class="muted">FK: il CF deve esistere in Anagrafica</span>
          </div>
        </div>
<div class="card" style="overflow:auto">
        <h3>Device venduti</h3>
        <table id="tblDev">
          <thead>
            <tr>
              <th>ID</th><th>Data</th><th>CF</th><th>Cliente</th><th>Modello</th><th>IMEI</th><th>Prezzo</th><th>Venditore</th><th>Azioni</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- RIPARAZIONI CRUD -->
    <section id="view-riparazioni" class="view">
      <div class="card">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Riparazioni (FK = CF)</h3>
            <span class="muted">Stati + costi per report</span>
          </div>
          <div class="right">
            <input id="searchRip" placeholder="Cerca (CF / modello / problema / stato / IMEI)" style="min-width:340px"/>
            <button class="btn secondary small" id="btnExportRipCsv">Export CSV</button>
          </div>
        </div>
        
        <div class="hr"></div>

        <div class="card" style="border-style:dashed">
          <h3 style="margin:0 0 8px 0">1) Cliente</h3>
          <div class="muted">Cerca per <b>Codice Fiscale</b>. Se non esiste, crea l‚Äôanagrafica veloce.</div>

          <div class="row" style="margin-top:10px;align-items:flex-end">
            <div style="flex:2;min-width:220px">
              <div class="muted" style="margin-bottom:6px">Codice fiscale *</div>
              <input id="r_cf" placeholder="Codice fiscale (FK)"/>
            </div>
            <button class="btn secondary" id="btnRipFindClient" type="button">Cerca cliente</button>
          </div>
          <div id="r_cf_status" class="smallNote" style="margin-top:8px">Inserisci CF e premi ‚ÄúCerca cliente‚Äù.</div>
        </div>

        <div id="ripQuickAnag" class="card" style="border-style:dashed; display:none; margin-top:12px">
          <h3>Cliente non trovato: inserisci Anagrafica (veloce)</h3>
          <div class="muted">Verr√† creato il cliente e poi potrai salvare subito la riparazione.</div>
          <div class="grid grid-4" style="margin-top:10px">
            <input id="qr_cf" placeholder="Codice fiscale *" disabled/>
            <input id="qr_nome" placeholder="Nome *"/>
            <input id="qr_cognome" placeholder="Cognome *"/>
            <select id="qr_tipo">
              <option value="">Tipo cliente</option>
              <option>PRIVATO</option>
              <option>BUSINESS</option>
            </select>
            <input id="qr_telefono" placeholder="Telefono"/>
            <input id="qr_email" placeholder="Email"/>
            <input id="qr_citta" placeholder="Citt√†"/>
            <input id="qr_indirizzo" placeholder="Indirizzo"/>
            <input id="qr_data_nascita" type="date" placeholder="Data nascita"/>
          </div>
          <div class="row" style="margin-top:10px">
            <button class="btn primary" id="btnRipCreateClient" type="button">Crea cliente</button>
            <button class="btn secondary" id="btnRipCancelCreate" type="button">Annulla</button>
          </div>
        </div>

        <div class="card" style="border-style:dashed; margin-top:12px">
          <h3 style="margin:0 0 8px 0">2) Dettagli riparazione</h3>

          <div class="grid grid-4" style="margin-top:10px">
            <div>
              <div class="muted" style="margin-bottom:6px">ID riparazione</div>
              <input id="r_id" placeholder="Auto se vuoto"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Data ingresso *</div>
              <input id="r_ingresso" type="date"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Modello *</div>
              <input id="r_modello" placeholder="Es. IPHONE 13"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">IMEI</div>
              <input id="r_imei" placeholder="15 cifre"/>
            </div>
          </div>

          <div class="grid grid-4" style="margin-top:10px">
            <div style="grid-column: span 2;">
              <div class="muted" style="margin-bottom:6px">Problema</div>
              <input id="r_problema" placeholder="Es. DISPLAY ROTTO"/>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Stato</div>
              <select id="r_stato">
                <option value="">Seleziona</option>
                <option>APERTA</option>
                <option>IN LAVORAZIONE</option>
                <option>PRONTA</option>
                <option>CONSEGNATA</option>
              </select>
            </div>
            <div>
              <div class="muted" style="margin-bottom:6px">Costo (‚Ç¨)</div>
              <input id="r_costo" type="number" step="0.01" placeholder="Es. 49"/>
            </div>
          </div>

          <div class="row" style="margin-top:12px">
            <button class="btn primary" id="btnSaveRip">Salva</button>
            <button class="btn secondary" id="btnClearRip">Pulisci</button>
            <button class="btn secondary" id="btnPrintRipReceipt" type="button" disabled>Stampa ricevuta</button>
            <span class="muted">FK: il CF deve esistere in Anagrafica</span>
          </div>
        </div>
<div class="card" style="overflow:auto">
        <h3>Riparazioni</h3>
        <table id="tblRip">
          <thead>
            <tr>
              <th>ID</th><th>Ingresso</th><th>CF</th><th>Cliente</th><th>Modello</th><th>Problema</th><th>Stato</th><th>Costo</th><th>Azioni</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- REPORT -->
    <section id="view-report" class="view">
      <div class="card">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Report avanzati (super filtri)</h3>
            <span class="muted">Unifica Anagrafica + Contratti + Device + Riparazioni</span>
          </div>
          <div class="right">
            <button class="btn secondary small" id="btnResetReport">Reset</button>
            <button class="btn primary small" id="btnRunReport">Applica filtri</button>
            <button class="btn secondary small" id="btnExportReportCsv">Export CSV</button>
            <button class="btn secondary small" id="btnExportReportPdf">Export PDF</button>
          </div>
        </div>

        <div class="grid grid-4" style="margin-top:10px">
          <select id="f_tipo">
            <option value="">Tipo: Tutti</option>
            <option value="CONTRATTO">Contratti</option>
            <option value="DEVICE">Device</option>
            <option value="RIPARAZIONE">Riparazioni</option>
          </select>
          <input id="f_cf" placeholder="Codice Fiscale"/>
          <input id="f_nome" placeholder="Nome/Cognome"/>
          <input id="f_contatto" placeholder="Telefono/Email"/>
        </div>

        <div class="grid grid-4" style="margin-top:10px">
          <input id="f_citta" placeholder="Citt√†"/>
          <input id="f_compagnia" placeholder="Compagnia (contratti)"/>
          <input id="f_offerta" placeholder="Offerta (contratti)"/>
          <input id="f_tecnologia" placeholder="Tecnologia (SIM/FTTH/FWA)"/>
        </div>

        <div class="grid grid-4" style="margin-top:10px">
          <input id="f_tipo_attivazione" placeholder="Tipo attivazione (NUOVA/MNP/...)"/>
          <input id="f_convergenza" placeholder="Convergenza (SI/NO)"/>
          <input id="f_mnp" placeholder="MNP (SI/NO)"/>
          <input id="f_imei_iccid" placeholder="IMEI/ICCID"/>
        </div>

        <div class="grid grid-4" style="margin-top:10px">
          <input id="f_stato_rip" placeholder="Stato riparazione"/>
          <input id="f_venditore" placeholder="Venditore (device)"/>
          <input id="f_query" placeholder="Testo libero (modello, note, problema...)"/>
          <div></div>
        </div>

        <div class="grid grid-4" style="margin-top:10px">
          <div>
            <div class="muted">Data da</div>
            <input id="f_from" type="date"/>
          </div>
          <div>
            <div class="muted">Data a</div>
            <input id="f_to" type="date"/>
          </div>
          <div>
            <div class="muted">Prezzo min (device)</div>
            <input id="f_price_min" type="number" step="0.01" placeholder="0"/>
          </div>
          <div>
            <div class="muted">Prezzo max (device)</div>
            <input id="f_price_max" type="number" step="0.01" placeholder="9999"/>
          </div>
        </div>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <h3>Totali report</h3>
          <div class="row" style="gap:18px;flex-wrap:wrap;margin-top:10px">
            <div><div class="kpi-label">Righe</div><div class="kpi-value" id="rep_total">0</div></div>
            <div><div class="kpi-label">‚Ç¨ Device (somma)</div><div class="kpi-value" id="rep_sum_dev">0</div></div>
            <div><div class="kpi-label">‚Ç¨ Riparazioni (somma)</div><div class="kpi-value" id="rep_sum_rip">0</div></div>
          </div>
          <div class="smallNote" style="margin-top:8px">Export PDF crea una pagina stampabile con grafici+tabelle.</div>
        </div>

        <div class="card">
          <h3>Grafico report (per tipo)</h3>
          <div class="muted">Barre = conteggio risultati nel report</div>
          <canvas id="chartReportTypes"></canvas>
          <div class="muted mono" style="margin-top:10px" id="dbg">‚Äî</div>
        </div>
      </div>

      <div class="card" style="margin-top:14px;overflow:auto">
        <h3>Risultati</h3>
        <table id="tblReport">
          <thead>
            <tr>
              <th>Tipo</th><th>Data</th><th>CF</th><th>Cliente</th><th>Contatto</th><th>Citt√†</th><th>Descrizione</th><th>Extra</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    
      <div class="card" id="cardBirthdays">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Report Compleanni</h3>
            <span class="muted">Da Data Nascita (se presente) oppure decodificata da Codice Fiscale</span>
          </div>
          <div class="right">
            <select id="b_month">
              <option value="">Tutti i mesi</option>
              <option value="1">Gennaio</option><option value="2">Febbraio</option><option value="3">Marzo</option><option value="4">Aprile</option>
              <option value="5">Maggio</option><option value="6">Giugno</option><option value="7">Luglio</option><option value="8">Agosto</option>
              <option value="9">Settembre</option><option value="10">Ottobre</option><option value="11">Novembre</option><option value="12">Dicembre</option>
            </select>
            <input id="b_days" type="number" min="1" value="30" style="max-width:120px" placeholder="Prossimi gg"/>
            <button class="btn primary small" id="btnRunBirthdays">Aggiorna</button>
            <button class="btn secondary small" id="btnExportBirthdaysCsv">Export CSV</button>
          </div>
        </div>

        <div class="hr"></div>
        <div id="b_summary" class="muted">‚Äî</div>

        <div style="margin-top:12px;overflow:auto">
          <table id="tblBirthdays">
            <thead>
              <tr>
                <th>Prossimo</th><th>Giorni</th><th>CF</th><th>Cliente</th><th>Nascita</th><th>Telefono</th><th>WhatsApp</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      
      <div class="card" id="cardDeadlines">
        <div class="toolbar">
          <div class="left">
            <h3 style="margin:0">Report Scadenze / Rinnovi</h3>
            <span class="muted">Vincolo offerta / vincolo telefono (prossimi giorni) + WhatsApp automatico</span>
          </div>
          <div class="right">
            <input id="s_days" type="number" min="1" value="60" style="max-width:120px" placeholder="Prossimi gg"/>
            <select id="s_tipo">
              <option value="">Tutte</option>
              <option value="OFFERTA">Vincolo Offerta</option>
              <option value="TELEFONO">Vincolo Telefono</option>
            </select>
            <button class="btn primary small" id="btnRunScadenze">Aggiorna</button>
            <button class="btn secondary small" id="btnExportScadenzeCsv">Export CSV</button>
          </div>
        </div>

        <div class="hr"></div>
        <div id="s_summary" class="muted">‚Äî</div>

        <div style="margin-top:12px;overflow:auto">
          <table id="tblScadenze">
            <thead>
              <tr>
                <th>Scadenza</th><th>Tipo</th><th>Giorni</th><th>CF</th><th>Cliente</th><th>Numero</th><th>Compagnia</th><th>Offerta</th><th>WhatsApp</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="smallNote" style="margin-top:10px">
          Suggerimento: usa questo report ogni mattina per richiamare i clienti in scadenza e chiudere rinnovi/upgrade.
        </div>
      </div>

</div>


      <div class="grid grid-2" style="margin-top:14px">
        <div class="card">
          <div class="toolbar">
            <div class="left">
              <h3 style="margin:0">Report intelligente: suggerimenti ricontatto</h3>
              <span class="muted">Winback ‚Ä¢ VIP ‚Ä¢ Upsell ‚Ä¢ Rinnovi ‚Äî con WhatsApp pronto</span>
            </div>
            <div class="right">
              <select id="smartSeg" style="min-width:180px">
                <option value="">Tutti i segmenti</option>
                <option value="RINNOVO">Rinnovo imminente</option>
                <option value="WINBACK">Inattivo (winback)</option>
                <option value="VIP">Cliente affezionato</option>
                <option value="UPSELL">Upsell / follow-up</option>
              </select>
              <input id="smartInactiveDays" type="number" min="0" value="90" placeholder="Inattivo >= gg" style="max-width:160px"/>
              <input id="smartNextDays" type="number" min="1" value="30" placeholder="Rinnovi entro gg" style="max-width:170px"/>
              <button class="btn primary small" id="btnRunSmart">Genera</button>
              <button class="btn secondary small" id="btnExportSmartCsv">Export CSV</button>
            </div>
          </div>
          <div class="muted" style="margin-top:8px">
            Il sistema valuta <b>ultima attivit√†</b>, <b>frequenza</b>, <b>spesa stimata</b> (device/rip), <b>MNP</b> e <b>scadenze</b>.
            Usa ‚ÄúInattivo >= gg‚Äù per il winback e ‚ÄúRinnovi entro gg‚Äù per proporre rinnovi.
          </div>
        </div>

        <div class="card">
          <h3>Riepilogo suggerimenti</h3>
          <div class="row" style="gap:16px;flex-wrap:wrap;margin-top:10px">
            <div><div class="kpi-label">Totali</div><div class="kpi-value" id="smartTot">0</div></div>
            <div><div class="kpi-label">Rinnovi</div><div class="kpi-value" id="smartRen">0</div></div>
            <div><div class="kpi-label">Winback</div><div class="kpi-value" id="smartWin">0</div></div>
            <div><div class="kpi-label">VIP</div><div class="kpi-value" id="smartVip">0</div></div>
            <div><div class="kpi-label">Upsell</div><div class="kpi-value" id="smartUp">0</div></div>
          </div>
          <div class="smallNote" style="margin-top:10px">
            Suggerimento: usa i VIP per ‚Äúbuono fedelt√†‚Äù, winback per ‚Äútorna da noi‚Äù, rinnovi per ‚Äúupgrade/nuova promo‚Äù.
          </div>
        </div>
      </div>

      
      <div class="grid grid-2" style="margin-top:14px">
        <div class="card">
          <h3>Valore cliente (stima) & impostazioni</h3>
          <div class="muted">Usato per prioritizzare VIP e per ‚Äúricontatti suggeriti‚Äù.</div>
          <div class="grid grid-3" style="margin-top:10px">
            <div>
              <div class="muted">Valore contratti (mesi)</div>
              <input id="valMonths" type="number" step="1" min="1" value="12"/>
            </div>
            <div>
              <div class="muted">Margine device (%)</div>
              <input id="marginDevPct" type="number" step="1" min="0" max="100" value="15"/>
            </div>
            <div>
              <div class="muted">Margine riparazioni (%)</div>
              <input id="marginRipPct" type="number" step="1" min="0" max="100" value="40"/>
            </div>
          </div>
          <div class="row" style="margin-top:12px">
            <button class="btn primary small" id="btnSaveValueSettings">Salva impostazioni</button>
            <span class="muted">Tip: mesi=12/24, device=10‚Äì20%, rip=30‚Äì60%</span>
          </div>
        </div>

        <div class="card">
          <h3>Campagne salvate</h3>
          <div class="muted">Crea campagne dai ricontatti suggeriti e traccia gli esiti.</div>
          <div class="grid grid-3" style="margin-top:10px">
            <input id="campName" placeholder="Nome campagna (es. Winback Gennaio)"/>
            <select id="campSeg">
              <option value="">Segmento: Tutti</option>
              <option>RINNOVO</option>
              <option>WINBACK</option>
              <option>VIP</option>
              <option>UPSELL</option>
            </select>
            <button class="btn primary" id="btnCreateCampaign">Crea da lista</button>
          </div>
          <div class="row" style="margin-top:10px">
            <select id="campSelect" style="min-width:280px"></select>
            <button class="btn secondary small" id="btnExportCampaignCsv">Export CSV campagna</button>
            <button class="btn secondary small" id="btnDeleteCampaign">Elimina campagna</button>
          </div>
          <div class="smallNote" style="margin-top:10px">Dentro la campagna puoi segnare stato, esito e follow-up; WhatsApp precompilato √® gi√† pronto.</div>
        </div>
      </div>

      <div class="card" style="margin-top:14px;overflow:auto">
        <h3>Leads campagna selezionata</h3>
        <table id="tblCampaignLeads">
          <thead>
            <tr>
              <th>Score</th>
              <th>Segmento</th>
              <th>CF</th>
              <th>Cliente</th>
              <th>Valore stimato</th>
              <th>Stato</th>
              <th>Esito</th>
              <th>Follow-up</th>
              <th>Ultimo contatto</th>
              <th>Azioni</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

<div class="card" style="margin-top:14px;overflow:auto">
        <h3>Lista ricontatti suggeriti</h3>
        <table id="tblSmart">
          <thead>
            <tr>
              <th>Score</th>
              <th>Segmento</th>
              <th>CF</th>
              <th>Cliente</th>
              <th>Ultima attivit√†</th>
              <th>Giorni</th>
              <th>Motivo</th>
              <th>Proposta</th>
              <th>Valore stimato</th>
              <th>Azioni</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

    </section>

    <!-- TIMELINE -->
    <section id="view-timeline" class="view">
      <div class="card">
        <h3>Timeline cliente (stile Salesforce)</h3>
        <div class="muted">Inserisci CF e vedi eventi (Contratti/Device/Riparazioni) in ordine decrescente.</div>
        <div class="row" style="margin-top:10px">
          <div style="flex:2;min-width:260px">
            <input id="t_cf" placeholder="Codice Fiscale"/>
          </div>
          <button class="btn primary" id="btnTimeline">Carica timeline</button>
        </div>
      </div>

      <div class="card">
        <div id="timelineHeader" class="muted">‚Äî</div>
        <div id="timelineBox" class="timeline" style="margin-top:12px"></div>
      </div>
    </section>

    <!-- IMPORT / EXPORT -->
    <section id="view-importexport" class="view">
      <div class="card">
        <h3>Import CSV (smart headers)</h3>
        <div class="muted">
          Importa direttamente dal tuo export Google Sheets (intestazioni come: <span class="mono">ID contratto</span>, <span class="mono">Codice fiscale</span>, <span class="mono">Data contratto</span>, <span class="mono">ICCID_nuovo</span>, ecc).
        </div>

        <div class="grid grid-2" style="margin-top:12px">
          <div class="card" style="border-style:dashed">
            <div class="row" style="justify-content:space-between">
              <b>Import Anagrafica</b>
              <input type="file" id="fileAnag" accept=".csv" />
            </div>
            <div class="smallNote">Minimo: CF, Nome, Cognome</div>
            <div class="row" style="margin-top:10px">
              <button class="btn primary small" id="btnImportAnag">Importa</button>
              <button class="btn secondary small" id="btnTplAnag">Scarica template</button>
            </div>
          </div>

          <div class="card" style="border-style:dashed">
            <div class="row" style="justify-content:space-between">
              <b>Import Contratti</b>
              <input type="file" id="fileCon" accept=".csv" />
            </div>
            <div class="smallNote">Minimo: Codice fiscale (FK). Data contratto consigliata.</div>
            <div class="row" style="margin-top:10px">
              <button class="btn primary small" id="btnImportCon">Importa</button>
              <button class="btn secondary small" id="btnTplCon">Scarica template</button>
            </div>
          </div>

          <div class="card" style="border-style:dashed">
            <div class="row" style="justify-content:space-between">
              <b>Import Device</b>
              <input type="file" id="fileDev" accept=".csv" />
            </div>
            <div class="smallNote">Minimo: CF (FK) + Modello</div>
            <div class="row" style="margin-top:10px">
              <button class="btn primary small" id="btnImportDev">Importa</button>
              <button class="btn secondary small" id="btnTplDev">Scarica template</button>
            </div>
          </div>

          <div class="card" style="border-style:dashed">
            <div class="row" style="justify-content:space-between">
              <b>Import Riparazioni</b>
              <input type="file" id="fileRip" accept=".csv" />
            </div>
            <div class="smallNote">Minimo: CF (FK) + Modello</div>
            <div class="row" style="margin-top:10px">
              <button class="btn primary small" id="btnImportRip">Importa</button>
              <button class="btn secondary small" id="btnTplRip">Scarica template</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h3>Export</h3>
        <div class="muted">CSV completi per tab + PDF ‚Äúpresentabile‚Äù (stampa browser).</div>
        <div class="row" style="margin-top:12px">
          <button class="btn secondary" id="btnExportAll">Export TUTTO (multipli CSV)</button>
          <button class="btn secondary" id="btnExportAnagAll">Export Anagrafica</button>
          <button class="btn secondary" id="btnExportConAll">Export Contratti</button>
          <button class="btn secondary" id="btnExportDevAll">Export Device</button>
          <button class="btn secondary" id="btnExportRipAll">Export Riparazioni</button>
          <button class="btn secondary" id="btnExportFullPdf">Export PDF (Dashboard+30gg)</button>
        </div>
        <div class="smallNote" style="margin-top:10px">
          Nota: ‚ÄúExport PDF‚Äù apre una pagina stampabile con grafici e tabelle, poi fai ‚ÄúSalva come PDF‚Äù.
        </div>
      </div>
    </section>

  </div>
  </main>
</div>

<div id="toast" class="toast"></div>

<script>
/* =========================
   UTIL
========================= */
function toast(msg, ms=2400){
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"), ms);
}
function upper(x){ return (x ?? "").toString().trim().toUpperCase(); }

function waLink(phone){
  const digits = (phone||"").toString().replace(/[^0-9]/g,"");
  if(!digits) return "#";
  // se manca prefisso, mettiamo 39
  const d = digits.startsWith("39") ? digits : ("39"+digits);
  return "https://wa.me/" + d;
}

function waLinkText(phone, text){
  const base = waLink(phone);
  if(base === "#") return "#";
  const msg = encodeURIComponent((text||"").toString());
  return base + (msg ? ("?text=" + msg) : "");
}
function waPhonePretty(phone){
  return (phone||"").toString().trim();
}

function toNum(x){
  if(x===null||x===undefined) return null;
  const s=(""+x).replace(",",".").replace(/[^\d.-]/g,"").trim();
  if(!s) return null;
  const n=Number(s);
  return Number.isFinite(n)?n:null;
}
function toDateISO(x){
  if(!x) return "";
  if(typeof x==="string"){
    const t = x.trim();
    const m = t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
    if(m){
      const dd = m[1].padStart(2,"0");
      const mm = m[2].padStart(2,"0");
      const yyyy = m[3];
      return `${yyyy}-${mm}-${dd}`;
    }
    if(/^\d{4}-\d{2}-\d{2}$/.test(t)) return t;
  }
  const d=new Date(x);
  if(isNaN(d)) return "";
  return d.toISOString().slice(0,10);
}
function moneyFmt(n){
  if(n===null||n===undefined) return "‚Äî";
  return n.toLocaleString("it-IT",{style:"currency",currency:"EUR"});
}
function lastNDays(dateISO, n=30){
  const d=new Date(dateISO);
  if(isNaN(d)) return false;
  const now=new Date();
  const diff=(now-d)/(1000*60*60*24);
  return diff>=0 && diff<=n;
}
function safeId(prefix="ID"){
  return prefix + "-" + Math.random().toString(36).slice(2,8).toUpperCase() + "-" + Date.now().toString().slice(-4);
}
function qs(sel){ return document.querySelector(sel); }
function qsa(sel){ return [...document.querySelectorAll(sel)]; }
function setText(id, v){ const el=document.getElementById(id); if(el) el.textContent = v; }
function todayISO(){ return new Date().toISOString().slice(0,10); }

/* =========================
   STORAGE
========================= */
const STORE_KEY = "VOLPEX_CRM_PRO_V3";
const VALUE_SETTINGS_KEY = "VOLPEX_VALUE_SETTINGS_V1";
const CAMPAIGNS_KEY = "VOLPEX_CAMPAIGNS_V1";

function saveStore(){
  const payload = { anagrafica, contratti, device, riparazioni };
  localStorage.setItem(STORE_KEY, JSON.stringify(payload));
}
function loadStore(){
  const raw = localStorage.getItem(STORE_KEY);
  if(!raw) return false;
  try{
    const p = JSON.parse(raw);
    if(!p) return false;
    anagrafica = Array.isArray(p.anagrafica) ? p.anagrafica : [];
    contratti = Array.isArray(p.contratti) ? p.contratti : [];
    device = Array.isArray(p.device) ? p.device : [];
    riparazioni = Array.isArray(p.riparazioni) ? p.riparazioni : [];
    return true;
  }catch(e){ return false; }
}


/* =========================
   VALUE SETTINGS + CAMPAIGNS
========================= */
function defaultValueSettings(){
  return { months: 12, marginDevPct: 15, marginRipPct: 40 };
}
function loadValueSettings(){
  try{
    const raw = localStorage.getItem(VALUE_SETTINGS_KEY);
    if(!raw) return defaultValueSettings();
    const v = JSON.parse(raw);
    const d = defaultValueSettings();
    return {
      months: Math.max(1, parseInt(v.months ?? d.months,10)),
      marginDevPct: Math.max(0, Math.min(100, parseFloat(v.marginDevPct ?? d.marginDevPct))),
      marginRipPct: Math.max(0, Math.min(100, parseFloat(v.marginRipPct ?? d.marginRipPct)))
    };
  }catch(e){ return defaultValueSettings(); }
}
function saveValueSettings(v){
  localStorage.setItem(VALUE_SETTINGS_KEY, JSON.stringify(v));
}
function loadCampaigns(){
  try{
    const raw = localStorage.getItem(CAMPAIGNS_KEY);
    return raw ? (JSON.parse(raw) || []) : [];
  }catch(e){ return []; }
}
function saveCampaigns(list){
  localStorage.setItem(CAMPAIGNS_KEY, JSON.stringify(list||[]));
}
let campaigns = loadCampaigns();
let selectedCampaignId = "";

/* =========================
   DEMO DATA
========================= */
function daysAgo(n){ const d=new Date(); d.setDate(d.getDate()-n); return d.toISOString().slice(0,10); }
let anagrafica = [];
let contratti = [];
let device = [];
let riparazioni = [];
let reportRows = [];
let lastReportTypeCounts = { CONTRATTO:0, DEVICE:0, RIPARAZIONE:0 };

function seedDemo(){
  anagrafica = [
    { cf:"RSSMRA80X01H501Z", nome:"MARIO",  cognome:"ROSSI",   tipo:"PRIVATO",  telefono:"+39 3331234567", email:"mario.rossi@email.it", citta:"ROMA",   indirizzo:"VIA ROMA 1" },
    { cf:"BNCLGU85T10F205X", nome:"LUIGI",  cognome:"BIANCHI", tipo:"PRIVATO",  telefono:"+39 3339876543", email:"luigi.bianchi@email.it", citta:"MILANO", indirizzo:"VIA MILANO 22" },
    { cf:"VRDGNN90A01F839K", nome:"GIANNA", cognome:"VERDI",   tipo:"BUSINESS", telefono:"+39 3201112223", email:"gianna.verdi@email.it", citta:"TORINO", indirizzo:"CORSO TORINO 9" }
  ];

  contratti = [
    {
      id:"", id_cliente:"C001", cf:"RSSMRA80X01H501Z",
      data_contratto:"2025-12-17", tipo_cliente:"PRIVATO", tipo_attivazione:"MNP", tecnologia:"SIM",
      convergenza:"NO", mnp:"SI", data_attivazione:"2025-12-17", data_portabilita:"",
      numero_lavorato:"333123456", nome_offerta:"OFFERTA X", costo_offerta:"9.99", vincolo_offerta_mesi:"24",
      telefono_incluso:"SI", imei:"123456789012345", modello:"IPHONE 13", tipo_pagamento:"CARTA",
      mesi_vincolo_telefono:"24", data_fine_vincolo_offerta:"", data_fine_vincolo_telefono:"",
      compagnia:"VODAFONE", iccid_vecchio:"", iccid_nuovo:"", created_at:"", updated_at:""
    },
    {
      id:"C-0002", id_cliente:"C002", cf:"BNCLGU85T10F205X",
      data_contratto:daysAgo(8), tipo_cliente:"PRIVATO", tipo_attivazione:"NUOVA", tecnologia:"FTTH",
      convergenza:"SI", mnp:"NO", data_attivazione:daysAgo(7), data_portabilita:"",
      numero_lavorato:"", nome_offerta:"FIBRA 24.99", costo_offerta:"24.99", vincolo_offerta_mesi:"24",
      telefono_incluso:"NO", imei:"", modello:"", tipo_pagamento:"",
      mesi_vincolo_telefono:"", data_fine_vincolo_offerta:"", data_fine_vincolo_telefono:"",
      compagnia:"TIM", iccid_vecchio:"", iccid_nuovo:"", created_at:"", updated_at:""
    }
  ];

  device = [
    { id:"D-1001", cf:"RSSMRA80X01H501Z", data:daysAgo(10), modello:"IPHONE 13", imei:"123456789012345", prezzo:"699", venditore:"AUGUSTO", pagamento:"CARTA" },
    { id:"D-1002", cf:"BNCLGU85T10F205X", data:daysAgo(28), modello:"SAMSUNG A54", imei:"351111222233334", prezzo:"349", venditore:"AUGUSTO", pagamento:"BANCOMAT" }
  ];

  riparazioni = [
    { id:"R-9001", cf:"BNCLGU85T10F205X", data_ingresso:daysAgo(3), modello:"SAMSUNG A52", problema:"DISPLAY ROTTO", stato:"PRONTA", costo:"59", imei:"351010101010101" },
    { id:"R-9002", cf:"RSSMRA80X01H501Z", data_ingresso:daysAgo(12), modello:"IPHONE 13", problema:"BATTERIA", stato:"IN LAVORAZIONE", costo:"89", imei:"123456789012345" }
  ];
}

/* =========================
   NAV
========================= */
const pageTitle = document.getElementById("pageTitle");
qsa("[data-view]").forEach(btn=>{
  btn.addEventListener("click", ()=>{
    qsa("[data-view]").forEach(x=>x.classList.remove("active"));
    qsa(".view").forEach(v=>v.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById("view-"+btn.dataset.view).classList.add("active");
    pageTitle.textContent = btn.textContent.replace(/^.[^ ]* /,'').trim();
  });

// Device: lookup + quick create
const btnDevFind = document.getElementById("btnDevFindClient");
if(btnDevFind){
  btnDevFind.addEventListener("click", ()=> lookupClientFlow("d_cf","d_cf_status","devQuickAnag","qd"));
}
const btnDevCreate = document.getElementById("btnDevCreateClient");
if(btnDevCreate){
  btnDevCreate.addEventListener("click", ()=>{
    const ok = createClientFromQuick("qd","d_cf_status","devQuickAnag");
    if(ok){
      const cf = upper(document.getElementById("qd_cf").value);
      document.getElementById("d_cf").value = cf;
    }
  });
}
const btnDevCancel = document.getElementById("btnDevCancelCreate");
if(btnDevCancel){
  btnDevCancel.addEventListener("click", ()=>{ show(document.getElementById("devQuickAnag"), false); });
}

// Riparazioni: lookup + quick create
const btnRipFind = document.getElementById("btnRipFindClient");
if(btnRipFind){
  btnRipFind.addEventListener("click", ()=> lookupClientFlow("r_cf","r_cf_status","ripQuickAnag","qr"));
}
const btnRipCreate = document.getElementById("btnRipCreateClient");
if(btnRipCreate){
  btnRipCreate.addEventListener("click", ()=>{
    const ok = createClientFromQuick("qr","r_cf_status","ripQuickAnag");
    if(ok){
      const cf = upper(document.getElementById("qr_cf").value);
      document.getElementById("r_cf").value = cf;
    }
  });
}
const btnRipCancel = document.getElementById("btnRipCancelCreate");
if(btnRipCancel){
  btnRipCancel.addEventListener("click", ()=>{ show(document.getElementById("ripQuickAnag"), false); });
}

});
document.getElementById("btnPrint").addEventListener("click", ()=>window.print());

/* =========================
   LOOKUP & VALIDATION
========================= */
function anagByCF(cf){
  const key = upper(cf);
  return anagrafica.find(a => upper(a.cf) === key) || null;
}
function setStatus(el, ok, msg){
  if(!el) return;
  el.textContent = msg;
  el.style.color = ok ? "#166534" : "#991b1b";
}
function show(el, yes){ if(!el) return; el.style.display = yes ? "block" : "none"; }

function lookupClientFlow(cfInputId, statusId, quickBoxId, quickPrefix){
  const cf = upper(qs("#"+cfInputId).value);
  const statusEl = document.getElementById(statusId);
  const quickBox = document.getElementById(quickBoxId);
  if(!cf){ setStatus(statusEl, false, "Inserisci un CF."); return {found:false, cf:""}; }
  const a = anagByCF(cf);
  if(a){
    setStatus(statusEl, true, `Cliente trovato: ${a.nome} ${a.cognome} ‚Ä¢ ${a.telefono||""}`.trim());
    show(quickBox, false);
    return {found:true, cf};
  }else{
    setStatus(statusEl, false, "Cliente NON trovato. Compila l‚Äôanagrafica veloce qui sotto.");
    // precompila CF nel quick form
    const qcf = document.getElementById(quickPrefix+"_cf");
    if(qcf) qcf.value = cf;
    show(quickBox, true);
    return {found:false, cf};
  }
}

function createClientFromQuick(prefix, statusId, quickBoxId){
  const cf = upper(qs("#"+prefix+"_cf").value);
  const nome = upper(qs("#"+prefix+"_nome").value);
  const cognome = upper(qs("#"+prefix+"_cognome").value);
  if(!cf || !nome || !cognome){ toast("CF, Nome e Cognome sono obbligatori"); return false; }
  const rec = {
    cf, nome, cognome,
    tipo: upper(qs("#"+prefix+"_tipo").value),
    telefono: (qs("#"+prefix+"_telefono").value||"").trim(),
    email: (qs("#"+prefix+"_email").value||"").trim(),
    citta: upper(qs("#"+prefix+"_citta").value),
    indirizzo: upper(qs("#"+prefix+"_indirizzo").value),
    data_nascita: toDateISO(qs("#"+prefix+"_data_nascita").value)
  };
  const idx = anagrafica.findIndex(x=>upper(x.cf)===cf);
  if(idx>=0) anagrafica[idx]=rec; else anagrafica.push(rec);
  saveStore();
  setStatus(document.getElementById(statusId), true, "Cliente creato ‚úÖ Ora puoi salvare l‚Äôoperazione.");
  show(document.getElementById(quickBoxId), false);
  refreshAll();
  return true;
}

function clienteNome(cf){
  const a = anagByCF(cf);
  if(!a) return "";
  return [a.nome, a.cognome].filter(Boolean).join(" ").trim();
}
function contattoStr(cf){
  const a = anagByCF(cf);
  if(!a) return "";
  return [a.telefono, a.email].filter(Boolean).join(" ‚Ä¢ ");
}
function mustHaveFK(cf){ return !!anagByCF(cf); }
/* =========================
   Contratti: cerca cliente prima di inserire
========================= */
function conFindClient(){
  const cf = upper(qs("#c_cf").value);
  const status = qs("#c_cf_status");
  if(!cf){ status.textContent = "Inserisci un CF."; status.style.color=""; return; }

  const a = anagByCF(cf);
  if(a){
    status.innerHTML = `Cliente trovato: <b>${clienteNome(cf)}</b> ‚Ä¢ ${contattoStr(cf) || ""}`;
    status.style.color = "#166534";
    qs("#conQuickAnag").style.display = "none";
  }else{
    status.innerHTML = `Cliente <b>NON trovato</b>. Inserisci l'anagrafica veloce qui sotto.`;
    status.style.color = "#991b1b";
    // prepara quick anag
    qs("#conQuickAnag").style.display = "block";
    qs("#qa_cf").value = cf;
    qs("#qa_nome").focus();
  }
}

function toggleModemBox(){
  const tec = upper(qs("#c_tecnologia").value);
  const show = ["FTTC","FTTH","FWA"].includes(tec);
  const box = qs("#modemBox");
  if(box) box.style.display = show ? "" : "none";
  if(!show && qs("#c_modem_spedito_da")) qs("#c_modem_spedito_da").value = "";
}

function createClientFromQuick(){
  const cf = upper(qs("#qa_cf").value);
  const nome = upper(qs("#qa_nome").value);
  const cognome = upper(qs("#qa_cognome").value);
  if(!cf || !nome || !cognome){ toast("CF, Nome, Cognome sono obbligatori"); return; }

  const rec = {
    cf, nome, cognome,
    tipo: upper(qs("#qa_tipo").value),
    telefono: (qs("#qa_telefono").value||"").trim(),
    email: (qs("#qa_email").value||"").trim(),
    citta: upper(qs("#qa_citta").value),
    indirizzo: upper(qs("#qa_indirizzo").value),
    data_nascita: qs("#qa_data_nascita").value || ""
  };

  const idx = anagrafica.findIndex(x=>upper(x.cf)===cf);
  if(idx>=0) anagrafica[idx]=rec; else anagrafica.push(rec);

  saveStore();
  renderAnag();
  toast("Cliente creato ‚úÖ Ora puoi salvare il contratto");
  qs("#conQuickAnag").style.display = "none";
  // aggiorna status
  conFindClient();
}

function cancelQuickClient(){
  qs("#conQuickAnag").style.display = "none";
  qs("#c_cf_status").textContent = "Inserisci CF e premi ‚ÄúCerca cliente‚Äù.";
  qs("#c_cf_status").style.color = "";
}



/* =========================
   CSV (parser)
========================= */
function detectDelimiter(line){
  const semi = (line.match(/;/g)||[]).length;
  const comma = (line.match(/,/g)||[]).length;
  return semi >= comma ? ";" : ",";
}
function splitCSVLine(line, delim){
  const out = [];
  let cur = "";
  let inQ = false;
  for(let i=0;i<line.length;i++){
    const ch = line[i];
    if(ch === '"'){
      if(inQ && line[i+1] === '"'){ cur += '"'; i++; }
      else inQ = !inQ;
    }else if(ch === delim && !inQ){
      out.push(cur); cur = "";
    }else{
      cur += ch;
    }
  }
  out.push(cur);
  return out;
}
function parseCSV(text){
  text = text.replace(/\r\n/g,"\n").replace(/\r/g,"\n").trim();
  if(!text) return { headers:[], rows:[] };
  const firstLine = text.split("\n")[0];
  const delim = detectDelimiter(firstLine);
  const lines = text.split("\n").filter(l=>l.trim().length);
  const headers = splitCSVLine(lines[0], delim).map(h=>h.trim());
  const rows = lines.slice(1).map(line=>{
    const cells = splitCSVLine(line, delim);
    const obj = {};
    headers.forEach((h,i)=> obj[h] = (cells[i] ?? "").trim());
    return obj;
  });
  return { headers, rows };
}
async function readFileText(inputEl){
  const f = inputEl.files && inputEl.files[0];
  if(!f) throw new Error("Seleziona un file CSV");
  return await f.text();
}

/* =========================
   CSV Smart headers mapping
========================= */
function normKey(k){
  return (k ?? "")
    .toString()
    .trim()
    .toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
    .replace(/[()]/g,"")
    .replace(/[^\w]+/g,"_")
    .replace(/^_+|_+$/g,"");
}
function mapRowSmart(row, schema){
  const out = {};
  const rawKeys = Object.keys(row||{});
  const table = new Map();
  rawKeys.forEach(k => table.set(normKey(k), row[k]));
  Object.keys(schema).forEach(canon=>{
    const aliases = schema[canon] || [];
    const all = [canon, ...aliases].map(normKey);
    let val = "";
    for(const a of all){
      if(table.has(a)){ val = (table.get(a) ?? "").toString(); break; }
    }
    out[canon] = (val ?? "").toString().trim();
  });
  return out;
}

/* =========================
   SCHEMI (con intestazioni reali)
========================= */
const SCHEMA_ANAG = {
  cf: ["codice_fiscale","codicefiscale","cf_cliente","cod_fiscale","c_f"],
  nome: ["name"],
  cognome: ["surname","cognome_cliente"],
  tipo: ["tipo_cliente","tipo cliente","tipocliente","customer_type"],
  telefono: ["cellulare","tel","telefono_cliente","phone"],
  email: ["mail","e_mail"],
  citta: ["citt√†","city","comune"],
  indirizzo: ["address","via","indirizzo_cliente"]
,
  data_nascita: ["data_nascita","data nascita","birthdate","data di nascita","nascita"]
};

const SCHEMA_CON = {
  id: ["id_contratto","id contratto","idcontract","id"],
  id_cliente: ["id_cliente","id cliente","cliente_id","id cliente"],
  cf: ["codice_fiscale","codice fiscale","cf","cf_cliente"],

  data_contratto: ["data_contratto","data contratto","data","date"],
  tipo_cliente: ["tipo_cliente","tipo cliente"],

  compagnia: ["compagnia","operatore","carrier"],
  tecnologia: ["tecnologia","technology","tec"],
  tipo_attivazione: ["tipo_attivazione","tipo attivazione"],
  numero_lavorato: ["numero_lavorato","numero lavorato","numero","msisdn"],

  mnp: ["mnp"],
  compagnia_provenienza: ["compagnia_provenienza","compagnia di provenienza","operatore provenienza","provenienza"],

  iccid_vecchio: ["iccid_vecchio","iccid vecchio","iccid_old"],
  iccid_nuovo: ["iccid_nuovo","iccid nuovo","iccid_new"],

  nome_offerta: ["nome_offerta","nome offerta","offerta","offer"],
  costo_offerta: ["costo_offerta","costo offerta","canone","prezzo_offerta"],
  tipo_pagamento: ["tipo_pagamento","tipo pagamento","payment"],
  vincolo_offerta_mesi: ["vincolo_offerta_mesi","vincolo offerta (mesi)","vincolo offerta mesi","vincolo in mesi"],

  convergenza: ["convergenza"],
  telefono_incluso: ["telefono_incluso","telefono incluso"],

  imei: ["imei","imei_telefono","imei telefono"],
  marca: ["marca","brand"],
  modello: ["modello","model"],

  mesi_vincolo_telefono: ["mesi_vincolo_telefono","mesi vincolo telefono"],
  modalita_rate_telefono: ["modalita_rate_telefono","modalita pagamento rate telefono","pagamento rate telefono","rate telefono"],
  anticipo: ["anticipo","acconto"],

  modem_spedito_da: ["modem_spedito_da","modem spedito da","spedito da modem","modem windtre/kolme"],

  data_attivazione: ["data_attivazione","data attivazione"],
  data_portabilita: ["data_portabilita","data portabilit√†","data portabilita","portabilita"],

  data_fine_vincolo_offerta: ["data_fine_vincolo_offerta","data fine vincolo offerta"],
  data_fine_vincolo_telefono: ["data_fine_vincolo_telefono","data fine vincolo telefono"],

  created_at: ["created_at","created at","created"],
  updated_at: ["updated_at","updated at","updated"]
};

const SCHEMA_DEV = {
  id: ["id_device","id device","id"],
  cf: ["codice_fiscale","codice fiscale","cf"],
  data: ["data_vendita","data vendita","date","data"],
  modello: ["model","modello_device","modello"],
  imei: ["imei_device","imei telefono","imei"],
  prezzo: ["price","importo","totale","prezzo"],
  venditore: ["sales","seller","agente","venditore"],
  pagamento: ["tipo_pagamento","tipo pagamento","payment","pagamento"]
};

const SCHEMA_RIP = {
  id: ["id_riparazione","id riparazione","id"],
  cf: ["codice_fiscale","codice fiscale","cf"],
  data_ingresso: ["data_ingresso","data ingresso","ingresso","data","date"],
  modello: ["device_modello","device modello","model","modello"],
  imei: ["imei_device","imei telefono","imei"],
  problema: ["guasto","difetto","descrizione_problema","problema"],
  stato: ["status","stato_riparazione","stato riparazione","stato"],
  costo: ["price","importo","totale","costo"]
};

/* =========================
   CSV Download
========================= */
function downloadCSV(filename, headers, objects){
  const lines = [];
  lines.push(headers.join(";"));
  objects.forEach(o=>{
    const row = headers.map(h=>{
      const v = (o[h] ?? "").toString().replaceAll('"','""');
      return `"${v}"`;
    }).join(";");
    lines.push(row);
  });
  const blob = new Blob([lines.join("\n")], {type:"text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

/* =========================
   Export per tab
========================= */
function exportAnag(){
  const headers = ["cf","nome","cognome","tipo","telefono","email","citta","indirizzo","data_nascita"];
  downloadCSV(`anagrafica_${todayISO()}.csv`, headers, anagrafica.map(a=>({
    cf:a.cf, nome:a.nome, cognome:a.cognome, tipo:a.tipo||"", telefono:a.telefono||"", email:a.email||"", citta:a.citta||"", indirizzo:a.indirizzo||"", data_nascita:a.data_nascita||""
  })));
}
function exportCon(){
  const headers = [
    "id","id_cliente","cf","data_contratto","tipo_cliente","tipo_attivazione","tecnologia","convergenza","mnp",
    "data_attivazione","data_portabilita","numero_lavorato","nome_offerta","costo_offerta","vincolo_offerta_mesi",
    "telefono_incluso","imei","modello","tipo_pagamento","mesi_vincolo_telefono",
    "data_fine_vincolo_offerta","data_fine_vincolo_telefono","compagnia","iccid_vecchio","iccid_nuovo",
    "created_at","updated_at"
  ];
  downloadCSV(`contratti_${todayISO()}.csv`, headers, contratti);
}
function exportDev(){
  const headers = ["id","cf","data","modello","imei","prezzo","venditore","pagamento"];
  downloadCSV(`device_${todayISO()}.csv`, headers, device);
}
function exportRip(){
  const headers = ["id","cf","data_ingresso","modello","imei","problema","stato","costo"];
  downloadCSV(`riparazioni_${todayISO()}.csv`, headers, riparazioni);
}
function exportReport(){
  const headers = ["tipo","date","cf","cliente","contatto","citta","descr","extra"];
  downloadCSV(`report_${todayISO()}.csv`, headers, reportRows.map(r=>({
    tipo:r.tipo, date:r.date, cf:r.cf, cliente:r.cliente, contatto:r.contatto, citta:r.citta, descr:r.descr, extra:r.extra
  })));
}

/* =========================
   CHARTS (Canvas simple)
========================= */
function drawAxes(ctx, w, h, pad=36){
  ctx.clearRect(0,0,w,h);
  ctx.lineWidth = 1;
  ctx.strokeStyle = "#e5e7eb";
  ctx.fillStyle = "#0f172a";
  ctx.font = "12px system-ui";
  ctx.beginPath();
  ctx.moveTo(pad, 10);
  ctx.lineTo(pad, h-pad);
  ctx.lineTo(w-10, h-pad);
  ctx.stroke();
  return { pad };
}
function drawLineSeries(ctx, w, h, series, labels){
  const pad = 36;
  drawAxes(ctx, w, h, pad);
  const all = series.flatMap(s=>s.data);
  const maxV = Math.max(1, ...all);
  const n = labels.length;
  const x0 = pad, y0 = h-pad, x1 = w-10, y1 = 10;
  const dx = (x1-x0) / Math.max(1, n-1);

  ctx.strokeStyle = "#eef2ff";
  for(let i=0;i<=4;i++){
    const y = y0 - (i/4)*(y0-y1);
    ctx.beginPath(); ctx.moveTo(x0, y); ctx.lineTo(x1, y); ctx.stroke();
    ctx.fillStyle = "#64748b";
    ctx.fillText(String(Math.round((i/4)*maxV)), 6, y+4);
  }

  const palette = ["#2563eb","#16a34a","#f59e0b","#dc2626","#0ea5e9","#a855f7"];
  series.forEach((s,idx)=>{
    const col = palette[idx % palette.length];
    ctx.strokeStyle = col;
    ctx.lineWidth = 2;
    ctx.beginPath();
    s.data.forEach((v,i)=>{
      const x = x0 + i*dx;
      const y = y0 - (v/maxV)*(y0-y1);
      if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
    });
    ctx.stroke();

    ctx.fillStyle = col;
    ctx.fillRect(x0 + idx*110, 14, 10, 10);
    ctx.fillStyle = "#0f172a";
    ctx.fillText(s.name, x0 + idx*110 + 14, 24);
  });

  ctx.fillStyle = "#64748b";
  const step = Math.ceil(n / 6);
  for(let i=0;i<n;i+=step){
    const x = x0 + i*dx;
    ctx.fillText(labels[i].slice(5), x-14, h-14);
  }
}
function drawBarChart(ctx, w, h, items, title){
  const pad = 36;
  drawAxes(ctx, w, h, pad);
  const maxV = Math.max(1, ...items.map(i=>i.value));
  const x0 = pad, y0 = h-pad, x1 = w-10, y1 = 10;

  ctx.fillStyle = "#0f172a";
  ctx.font = "12px system-ui";
  if(title) ctx.fillText(title, x0, 14);

  const bw = (x1-x0) / Math.max(1, items.length);
  items.forEach((it, i)=>{
    const v = it.value;
    const barH = (v/maxV)*(y0-y1);
    const x = x0 + i*bw + 6;
    const y = y0 - barH;
    const barW = Math.max(10, bw-12);

    ctx.fillStyle = "#2563eb";
    ctx.fillRect(x, y, barW, barH);

    ctx.fillStyle = "#0f172a";
    ctx.font = "11px system-ui";
    ctx.fillText(String(v), x, y-4);

    ctx.fillStyle = "#64748b";
    const lab = (it.label||"").slice(0,12);
    ctx.fillText(lab, x, h-14);
  });
}

function drawPieChart(ctx, w, h, items, title){
  ctx.clearRect(0,0,w,h);

  const cleaned = (items||[]).map(it=>({
    label: (it.label ?? "‚Äî").toString(),
    value: Math.max(0, Number(it.value) || 0)
  }));
  const total = cleaned.reduce((s,it)=>s+it.value,0);

  if(title){
    ctx.fillStyle = "#0f172a";
    ctx.font = "13px system-ui";
    ctx.fillText(title, 12, 18);
  }

  if(total<=0){
    ctx.fillStyle = "#64748b";
    ctx.font = "14px system-ui";
    ctx.fillText("Nessun dato", 12, 44);
    return;
  }

  // spazio per legenda a sinistra
  const cx = w/2 + 40;
  const cy = h/2 + 10;
  const radius = Math.min(w,h)/2 - 46;

  const palette = ["#2563eb","#16a34a","#f59e0b","#dc2626","#0ea5e9","#a855f7","#22c55e","#f97316"];

  let start = -Math.PI/2;
  cleaned.forEach((it, idx)=>{
    const frac = it.value / total;
    const ang = frac * Math.PI * 2;
    const end = start + ang;

    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.arc(cx,cy,radius,start,end);
    ctx.closePath();
    ctx.fillStyle = palette[idx % palette.length];
    ctx.fill();

    start = end;
  });

  // legenda
  ctx.font = "12px system-ui";
  cleaned.forEach((it, idx)=>{
    const col = palette[idx % palette.length];
    const y = 40 + idx*18;
    ctx.fillStyle = col;
    ctx.fillRect(12, y-10, 10, 10);

    const perc = Math.round((it.value/total)*100);
    ctx.fillStyle = "#0f172a";
    ctx.fillText(`${it.label}: ${it.value} (${perc}%)`, 28, y);
  });
}


/* =========================
   Metrics + dashboard/console
========================= */
function compute30(){
  const con30 = contratti
    .map(x=>({
      ...x,
      date: toDateISO(x.data_contratto || x.data),
      cf: upper(x.cf),
      cliente: clienteNome(x.cf),
      compagnia: upper(x.compagnia),
      offerta: upper(x.nome_offerta || x.offerta),
      tecnologia: upper(x.tecnologia),
      mnp: upper(x.mnp),
      id: x.id,
      id_cliente: x.id_cliente
    }))
    .filter(x=>x.date && lastNDays(x.date,30))
    .sort((a,b)=>(b.date||"").localeCompare(a.date||""));

  const dev30 = device
    .map(x=>({
      ...x,
      date: toDateISO(x.data),
      cf: upper(x.cf),
      cliente: clienteNome(x.cf),
      modello: upper(x.modello),
      imei: upper(x.imei),
      prezzo: toNum(x.prezzo),
      venditore: upper(x.venditore||""),
      id: x.id
    }))
    .filter(x=>x.date && lastNDays(x.date,30))
    .sort((a,b)=>(b.date||"").localeCompare(a.date||""));

  const rip30 = riparazioni
    .map(x=>({
      ...x,
      date: toDateISO(x.data_ingresso),
      cf: upper(x.cf),
      cliente: clienteNome(x.cf),
      modello: upper(x.modello),
      problema: upper(x.problema),
      stato: upper(x.stato),
      costo: toNum(x.costo),
      id: x.id
    }))
    .filter(x=>x.date && lastNDays(x.date,30))
    .sort((a,b)=>(b.date||"").localeCompare(a.date||""));

  return { con30, dev30, rip30 };
}

function renderDashboardAndConsole(){
  const { con30, dev30, rip30 } = compute30();

  setText("kpiClienti", anagrafica.length);
  setText("kpiClientiSub", "Totale clienti");
  setText("kpiContratti30", con30.length);
  setText("kpiContrattiSub", "Basato su Data contratto");
  setText("kpiDevice30", dev30.length);
  setText("kpiDeviceSub", "Basato su data vendita");
  setText("kpiRip30", rip30.length);
  setText("kpiRipSub", "Basato su data ingresso");

  const sumDev = dev30.reduce((s,x)=>s+(x.prezzo||0),0);
  const sumRip = rip30.reduce((s,x)=>s+(x.costo||0),0);
  setText("kpiDeviceEur", moneyFmt(sumDev));
  setText("kpiRipEur", moneyFmt(sumRip));

  setText("badgeContratti30", con30.length + " righe");
  setText("badgeDevice30", dev30.length + " righe");
  setText("badgeRip30", rip30.length + " righe");

  qs("#tblContratti30 tbody").innerHTML = con30.map(x=>`
    <tr>
      <td>${x.date}</td>
      <td class="mono">${x.id || ""}</td>
      <td class="mono">${x.cf}</td>
      <td>${x.cliente}</td>
      <td>${x.compagnia}</td>
      <td>${x.offerta}</td>
      <td>${x.tecnologia}</td>
      <td><span class="badge ${x.mnp==="SI"?"good":"warn"}">${x.mnp||""}</span></td>
    </tr>
  `).join("") || `<tr><td colspan="8" class="muted">Nessun dato.</td></tr>`;

  qs("#tblDevice30 tbody").innerHTML = dev30.map(x=>`
    <tr>
      <td>${x.date}</td>
      <td class="mono">${x.id}</td>
      <td class="mono">${x.cf}</td>
      <td>${x.cliente}</td>
      <td>${x.modello}</td>
      <td class="mono">${x.imei}</td>
      <td>${x.prezzo!=null ? moneyFmt(x.prezzo) : "‚Äî"}</td>
      <td>${x.venditore}</td>
    </tr>
  `).join("") || `<tr><td colspan="8" class="muted">Nessun dato.</td></tr>`;

  qs("#tblRip30 tbody").innerHTML = rip30.map(x=>{
    const cls = x.stato.includes("PRON") || x.stato.includes("CONS") ? "good" : (x.stato.includes("APER") ? "warn" : "");
    return `
    <tr>
      <td>${x.date}</td>
      <td class="mono">${x.id}</td>
      <td class="mono">${x.cf}</td>
      <td>${x.cliente}</td>
      <td>${x.modello}</td>
      <td>${x.problema}</td>
      <td><span class="badge ${cls}">${x.stato}</span></td>
      <td>${x.costo!=null ? moneyFmt(x.costo) : "‚Äî"}</td>
    </tr>`;
  }).join("") || `<tr><td colspan="8" class="muted">Nessun dato.</td></tr>`;

  setText("totalRecords", String(anagrafica.length + contratti.length + device.length + riparazioni.length));
}

/* =========================
   CRUD RENDER
========================= */
function renderAnag(){
  const q = upper(qs("#searchAnag").value);
  const rows = anagrafica
    .slice()
    .sort((a,b)=>(a.cognome||"").localeCompare(b.cognome||""))
    .filter(a=> !q ? true : upper(JSON.stringify(a)).includes(q));

  qs("#tblAnag tbody").innerHTML = rows.map(a=>`
    <tr>
      <td class="mono">${a.cf}</td>
      <td>${a.nome||""}</td>
      <td>${a.cognome||""}</td>
      <td>${a.tipo||""}</td>
      <td>${a.telefono||""}</td>
      <td>${a.email||""}</td>
      <td>${a.citta||""}</td>
      <td>
        <button class="btn secondary small" onclick="openClientSheet('${a.cf}')">Scheda</button>
        ${a.telefono ? `<a class="btn secondary small" href="${waLink(a.telefono)}" target="_blank" rel="noopener" style="text-decoration:none">üí¨ WhatsApp</a>` : ``}
        <button class="btn secondary small" onclick="editAnag('${a.cf}')">Modifica</button>
        <button class="btn danger small" onclick="deleteAnag('${a.cf}')">Elimina</button>
      </td>
    </tr>
  `).join("") || `<tr><td colspan="8" class="muted">Nessun cliente.</td></tr>`;
}

function renderCon(){
  const q = upper(qs("#searchCon").value);
  const rows = contratti
    .slice()
    .sort((a,b)=>(toDateISO(b.data_contratto)||"").localeCompare(toDateISO(a.data_contratto)||""))
    .filter(c=> !q ? true : upper(JSON.stringify(c)).includes(q));

  qs("#tblCon tbody").innerHTML = rows.map(c=>`
    <tr>
      <td class="mono">${c.id}</td>
      <td class="mono">${c.id_cliente||""}</td>
      <td>${toDateISO(c.data_contratto)||""}</td>
      <td class="mono">${c.cf}</td>
      <td>${clienteNome(c.cf)}</td>
      <td>${c.compagnia||""}</td>
      <td>${c.nome_offerta||""}</td>
      <td>${c.tecnologia||""}</td>
      <td><span class="badge ${upper(c.mnp)==="SI"?"good":"warn"}">${c.mnp||""}</span></td>
      <td>${c.numero_lavorato||""}</td>
      <td class="mono">${c.imei||""}</td>
      <td class="mono">${c.iccid_nuovo||""}</td>
      <td>
        <button class="btn secondary small" onclick="editCon('${c.id}')">Modifica</button>
        <button class="btn danger small" onclick="deleteCon('${c.id}')">Elimina</button>
        <button class="btn secondary small" onclick="printReceipt(\'CONTRATTO\', \'${c.id}\')">Ricevuta</button>
      </td>
    </tr>
  `).join("") || `<tr><td colspan="13" class="muted">Nessun contratto.</td></tr>`;
}

function renderDev(){
  const q = upper(qs("#searchDev").value);
  const rows = device
    .slice()
    .sort((a,b)=>(toDateISO(b.data)||"").localeCompare(toDateISO(a.data)||""))
    .filter(d=> !q ? true : upper(JSON.stringify(d)).includes(q));

  qs("#tblDev tbody").innerHTML = rows.map(d=>`
    <tr>
      <td class="mono">${d.id}</td>
      <td>${toDateISO(d.data)}</td>
      <td class="mono">${d.cf}</td>
      <td>${clienteNome(d.cf)}</td>
      <td>${d.modello||""}</td>
      <td class="mono">${d.imei||""}</td>
      <td>${toNum(d.prezzo)!=null ? moneyFmt(toNum(d.prezzo)) : "‚Äî"}</td>
      <td>${d.venditore||""}</td>
      <td>
        <button class="btn secondary small" onclick="editDev('${d.id}')">Modifica</button>
        <button class="btn danger small" onclick="deleteDev('${d.id}')">Elimina</button>
        <button class="btn secondary small" onclick="printReceipt(\'DEVICE\', \'${d.id}\')">Ricevuta</button>
      </td>
    </tr>
  `).join("") || `<tr><td colspan="10" class="muted">Nessun device.</td></tr>`;
}

function renderRip(){
  const q = upper(qs("#searchRip").value);
  const rows = riparazioni
    .slice()
    .sort((a,b)=>(toDateISO(b.data_ingresso)||"").localeCompare(toDateISO(a.data_ingresso)||""))
    .filter(r=> !q ? true : upper(JSON.stringify(r)).includes(q));

  qs("#tblRip tbody").innerHTML = rows.map(r=>{
    const cls = (r.stato||"").includes("PRON") || (r.stato||"").includes("CONS") ? "good" : ((r.stato||"").includes("APER") ? "warn" : "");
    return `
    <tr>
      <td class="mono">${r.id}</td>
      <td>${toDateISO(r.data_ingresso)}</td>
      <td class="mono">${r.cf}</td>
      <td>${clienteNome(r.cf)}</td>
      <td>${r.modello||""}</td>
      <td>${r.problema||""}</td>
      <td><span class="badge ${cls}">${r.stato||""}</span></td>
      <td>${toNum(r.costo)!=null ? moneyFmt(toNum(r.costo)) : "‚Äî"}</td>
      <td>
        <button class="btn secondary small" onclick="editRip('${r.id}')">Modifica</button>
        <button class="btn danger small" onclick="deleteRip('${r.id}')">Elimina</button>
        <button class="btn secondary small" onclick="printReceipt(\'RIPARAZIONE\', \'${r.id}\')">Ricevuta</button>
      </td>
    </tr>`;
  }).join("") || `<tr><td colspan="10" class="muted">Nessuna riparazione.</td></tr>`;
}

/* =========================
   CRUD Actions
========================= */
function clearAnagForm(){
  ["a_cf","a_nome","a_cognome","a_tipo","a_telefono","a_email","a_citta","a_indirizzo","a_data_nascita"].forEach(id=>qs("#"+id).value="");
}
function saveAnag(){
  const cf = upper(qs("#a_cf").value);
  const nome = upper(qs("#a_nome").value);
  const cognome = upper(qs("#a_cognome").value);
  if(!cf || !nome || !cognome){ toast("CF, Nome, Cognome sono obbligatori"); return; }

  const rec = {
    cf, nome, cognome,
    tipo: upper(qs("#a_tipo").value),
    telefono: (qs("#a_telefono").value||"").trim(),
    email: (qs("#a_email").value||"").trim(),
    citta: upper(qs("#a_citta").value),
    indirizzo: upper(qs("#a_indirizzo").value),
    data_nascita: qs("#a_data_nascita").value || ""
  };

  const idx = anagrafica.findIndex(x=>upper(x.cf)===cf);
  if(idx>=0) anagrafica[idx] = rec; else anagrafica.push(rec);

  saveStore(); clearAnagForm(); refreshAll(); toast("Cliente salvato ‚úÖ");
}
function editAnag(cf){
  const a = anagByCF(cf);
  if(!a){ toast("Cliente non trovato"); return; }
  qs("#a_cf").value=a.cf; qs("#a_nome").value=a.nome; qs("#a_cognome").value=a.cognome;
  qs("#a_tipo").value=a.tipo||""; qs("#a_telefono").value=a.telefono||""; qs("#a_email").value=a.email||"";
  qs("#a_citta").value=a.citta||""; qs("#a_indirizzo").value=a.indirizzo||""; qs("#a_data_nascita").value=a.data_nascita||"";
  toast("Modifica cliente: " + a.cf);
}
function deleteAnag(cf){
  const key = upper(cf);
  const hasFK = contratti.some(x=>upper(x.cf)===key) || device.some(x=>upper(x.cf)===key) || riparazioni.some(x=>upper(x.cf)===key);
  if(hasFK){ toast("Non puoi eliminare: esistono record collegati (FK)."); return; }
  anagrafica = anagrafica.filter(x=>upper(x.cf)!==key);
  saveStore(); refreshAll(); toast("Cliente eliminato");
}

function clearConForm(){
  [
    "c_id","c_id_cliente","c_cf","c_data_contratto","c_tipo_cliente",
    "c_compagnia","c_tecnologia","c_tipo_attivazione","c_numero_lavorato",
    "c_mnp","c_compagnia_provenienza","c_convergenza","c_modem_spedito_da",
    "c_iccid_vecchio","c_iccid_nuovo",
    "c_nome_offerta","c_costo_offerta","c_tipo_pagamento","c_vincolo_offerta_mesi",
    "c_telefono_incluso","c_imei","c_marca","c_modello","c_mesi_vincolo_telefono",
    "c_modalita_rate_telefono","c_anticipo",
    "c_data_attivazione","c_data_portabilita",
    "c_data_fine_vincolo_offerta","c_data_fine_vincolo_telefono",
    "c_created_at","c_updated_at"
  ].forEach(id=>{ const el=qs("#"+id); if(el) el.value=""; });

  qs("#c_data_contratto").value = todayISO();
  qs("#conQuickAnag").style.display = "none";
  qs("#c_cf_status").textContent = "Inserisci CF e premi ‚ÄúCerca cliente‚Äù.";
  qs("#modemBox").style.display = "none";
}
function saveCon(){
  const id = (qs("#c_id").value||"").trim() || safeId("C");
  const cf = upper(qs("#c_cf").value);
  if(!cf){ toast("CF obbligatorio"); return; }

  // prima verifica FK: se non esiste, mostra anagrafica veloce
  if(!mustHaveFK(cf)){
    qs("#qa_cf").value = cf;
    qs("#conQuickAnag").style.display = "block";
    qs("#c_cf_status").textContent = "Cliente NON trovato: compila l‚Äôanagrafica veloce qui sotto e poi salva.";
    toast("Cliente non trovato: crea anagrafica veloce üëá");
    return;
  }

  const tecnologia = upper(qs("#c_tecnologia").value);
  const modem_spedito_da = (["FTTC","FTTH","FWA"].includes(tecnologia)) ? upper(qs("#c_modem_spedito_da").value) : "";
  if(["FTTC","FTTH","FWA"].includes(tecnologia) && !modem_spedito_da){ toast("Per FTTC/FTTH/FWA seleziona: modem spedito da WindTre o Kolme"); return; }

  const rec = {
    id,
    id_cliente: upper(qs("#c_id_cliente").value),
    cf,
    data_contratto: qs("#c_data_contratto").value || todayISO(),

    tipo_cliente: upper(qs("#c_tipo_cliente").value),

    compagnia: upper(qs("#c_compagnia").value),
    tecnologia,
    tipo_attivazione: upper(qs("#c_tipo_attivazione").value),
    numero_lavorato: (qs("#c_numero_lavorato").value||"").trim(),

    mnp: upper(qs("#c_mnp").value),
    compagnia_provenienza: upper(qs("#c_compagnia_provenienza").value),

    iccid_vecchio: upper(qs("#c_iccid_vecchio").value),
    iccid_nuovo: upper(qs("#c_iccid_nuovo").value),

    nome_offerta: upper(qs("#c_nome_offerta").value),
    costo_offerta: (qs("#c_costo_offerta").value||"").toString().trim(),
    tipo_pagamento: upper(qs("#c_tipo_pagamento").value),
    vincolo_offerta_mesi: (qs("#c_vincolo_offerta_mesi").value||"").toString().trim(),

    convergenza: upper(qs("#c_convergenza").value),
    telefono_incluso: upper(qs("#c_telefono_incluso").value),

    imei: upper(qs("#c_imei").value),
    marca: upper(qs("#c_marca").value),
    modello: upper(qs("#c_modello").value),

    mesi_vincolo_telefono: (qs("#c_mesi_vincolo_telefono").value||"").toString().trim(),
    modalita_rate_telefono: upper(qs("#c_modalita_rate_telefono").value),
    anticipo: (qs("#c_anticipo").value||"").toString().trim(),

    modem_spedito_da,

    data_attivazione: qs("#c_data_attivazione").value || "",
    data_portabilita: qs("#c_data_portabilita").value || "",
    data_fine_vincolo_offerta: qs("#c_data_fine_vincolo_offerta").value || "",
    data_fine_vincolo_telefono: qs("#c_data_fine_vincolo_telefono").value || "",

    created_at: (qs("#c_created_at").value||"").trim(),
    updated_at: (qs("#c_updated_at").value||"").trim()
  };

  const idx = contratti.findIndex(x=>x.id===id);
  if(idx>=0) contratti[idx]=rec; else contratti.push(rec);

  saveStore(); clearConForm(); refreshAll(); lastSaved.con = rec;
  const pb=document.getElementById("btnPrintConReceipt"); if(pb){ pb.disabled=false; }
  toast("Contratto salvato ‚úÖ");
}
function editCon(id){
  const c = contratti.find(x=>x.id===id);
  if(!c){ toast("Contratto non trovato"); return; }

  qs("#c_id").value=c.id||"";
  qs("#c_id_cliente").value=c.id_cliente||"";
  qs("#c_cf").value=c.cf||"";
  qs("#c_data_contratto").value=toDateISO(c.data_contratto)||todayISO();

  qs("#c_tipo_cliente").value=c.tipo_cliente||"";
  qs("#c_compagnia").value=c.compagnia||"";
  qs("#c_tecnologia").value=c.tecnologia||"";
  qs("#c_tipo_attivazione").value=c.tipo_attivazione||"";
  qs("#c_numero_lavorato").value=c.numero_lavorato||"";
  qs("#c_mnp").value=c.mnp||"";
  qs("#c_compagnia_provenienza").value=c.compagnia_provenienza||"";
  qs("#c_convergenza").value=c.convergenza||"";

  qs("#c_iccid_vecchio").value=c.iccid_vecchio||"";
  qs("#c_iccid_nuovo").value=c.iccid_nuovo||"";

  qs("#c_nome_offerta").value=c.nome_offerta||"";
  qs("#c_costo_offerta").value=c.costo_offerta||"";
  qs("#c_tipo_pagamento").value=c.tipo_pagamento||"";
  qs("#c_vincolo_offerta_mesi").value=c.vincolo_offerta_mesi||"";

  qs("#c_telefono_incluso").value=c.telefono_incluso||"";
  qs("#c_imei").value=c.imei||"";
  qs("#c_marca").value=c.marca||"";
  qs("#c_modello").value=c.modello||"";
  qs("#c_mesi_vincolo_telefono").value=c.mesi_vincolo_telefono||"";
  qs("#c_modalita_rate_telefono").value=c.modalita_rate_telefono||"";
  qs("#c_anticipo").value=c.anticipo||"";

  qs("#c_modem_spedito_da").value=c.modem_spedito_da||"";
  qs("#c_data_attivazione").value=toDateISO(c.data_attivazione)||"";
  qs("#c_data_portabilita").value=toDateISO(c.data_portabilita)||"";
  qs("#c_data_fine_vincolo_offerta").value=toDateISO(c.data_fine_vincolo_offerta)||"";
  qs("#c_data_fine_vincolo_telefono").value=toDateISO(c.data_fine_vincolo_telefono)||"";

  qs("#c_created_at").value=c.created_at||"";
  qs("#c_updated_at").value=c.updated_at||"";

  // mostra/nascondi modem
  const tec = (c.tecnologia||"").toUpperCase();
  qs("#modemBox").style.display = (["FTTC","FTTH","FWA"].includes(tec)) ? "" : "none";

  // stato cliente
  if(mustHaveFK(c.cf||"")){
    qs("#c_cf_status").textContent = "Cliente trovato ‚úÖ Puoi salvare/modificare il contratto.";
  }else{
    qs("#c_cf_status").textContent = "Attenzione: CF non trovato in Anagrafica (FK).";
  }

  showView("contratti");
}
function deleteCon(id){
  contratti = contratti.filter(x=>x.id!==id);
  saveStore(); refreshAll(); toast("Contratto eliminato");
}

function clearDevForm(){
  ["d_id","d_cf","d_data","d_modello","d_imei","d_prezzo","d_venditore","d_pagamento"].forEach(id=>qs("#"+id).value="");
  qs("#d_data").value = todayISO();
}
function saveDev(){
  const id = (qs("#d_id").value||"").trim() || safeId("D");
  const cf = upper(qs("#d_cf").value);
  const modello = upper(qs("#d_modello").value);
  if(!cf || !modello){ toast("CF e Modello sono obbligatori"); return; }
  if(!mustHaveFK(cf)){ toast("CF non presente in Anagrafica (FK)"); return; }

  const rec = {
    id, cf,
    data: qs("#d_data").value || todayISO(),
    modello,
    imei: upper(qs("#d_imei").value),
    prezzo: (qs("#d_prezzo").value||"").trim(),
    venditore: upper(qs("#d_venditore").value),
    pagamento: upper(qs("#d_pagamento").value)
  };

  const idx = device.findIndex(x=>x.id===id);
  if(idx>=0) device[idx]=rec; else device.push(rec);
  saveStore(); clearDevForm(); refreshAll(); lastSaved.dev = rec;
  const pb=document.getElementById("btnPrintDevReceipt"); if(pb){ pb.disabled=false; }
  toast("Device salvato ‚úÖ");
}
function editDev(id){
  const d = device.find(x=>x.id===id);
  if(!d){ toast("Device non trovato"); return; }
  qs("#d_id").value=d.id; qs("#d_cf").value=d.cf; qs("#d_data").value=toDateISO(d.data)||todayISO();
  qs("#d_modello").value=d.modello||""; qs("#d_imei").value=d.imei||""; qs("#d_prezzo").value=d.prezzo||"";
  qs("#d_venditore").value=d.venditore||""; qs("#d_pagamento").value=d.pagamento||"";
  toast("Modifica device: " + id);
}
function deleteDev(id){
  device = device.filter(x=>x.id!==id);
  saveStore(); refreshAll(); toast("Device eliminato");
}

function clearRipForm(){
  ["r_id","r_cf","r_ingresso","r_modello","r_imei","r_problema","r_stato","r_costo"].forEach(id=>qs("#"+id).value="");
  qs("#r_ingresso").value = todayISO();
}
function saveRip(){
  const id = (qs("#r_id").value||"").trim() || safeId("R");
  const cf = upper(qs("#r_cf").value);
  const modello = upper(qs("#r_modello").value);
  if(!cf || !modello){ toast("CF e Modello sono obbligatori"); return; }
  if(!mustHaveFK(cf)){ toast("CF non presente in Anagrafica (FK)"); return; }

  const rec = {
    id, cf,
    data_ingresso: qs("#r_ingresso").value || todayISO(),
    modello,
    imei: upper(qs("#r_imei").value),
    problema: upper(qs("#r_problema").value),
    stato: upper(qs("#r_stato").value),
    costo: (qs("#r_costo").value||"").trim()
  };

  const idx = riparazioni.findIndex(x=>x.id===id);
  if(idx>=0) riparazioni[idx]=rec; else riparazioni.push(rec);
  saveStore(); clearRipForm(); refreshAll(); lastSaved.rip = rec;
  const pb=document.getElementById("btnPrintRipReceipt"); if(pb){ pb.disabled=false; }
  toast("Riparazione salvata ‚úÖ");
}
function editRip(id){
  const r = riparazioni.find(x=>x.id===id);
  if(!r){ toast("Riparazione non trovata"); return; }
  qs("#r_id").value=r.id; qs("#r_cf").value=r.cf; qs("#r_ingresso").value=toDateISO(r.data_ingresso)||todayISO();
  qs("#r_modello").value=r.modello||""; qs("#r_imei").value=r.imei||""; qs("#r_problema").value=r.problema||"";
  qs("#r_stato").value=r.stato||""; qs("#r_costo").value=r.costo||"";
  toast("Modifica riparazione: " + id);
}
function deleteRip(id){
  riparazioni = riparazioni.filter(x=>x.id!==id);
  saveStore(); refreshAll(); toast("Riparazione eliminata");
}

/* =========================
   REPORT (agganciato ai campi contratti completi)
========================= */
function withinRange(dateISO, fromISO, toISO){
  if(!dateISO) return false;
  if(fromISO && dateISO < fromISO) return false;
  if(toISO && dateISO > toISO) return false;
  return true;
}
function anyContains(obj, q){
  if(!q) return true;
  return upper(JSON.stringify(obj||{})).includes(upper(q));
}
function runReport(){
  const tipo = upper(qs("#f_tipo").value);
  const cf = upper(qs("#f_cf").value);
  const nome = upper(qs("#f_nome").value);
  const cont = upper(qs("#f_contatto").value);
  const citta = upper(qs("#f_citta").value);
  const comp = upper(qs("#f_compagnia").value);
  const off = upper(qs("#f_offerta").value);
  const tech = upper(qs("#f_tecnologia").value);

  const tipoAtt = upper(qs("#f_tipo_attivazione").value);
  const conv = upper(qs("#f_convergenza").value);
  const mnp = upper(qs("#f_mnp").value);

  const imeiIccid = upper(qs("#f_imei_iccid").value);
  const statoRip = upper(qs("#f_stato_rip").value);
  const vendDev = upper(qs("#f_venditore").value);

  const q = qs("#f_query").value || "";
  const from = qs("#f_from").value || "";
  const to = qs("#f_to").value || "";
  const pMin = toNum(qs("#f_price_min").value);
  const pMax = toNum(qs("#f_price_max").value);

  function passAnag(cfKey){
    const a = anagByCF(cfKey);
    if(cf && upper(cfKey) !== cf) return false;
    if(nome){
      const full = a ? upper((a.nome||"")+" "+(a.cognome||"")) : "";
      if(!full.includes(nome)) return false;
    }
    if(cont){
      const blob = a ? upper((a.telefono||"")+" "+(a.email||"")) : "";
      if(!blob.includes(cont)) return false;
    }
    if(citta){
      const cc = a ? upper(a.citta||"") : "";
      if(!cc.includes(citta)) return false;
    }
    return true;
  }

  const rows = [];

  if(!tipo || tipo==="CONTRATTO"){
    contratti.forEach(x=>{
      const date = toDateISO(x.data_contratto || x.data);
      const cfKey = upper(x.cf);
      if(!passAnag(cfKey)) return;
      if(comp && !upper(x.compagnia||"").includes(comp)) return;
      if(off && !upper(x.nome_offerta||"").includes(off)) return;
      if(tech && !upper(x.tecnologia||"").includes(tech)) return;

      if(tipoAtt && !upper(x.tipo_attivazione||"").includes(tipoAtt)) return;
      if(conv && !upper(x.convergenza||"").includes(conv)) return;
      if(mnp && !upper(x.mnp||"").includes(mnp)) return;

      if(from || to){ if(!withinRange(date, from, to)) return; }
      if(imeiIccid && !anyContains(x, imeiIccid)) return;
      if(!anyContains(x, q)) return;

      const a = anagByCF(cfKey);
      rows.push({
        tipo:"CONTRATTO",
        date,
        cf: cfKey,
        cliente: clienteNome(cfKey),
        contatto: contattoStr(cfKey),
        citta: a?.citta || "",
        descr: `${upper(x.compagnia||"")} ‚Ä¢ ${upper(x.nome_offerta||"")}`,
        extra: `ATT: ${upper(x.tipo_attivazione||"")} | TEC: ${upper(x.tecnologia||"")} | MNP: ${upper(x.mnp||"")} | NUM: ${(x.numero_lavorato||"")} | ICCID: ${upper(x.iccid_nuovo||"")}`,
        _sumDev:0,_sumRip:0
      });
    });
  }

  if(!tipo || tipo==="DEVICE"){
    device.forEach(x=>{
      const date = toDateISO(x.data);
      const cfKey = upper(x.cf);
      if(!passAnag(cfKey)) return;
      if(vendDev && !upper(x.venditore||"").includes(vendDev)) return;
      if(from || to){ if(!withinRange(date, from, to)) return; }
      const price = toNum(x.prezzo);
      if(pMin!=null && (price==null || price < pMin)) return;
      if(pMax!=null && (price==null || price > pMax)) return;
      if(imeiIccid && !anyContains(x, imeiIccid)) return;
      if(!anyContains(x, q)) return;

      const a = anagByCF(cfKey);
      rows.push({
        tipo:"DEVICE",
        date,
        cf: cfKey,
        cliente: clienteNome(cfKey),
        contatto: contattoStr(cfKey),
        citta: a?.citta || "",
        descr: `${upper(x.modello||"")}`,
        extra: `IMEI: ${upper(x.imei||"")} | ‚Ç¨ ${price!=null ? price : ""} | VEND: ${upper(x.venditore||"")} | PAY: ${upper(x.pagamento||"")}`,
        _sumDev: price||0,_sumRip:0
      });
    });
  }

  if(!tipo || tipo==="RIPARAZIONE"){
    riparazioni.forEach(x=>{
      const date = toDateISO(x.data_ingresso);
      const cfKey = upper(x.cf);
      if(!passAnag(cfKey)) return;
      if(statoRip && !upper(x.stato||"").includes(statoRip)) return;
      if(from || to){ if(!withinRange(date, from, to)) return; }
      if(!anyContains(x, q)) return;

      const cost = toNum(x.costo);
      const a = anagByCF(cfKey);
      rows.push({
        tipo:"RIPARAZIONE",
        date,
        cf: cfKey,
        cliente: clienteNome(cfKey),
        contatto: contattoStr(cfKey),
        citta: a?.citta || "",
        descr: `${upper(x.modello||"")} ‚Ä¢ ${upper(x.problema||"")}`,
        extra: `STATO: ${upper(x.stato||"")} | ‚Ç¨ ${cost!=null ? cost : ""} | IMEI: ${upper(x.imei||"")}`,
        _sumDev:0,_sumRip: cost||0
      });
    });
  }

  rows.sort((a,b)=>(b.date||"").localeCompare(a.date||""));
  reportRows = rows;

  qs("#tblReport tbody").innerHTML = rows.map(r=>{
    const badgeCls = r.tipo==="CONTRATTO" ? "" : (r.tipo==="DEVICE" ? "good" : "warn");
    return `<tr>
      <td><span class="badge ${badgeCls}">${r.tipo}</span></td>
      <td>${r.date||""}</td>
      <td class="mono">${r.cf}</td>
      <td>${r.cliente||""}</td>
      <td>${r.contatto||""}</td>
      <td>${r.citta||""}</td>
      <td>${r.descr||""}</td>
      <td>${r.extra||""}</td>
    </tr>`;
  }).join("") || `<tr><td colspan="8" class="muted">Nessun risultato.</td></tr>`;

  const sumDev = rows.reduce((s,r)=>s+(r._sumDev||0),0);
  const sumRip = rows.reduce((s,r)=>s+(r._sumRip||0),0);
  setText("rep_total", rows.length);
  setText("rep_sum_dev", moneyFmt(sumDev));
  setText("rep_sum_rip", moneyFmt(sumRip));

  lastReportTypeCounts = {
    CONTRATTO: rows.filter(r=>r.tipo==="CONTRATTO").length,
    DEVICE: rows.filter(r=>r.tipo==="DEVICE").length,
    RIPARAZIONE: rows.filter(r=>r.tipo==="RIPARAZIONE").length
  };

  const ctx = qs("#chartReportTypes").getContext("2d");
  qs("#chartReportTypes").width = qs("#chartReportTypes").clientWidth * devicePixelRatio;
  qs("#chartReportTypes").height = qs("#chartReportTypes").clientHeight * devicePixelRatio;
  drawBarChart(ctx, qs("#chartReportTypes").width, qs("#chartReportTypes").height, [
    {label:"CONTR", value:lastReportTypeCounts.CONTRATTO},
    {label:"DEV", value:lastReportTypeCounts.DEVICE},
    {label:"RIP", value:lastReportTypeCounts.RIPARAZIONE},
  ], "");

  setText("dbg", `Report: ${rows.length} righe ‚Ä¢ Dev‚Ç¨=${sumDev} ‚Ä¢ Rip‚Ç¨=${sumRip}`);
  toast("Report aggiornato ‚úÖ");
}
function resetReport(){
  ["f_tipo","f_cf","f_nome","f_contatto","f_citta","f_compagnia","f_offerta","f_tecnologia","f_tipo_attivazione","f_convergenza","f_mnp",
   "f_imei_iccid","f_stato_rip","f_venditore","f_query","f_from","f_to","f_price_min","f_price_max"]
    .forEach(id=>qs("#"+id).value="");
  reportRows = [];
  qs("#tblReport tbody").innerHTML = "";
  setText("rep_total","0"); setText("rep_sum_dev","0"); setText("rep_sum_rip","0");
  setText("dbg","‚Äî");
  const c = qs("#chartReportTypes").getContext("2d");
  c.clearRect(0,0, qs("#chartReportTypes").width, qs("#chartReportTypes").height);
  toast("Filtri resettati");
}


/* =========================
   COMPLEANNI
========================= */
function parseBirthFromCF(cf){
  const x = upper(cf||"");
  if(x.length < 11) return null;
  // AA M GG (pos 6-10 0-index 6? In realt√†: 6=Y1? CF: 0-5 lettere, 6-7 anno, 8 mese, 9-10 giorno)
  const yy = parseInt(x.slice(6,8),10);
  const mL = x.slice(8,9);
  const ddRaw = parseInt(x.slice(9,11),10);
  if(Number.isNaN(yy) || Number.isNaN(ddRaw)) return null;
  const months = {A:1,B:2,C:3,D:4,E:5,H:6,L:7,M:8,P:9,R:10,S:11,T:12};
  const mm = months[mL] || null;
  if(!mm) return null;
  const dd = ddRaw>40 ? (ddRaw-40) : ddRaw;
  if(dd<1 || dd>31) return null;

  const now = new Date();
  const curYY = now.getFullYear()%100;
  const fullY = (yy <= curYY) ? (2000+yy) : (1900+yy);
  const d = new Date(fullY, mm-1, dd);
  if(Number.isNaN(d.getTime())) return null;
  return d;
}

function birthDateForClient(a){
  if(a?.data_nascita){
    const d = new Date(a.data_nascita);
    if(!Number.isNaN(d.getTime())) return d;
  }
  return parseBirthFromCF(a?.cf);
}

function nextBirthday(birth, fromDate){
  const f = fromDate || new Date();
  const year = f.getFullYear();
  const mm = birth.getMonth();
  const dd = birth.getDate();
  let next = new Date(year, mm, dd);
  // se gi√† passato quest'anno, anno prossimo
  const start = new Date(year, f.getMonth(), f.getDate());
  if(next < start) next = new Date(year+1, mm, dd);
  return next;
}

function daysBetween(a,b){
  const ms = 24*60*60*1000;
  const aa = new Date(a.getFullYear(), a.getMonth(), a.getDate()).getTime();
  const bb = new Date(b.getFullYear(), b.getMonth(), b.getDate()).getTime();
  return Math.round((bb-aa)/ms);
}

function runBirthdays(){
  const month = parseInt(qs("#b_month").value || "0",10);
  const days = parseInt(qs("#b_days").value || "30",10);
  const today = new Date();

  let rows = anagrafica
    .map(a=>{
      const birth = birthDateForClient(a);
      if(!birth) return null;
      const next = nextBirthday(birth, today);
      const dleft = daysBetween(today, next);
      return {a, birth, next, dleft};
    })
    .filter(Boolean);

  if(month){
    rows = rows.filter(r => (r.next.getMonth()+1)===month);
  }
  if(days && !Number.isNaN(days)){
    rows = rows.filter(r => r.dleft>=0 && r.dleft<=days);
  }

  rows.sort((x,y)=>x.dleft-y.dleft);

  qs("#b_summary").innerHTML = `<b>${rows.length}</b> compleanni trovati` + (month?` ‚Ä¢ mese ${month}`:"") + (days?` ‚Ä¢ prossimi ${days} giorni`:"");
  qs("#tblBirthdays tbody").innerHTML = rows.map(r=>{
    const phone = r.a.telefono || "";
    return `<tr>
      <td>${toDateISO(r.next)}</td>
      <td>${r.dleft}</td>
      <td class="mono">${r.a.cf}</td>
      <td>${(r.a.nome||"")+" "+(r.a.cognome||"")}</td>
      <td>${toDateISO(r.birth)}</td>
      <td>${phone}</td>
      <td>${phone ? `<a class="btn secondary small" href="${waLink(phone)}" target="_blank" rel="noopener" style="text-decoration:none">üí¨</a>` : "‚Äî"}</td>
    </tr>`;
  }).join("") || `<tr><td colspan="7" class="muted">Nessun compleanno nel filtro.</td></tr>`;

  // salva per export
  window.__birthRows = rows.map(r=>({
    prossimo: toDateISO(r.next),
    giorni: r.dleft,
    cf: r.a.cf,
    nome: r.a.nome||"",
    cognome: r.a.cognome||"",
    data_nascita: toDateISO(r.birth),
    telefono: r.a.telefono||"",
    email: r.a.email||"",
    citta: r.a.citta||""
  }));
}

function exportBirthdaysCSV(){
  const rows = window.__birthRows || [];
  const headers = ["prossimo","giorni","cf","nome","cognome","data_nascita","telefono","email","citta"];
  downloadCSV(`compleanni_${todayISO()}.csv`, headers, rows);
}


/* =========================
   WHATSAPP TEMPLATE (eventi + scadenze)
========================= */
function clientFirstName(cf){
  const a = anagByCF(cf);
  const full = ((a?.nome||"") + " " + (a?.cognome||"")).trim();
  const first = (a?.nome||"").trim() || (full.split(" ")[0]||"");
  return first;
}
function buildWaMessageForEvent(cf, ev){
  const name = clientFirstName(cf);
  const hi = name ? `Ciao ${name}, ` : "Ciao, ";
  if(ev.type==="CONTRATTO"){
    return hi + `ti invio un riepilogo del contratto ${ev.title} del ${ev.date}. Se vuoi, posso aiutarti con dettagli, assistenza o upgrade.`;
  }
  if(ev.type==="DEVICE"){
    return hi + `grazie per l'acquisto: ${ev.title} (${ev.date}). Se ti serve supporto o accessori, sono qui.`;
  }
  if(ev.type==="RIPARAZIONE"){
    return hi + `aggiornamento riparazione: ${ev.title} (${ev.date}). Se vuoi, ti dico tempi/costi e stato lavorazione.`;
  }
  return hi + "come posso aiutarti?";
}
function buildWaMessageForDeadline(row){
  const name = clientFirstName(row.cf);
  const hi = name ? `Ciao ${name}, ` : "Ciao, ";
  const when = row.scadenza ? `il ${row.scadenza}` : "a breve";
  const what = row.tipo==="OFFERTA" ? "il vincolo dell'offerta" : "il vincolo del telefono";
  const offer = row.offerta ? ` "${row.offerta}"` : "";
  const carrier = row.compagnia ? ` con ${row.compagnia}` : "";
  return hi + `ti avviso che ${what}${offer}${carrier} scade ${when}. Vuoi che ti proponga un rinnovo/upgrade migliore?`;
}

/* =========================
   SCADENZE / RINNOVI (report)
========================= */
function parseISODateOrNull(s){
  const x = (s||"").toString().trim();
  if(!x) return null;
  const d = new Date(x);
  if(Number.isNaN(d.getTime())) return null;
  return d;
}
function runScadenze(){
  const days = parseInt(qs("#s_days").value || "60",10);
  const tipo = (qs("#s_tipo").value || "").trim(); // OFFERTA / TELEFONO / ""
  const today = new Date();
  const limit = new Date(today.getFullYear(), today.getMonth(), today.getDate() + (Number.isNaN(days)?60:days));

  const out = [];
  contratti.forEach(c=>{
    const cf = upper(c.cf);
    if(!cf) return;

    const dOff = parseISODateOrNull(c.data_fine_vincolo_offerta);
    const dTel = parseISODateOrNull(c.data_fine_vincolo_telefono);

    if(dOff && (!tipo || tipo==="OFFERTA")){
      const left = daysBetween(today, dOff);
      if(left>=0 && dOff<=limit){
        out.push({
          scadenza: toDateISO(dOff),
          tipo: "OFFERTA",
          giorni: left,
          cf,
          cliente: clienteNome(cf),
          numero: (c.numero_lavorato||""),
          compagnia: upper(c.compagnia||""),
          offerta: upper(c.nome_offerta||""),
          telefono: contattoPhone(cf)
        });
      }
    }
    if(dTel && (!tipo || tipo==="TELEFONO")){
      const left = daysBetween(today, dTel);
      if(left>=0 && dTel<=limit){
        out.push({
          scadenza: toDateISO(dTel),
          tipo: "TELEFONO",
          giorni: left,
          cf,
          cliente: clienteNome(cf),
          numero: (c.numero_lavorato||""),
          compagnia: upper(c.compagnia||""),
          offerta: upper(c.nome_offerta||""),
          telefono: contattoPhone(cf)
        });
      }
    }
  });

  out.sort((a,b)=>a.giorni-b.giorni);

  qs("#s_summary").innerHTML = `<b>${out.length}</b> scadenze trovate ‚Ä¢ prossimi ${Number.isNaN(days)?60:days} giorni` + (tipo?` ‚Ä¢ ${tipo}`:"");
  qs("#tblScadenze tbody").innerHTML = out.map(r=>{
    const phone = r.telefono || "";
    const msg = buildWaMessageForDeadline(r);
    return `<tr>
      <td>${r.scadenza}</td>
      <td><span class="badge ${r.giorni<=7?'bad':(r.giorni<=15?'warn':'good')}">${r.tipo}</span></td>
      <td>${r.giorni}</td>
      <td class="mono">${r.cf}</td>
      <td>${r.cliente||""}</td>
      <td>${r.numero||""}</td>
      <td>${r.compagnia||""}</td>
      <td>${r.offerta||""}</td>
      <td>${phone ? `<a class="btn secondary small" href="${waLinkText(phone, msg)}" target="_blank" rel="noopener" style="text-decoration:none">üí¨</a>` : "‚Äî"}</td>
    </tr>`;
  }).join("") || `<tr><td colspan="10" class="muted">Nessuna scadenza nel filtro.</td></tr>`;

  window.__scadRows = out;
}

function exportScadenzeCSV(){
  const rows = window.__scadRows || [];
  const headers = ["scadenza","tipo","giorni","cf","cliente","numero","compagnia","offerta","telefono"];
  downloadCSV(`scadenze_${todayISO()}.csv`, headers, rows);
}

// telefono principale per CF (anagrafica > telefono)
function contattoPhone(cf){
  const a = anagByCF(cf);
  return (a?.telefono||"").toString().trim();
}

/* =========================
   TIMELINE
========================= */
function loadTimeline(){
  const cf = upper(qs("#t_cf").value);
  if(!cf){ toast("Inserisci un CF"); return; }

  qs("#timelineHeader").textContent = `Cliente: ${clienteNome(cf) || "(non in anagrafica)"} ‚Ä¢ CF: ${cf} ‚Ä¢ Contatto: ${contattoStr(cf) || "‚Äî"}`;
  const box = qs("#timelineBox");
  const evs = [];

  contratti.forEach(x=>{
    if(upper(x.cf) !== cf) return;
    evs.push({
      type:"CONTRATTO",
      date: toDateISO(x.data_contratto || x.data),
      title:`${upper(x.compagnia||"")} ‚Äî ${upper(x.nome_offerta||"")}`,
      desc:`ATT: ${upper(x.tipo_attivazione||"")} ‚Ä¢ TEC: ${upper(x.tecnologia||"")} ‚Ä¢ MNP: ${upper(x.mnp||"")} ‚Ä¢ NUM: ${(x.numero_lavorato||"")} ‚Ä¢ ICCID: ${upper(x.iccid_nuovo||"")}`
    });
  });
  device.forEach(x=>{
    if(upper(x.cf) !== cf) return;
    evs.push({ type:"DEVICE", date: toDateISO(x.data), title:`Vendita: ${upper(x.modello||"")}`, desc:`IMEI: ${upper(x.imei||"")} ‚Ä¢ ‚Ç¨ ${toNum(x.prezzo) ?? ""} ‚Ä¢ VEND: ${upper(x.venditore||"")}` });
  });
  riparazioni.forEach(x=>{
    if(upper(x.cf) !== cf) return;
    evs.push({ type:"RIPARAZIONE", date: toDateISO(x.data_ingresso), title:`Riparazione: ${upper(x.modello||"")} (${upper(x.stato||"")})`, desc:`PROBLEMA: ${upper(x.problema||"")} ‚Ä¢ ‚Ç¨ ${toNum(x.costo) ?? ""} ‚Ä¢ IMEI: ${upper(x.imei||"")}` });
  });

  evs.sort((a,b)=>(b.date||"").localeCompare(a.date||""));
  const phone = anagByCF(cf)?.telefono || "";
  box.innerHTML = evs.map(ev=>{
    const cls = ev.type==="DEVICE" ? "good" : (ev.type==="RIPARAZIONE" ? "warn" : "");
    const msg = buildWaMessageForEvent(cf, ev);
    const waBtn = phone ? `<a class="btn secondary small" href="${waLinkText(phone, msg)}" target="_blank" rel="noopener" style="text-decoration:none;display:inline-flex;align-items:center;gap:6px;padding:6px 10px;margin-left:8px">üí¨ WhatsApp</a>` : ``;
    return `<div class="tItem">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
        <div><span class="badge ${cls}">${ev.type}</span> <span class="tTitle">${ev.title}</span></div>
        <div>${waBtn}</div>
      </div>
      <div class="tMeta">${ev.date || ""} ‚Ä¢ ${ev.desc || ""}</div>
    </div>`;
  }).join("") || `<div class="muted">Nessun evento.</div>`;
}


/* =========================
   Scheda Cliente (azioni rapide + liste)
========================= */
let currentClientCF = "";

function openTimeline(cf){
  const x = upper(cf||"");
  if(!x){ toast("Inserisci un CF"); return; }
  qs("#t_cf").value = x;
  // vai alla vista timeline
  qsa("[data-view]").forEach(b=>b.classList.remove("active"));
  qsa(".view").forEach(v=>v.classList.remove("active"));
  qs('[data-view="timeline"]').classList.add("active");
  qs("#view-timeline").classList.add("active");
  pageTitle.textContent = "Timeline Cliente";
  loadTimeline();
  setTimeout(()=>qs("#timelineHeader").scrollIntoView({behavior:"smooth",block:"start"}), 50);
}

function openClientSheet(cf){
  currentClientCF = upper(cf || qs("#cs_search_cf").value);
  if(!currentClientCF){ toast("Inserisci un CF"); return; }
  qs("#cs_search_cf").value = currentClientCF;

  const a = anagByCF(currentClientCF);
  const sum = qs("#cs_summary");
  const wa = qs("#cs_whatsapp");
  const btnTL = qs("#btnClientGoTimeline");

  if(a){
    sum.innerHTML = `<b>${clienteNome(currentClientCF)}</b> ‚Ä¢ CF: <span class="mono">${currentClientCF}</span> ‚Ä¢ ${contattoStr(currentClientCF) || ""} ‚Ä¢ ${a.citta || ""}`;
    if(a.telefono){
      wa.href = waLink(a.telefono);
      wa.style.display = "inline-flex";
    }else{
      wa.style.display = "none";
    }
    btnTL.style.display = "inline-flex";
  }else{
    sum.innerHTML = `Cliente non trovato per CF: <span class="mono">${currentClientCF}</span> (crealo in Anagrafica)`;
    wa.style.display="none";
    btnTL.style.display="none";
  }

  // default date
  qs("#cs_c_data").value = todayISO();
  qs("#cs_d_data").value = todayISO();
  qs("#cs_r_data").value = todayISO();

  renderClientLists();

  // porta l'utente nella vista Anagrafica e scrolla la scheda
  qsa("[data-view]").forEach(x=>x.classList.remove("active"));
  qsa(".view").forEach(v=>v.classList.remove("active"));
  qs('[data-view="anagrafica"]').classList.add("active");
  qs("#view-anagrafica").classList.add("active");
  pageTitle.textContent = "Anagrafica (CRUD)";
  setTimeout(()=>qs("#clientSheetCard").scrollIntoView({behavior:"smooth",block:"start"}), 50);
}

function renderClientLists(){
  const cf = currentClientCF;
  if(!cf){
    qs("#cs_tbl_con tbody").innerHTML = `<tr><td colspan="4" class="muted">Seleziona un cliente.</td></tr>`;
    qs("#cs_tbl_dev tbody").innerHTML = `<tr><td colspan="4" class="muted">Seleziona un cliente.</td></tr>`;
    qs("#cs_tbl_rip tbody").innerHTML = `<tr><td colspan="4" class="muted">Seleziona un cliente.</td></tr>`;
    return;
  }

  const con = contratti.filter(x=>upper(x.cf)===cf).slice().sort((a,b)=>(toDateISO(b.data_contratto||b.data)||"").localeCompare(toDateISO(a.data_contratto||a.data)||"")).slice(0,8);
  const dev = device.filter(x=>upper(x.cf)===cf).slice().sort((a,b)=>(toDateISO(b.data)||"").localeCompare(toDateISO(a.data)||"")).slice(0,8);
  const rip = riparazioni.filter(x=>upper(x.cf)===cf).slice().sort((a,b)=>(toDateISO(b.data_ingresso)||"").localeCompare(toDateISO(a.data_ingresso)||"")).slice(0,8);

  qs("#cs_tbl_con tbody").innerHTML = con.map(x=>`
    <tr><td>${toDateISO(x.data_contratto||x.data)}</td><td>${x.compagnia||""}</td><td>${x.nome_offerta||x.offerta||""}</td><td>${x.mnp||""}</td></tr>
  `).join("") || `<tr><td colspan="4" class="muted">Nessun contratto.</td></tr>`;

  qs("#cs_tbl_dev tbody").innerHTML = dev.map(x=>`
    <tr><td>${toDateISO(x.data)}</td><td>${x.modello||""}</td><td class="mono">${x.imei||""}</td><td>${toNum(x.prezzo)!=null?moneyFmt(toNum(x.prezzo)):"‚Äî"}</td></tr>
  `).join("") || `<tr><td colspan="4" class="muted">Nessun device.</td></tr>`;

  qs("#cs_tbl_rip tbody").innerHTML = rip.map(x=>`
    <tr><td>${toDateISO(x.data_ingresso)}</td><td>${x.modello||""}</td><td>${x.stato||""}</td><td>${toNum(x.costo)!=null?moneyFmt(toNum(x.costo)):"‚Äî"}</td></tr>
  `).join("") || `<tr><td colspan="4" class="muted">Nessuna riparazione.</td></tr>`;
}

function csSaveCon(){
  const cf = currentClientCF;
  if(!cf){ toast("Seleziona un cliente"); return; }
  if(!mustHaveFK(cf)){ toast("Cliente non presente in Anagrafica"); return; }

  const rec = {
    id: (qs("#cs_c_id").value||"").trim() || safeId("C"),
    id_cliente: "",
    cf,
    data_contratto: qs("#cs_c_data").value || todayISO(),
    tipo_cliente: anagByCF(cf)?.tipo || "",
    tipo_attivazione: "",
    tecnologia: "",
    convergenza: "",
    mnp: upper(qs("#cs_c_mnp").value),
    data_attivazione: "",
    data_portabilita: "",
    numero_lavorato: (qs("#cs_c_numero").value||"").trim(),
    nome_offerta: upper(qs("#cs_c_offerta").value),
    costo_offerta: "",
    vincolo_offerta_mesi: "",
    telefono_incluso: "",
    imei: "",
    modello: "",
    tipo_pagamento: "",
    mesi_vincolo_telefono: "",
    data_fine_vincolo_offerta: "",
    data_fine_vincolo_telefono: "",
    compagnia: upper(qs("#cs_c_compagnia").value),
    iccid_vecchio: "",
    iccid_nuovo: "",
    created_at: "",
    updated_at: ""
  };

  contratti.push(rec);
  saveStore();
  syncValueSettingsUI();
  bindValueSettings();
  bindCampaignUI();
  renderCampaignSelect();
  refreshAll();
  // Dopo refresh, rigenera suggerimenti per avere score aggiornati
  try{ buildSmartSuggestions(); renderCampaignSelect(); }catch(e){}
  renderClientLists();
  toast("Contratto salvato dalla scheda ‚úÖ");
  qs("#cs_c_id").value="";
  qs("#cs_c_compagnia").value="";
  qs("#cs_c_offerta").value="";
  qs("#cs_c_numero").value="";
  qs("#cs_c_mnp").value="";
}

function csSaveDev(){
  const cf = currentClientCF;
  if(!cf){ toast("Seleziona un cliente"); return; }
  if(!mustHaveFK(cf)){ toast("Cliente non presente in Anagrafica"); return; }

  const modello = upper(qs("#cs_d_modello").value);
  if(!modello){ toast("Modello obbligatorio"); return; }

  const rec = {
    id: (qs("#cs_d_id").value||"").trim() || safeId("D"),
    cf,
    data: qs("#cs_d_data").value || todayISO(),
    modello,
    imei: upper(qs("#cs_d_imei").value),
    prezzo: (qs("#cs_d_prezzo").value||"").trim(),
    venditore: upper(qs("#cs_d_venditore").value),
    pagamento: ""
  };
  device.push(rec);
  saveStore(); refreshAll(); renderClientLists();
  toast("Device salvato dalla scheda ‚úÖ");
  ["cs_d_id","cs_d_modello","cs_d_imei","cs_d_prezzo","cs_d_venditore"].forEach(id=>qs("#"+id).value="");
}

function csSaveRip(){
  const cf = currentClientCF;
  if(!cf){ toast("Seleziona un cliente"); return; }
  if(!mustHaveFK(cf)){ toast("Cliente non presente in Anagrafica"); return; }

  const modello = upper(qs("#cs_r_modello").value);
  if(!modello){ toast("Modello obbligatorio"); return; }

  const rec = {
    id: (qs("#cs_r_id").value||"").trim() || safeId("R"),
    cf,
    data_ingresso: qs("#cs_r_data").value || todayISO(),
    modello,
    imei: upper(qs("#cs_r_imei").value),
    problema: upper(qs("#cs_r_problema").value),
    stato: upper(qs("#cs_r_stato").value),
    costo: (qs("#cs_r_costo").value||"").trim()
  };
  riparazioni.push(rec);
  saveStore(); refreshAll(); renderClientLists();
  toast("Riparazione salvata dalla scheda ‚úÖ");
  ["cs_r_id","cs_r_modello","cs_r_imei","cs_r_problema","cs_r_stato","cs_r_costo"].forEach(id=>qs("#"+id).value="");
}

function csOpenFull(section){
  // prefill CF sul modulo completo e apri la vista
  if(!currentClientCF){ toast("Seleziona un cliente"); return; }
  if(section==="contratti"){
    qsa("[data-view]").forEach(x=>x.classList.remove("active"));
    qsa(".view").forEach(v=>v.classList.remove("active"));
    qs('[data-view="contratti"]').classList.add("active");
    qs("#view-contratti").classList.add("active");
    pageTitle.textContent = "Contratti (CRUD)";
    qs("#c_cf").value = currentClientCF;
    conFindClient();
    setTimeout(()=>qs("#c_cf").scrollIntoView({behavior:"smooth",block:"center"}), 50);
  }
  if(section==="device"){
    qsa("[data-view]").forEach(x=>x.classList.remove("active"));
    qsa(".view").forEach(v=>v.classList.remove("active"));
    qs('[data-view="device"]').classList.add("active");
    qs("#view-device").classList.add("active");
    pageTitle.textContent = "Device (CRUD)";
    qs("#d_cf").value = currentClientCF;
    setTimeout(()=>qs("#d_modello").focus(), 50);
  }
  if(section==="riparazioni"){
    qsa("[data-view]").forEach(x=>x.classList.remove("active"));
    qsa(".view").forEach(v=>v.classList.remove("active"));
    qs('[data-view="riparazioni"]').classList.add("active");
    qs("#view-riparazioni").classList.add("active");
    pageTitle.textContent = "Riparazioni (CRUD)";
    qs("#r_cf").value = currentClientCF;
    setTimeout(()=>qs("#r_modello").focus(), 50);
  }
}

/* =========================
   CHART DATA + DRAW
========================= */
function dateRangeLabels(days=30){
  const out = [];
  const d = new Date();
  d.setHours(0,0,0,0);
  d.setDate(d.getDate()-(days-1));
  for(let i=0;i<days;i++){
    out.push(d.toISOString().slice(0,10));
    d.setDate(d.getDate()+1);
  }
  return out;
}
function countByDay(labels, items, dateField){
  const map = new Map(labels.map(l=>[l,0]));
  items.forEach(it=>{
    const d = toDateISO(it[dateField]);
    if(map.has(d)) map.set(d, map.get(d)+1);
  });
  return labels.map(l=>map.get(l)||0);
}
function topCounts(items, keyFn, limit=8){
  const m = new Map();
  items.forEach(it=>{
    const k = upper(keyFn(it) || "‚Äî");
    m.set(k, (m.get(k)||0)+1);
  });
  const arr = [...m.entries()].map(([label,value])=>({label,value}));
  arr.sort((a,b)=>b.value-a.value);
  return arr.slice(0,limit);
}
function drawAllCharts(){
  const { con30, dev30, rip30 } = compute30();

  // 1) Torta attivit√† 30gg per tipo
  const activities = [
    { label: "Contratti", value: con30.length },
    { label: "Device", value: dev30.length },
    { label: "Riparazioni", value: rip30.length }
  ];
  {
    const c = qs("#chartDaily");
    if(c){
      const ctx = c.getContext("2d");
      c.width = c.clientWidth * devicePixelRatio;
      c.height = c.clientHeight * devicePixelRatio;
      drawPieChart(ctx, c.width, c.height, activities, "Attivit√† 30 giorni");
    }
  }

  // 2) Torta top venditori (contratti + device ultimi 30gg)
  const sellers = topCounts([...con30, ...dev30], it => it.venditore || "SENZA VENDITORE", 8);
  {
    const c = qs("#chartSellers");
    if(c){
      const ctx = c.getContext("2d");
      c.width = c.clientWidth * devicePixelRatio;
      c.height = c.clientHeight * devicePixelRatio;
      drawPieChart(ctx, c.width, c.height, sellers, "Venditori 30 giorni");
    }
  }

  // 3) Torta contratti per compagnia (ultimi 30gg)
  const companies = topCounts(con30, it => it.compagnia || "SENZA COMPAGNIA", 8);
  {
    const c = qs("#chartCompanies");
    if(c){
      const ctx = c.getContext("2d");
      c.width = c.clientWidth * devicePixelRatio;
      c.height = c.clientHeight * devicePixelRatio;
      drawPieChart(ctx, c.width, c.height, companies, "Compagnie 30 giorni");
    }
  }
}

/* =========================
   IMPORT CSV (SMART)
========================= */
function importAnagFromRows(rows){
  let ok=0, skip=0;
  rows.forEach(r=>{
    const m = mapRowSmart(r, SCHEMA_ANAG);
    const cf = upper(m.cf);
    const nome = upper(m.nome);
    const cognome = upper(m.cognome);
    if(!cf || !nome || !cognome){ skip++; return; }
    const rec = {
      cf, nome, cognome,
      tipo: upper(m.tipo || ""),
      telefono: (m.telefono || "").trim(),
      email: (m.email || "").trim(),
      citta: upper(m.citta || ""),
      indirizzo: upper(m.indirizzo || ""),
      data_nascita: toDateISO(m.data_nascita) || ""
    };
    const idx = anagrafica.findIndex(x=>upper(x.cf)===cf);
    if(idx>=0) anagrafica[idx]=rec; else anagrafica.push(rec);
    ok++;
  });
  return {ok, skip};
}
function importConFromRows(rows){
  let ok=0, skip=0, fk=0;

  rows.forEach(r=>{
    const m = mapRowSmart(r, SCHEMA_CON);
    const cf = upper(m.cf);
    if(!cf){ skip++; return; }
    if(!mustHaveFK(cf)){ fk++; return; }

    const tecnologia = upper(m.tecnologia || "");
    const rec = {
      id: (m.id || "").trim() || safeId("C"),
      id_cliente: upper(m.id_cliente || ""),
      cf,

      data_contratto: toDateISO(m.data_contratto) || todayISO(),
      tipo_cliente: upper(m.tipo_cliente || ""),

      compagnia: upper(m.compagnia || ""),
      tecnologia,
      tipo_attivazione: upper(m.tipo_attivazione || ""),
      numero_lavorato: (m.numero_lavorato || "").trim(),

      mnp: upper(m.mnp || ""),
      compagnia_provenienza: upper(m.compagnia_provenienza || ""),

      iccid_vecchio: upper(m.iccid_vecchio || ""),
      iccid_nuovo: upper(m.iccid_nuovo || ""),

      nome_offerta: upper(m.nome_offerta || ""),
      costo_offerta: (m.costo_offerta || "").toString().replace(",",".").trim(),
      tipo_pagamento: upper(m.tipo_pagamento || ""),
      vincolo_offerta_mesi: (m.vincolo_offerta_mesi || "").toString().trim(),

      convergenza: upper(m.convergenza || ""),
      telefono_incluso: upper(m.telefono_incluso || ""),

      imei: upper(m.imei || ""),
      marca: upper(m.marca || ""),
      modello: upper(m.modello || ""),

      mesi_vincolo_telefono: (m.mesi_vincolo_telefono || "").toString().trim(),
      modalita_rate_telefono: upper(m.modalita_rate_telefono || ""),
      anticipo: (m.anticipo || "").toString().replace(",",".").trim(),

      modem_spedito_da: (["FTTC","FTTH","FWA"].includes(tecnologia)) ? upper(m.modem_spedito_da || "") : "",

      data_attivazione: toDateISO(m.data_attivazione) || "",
      data_portabilita: toDateISO(m.data_portabilita) || "",
      data_fine_vincolo_offerta: toDateISO(m.data_fine_vincolo_offerta) || "",
      data_fine_vincolo_telefono: toDateISO(m.data_fine_vincolo_telefono) || "",

      created_at: (m.created_at || "").trim(),
      updated_at: (m.updated_at || "").trim()
    };

    const idx = contratti.findIndex(x=>x.id===rec.id);
    if(idx>=0) contratti[idx]=rec; else contratti.push(rec);
    ok++;
  });

  return {ok, skip, fk};
}
function importDevFromRows(rows){
  let ok=0, skip=0, fk=0;
  rows.forEach(r=>{
    const m = mapRowSmart(r, SCHEMA_DEV);
    const cf = upper(m.cf);
    const modello = upper(m.modello);
    if(!cf || !modello){ skip++; return; }
    if(!mustHaveFK(cf)){ fk++; return; }
    const rec = {
      id: (m.id || "").trim() || safeId("D"),
      cf,
      data: toDateISO(m.data) || todayISO(),
      modello,
      imei: upper(m.imei || ""),
      prezzo: (m.prezzo || "").trim(),
      venditore: upper(m.venditore || ""),
      pagamento: upper(m.pagamento || "")
    };
    const idx = device.findIndex(x=>x.id===rec.id);
    if(idx>=0) device[idx]=rec; else device.push(rec);
    ok++;
  });
  return {ok, skip, fk};
}
function importRipFromRows(rows){
  let ok=0, skip=0, fk=0;
  rows.forEach(r=>{
    const m = mapRowSmart(r, SCHEMA_RIP);
    const cf = upper(m.cf);
    const modello = upper(m.modello);
    if(!cf || !modello){ skip++; return; }
    if(!mustHaveFK(cf)){ fk++; return; }
    const rec = {
      id: (m.id || "").trim() || safeId("R"),
      cf,
      data_ingresso: toDateISO(m.data_ingresso) || todayISO(),
      modello,
      imei: upper(m.imei || ""),
      problema: upper(m.problema || ""),
      stato: upper(m.stato || ""),
      costo: (m.costo || "").trim()
    };
    const idx = riparazioni.findIndex(x=>x.id===rec.id);
    if(idx>=0) riparazioni[idx]=rec; else riparazioni.push(rec);
    ok++;
  });
  return {ok, skip, fk};
}

/* =========================
   PDF Export (stampa)
========================= */
function canvasToImgDataUrl(id){
  const c = qs("#"+id);
  if(!c) return "";
  try{ return c.toDataURL("image/png"); }catch(e){ return ""; }
}
function buildTableHTML(headers, rows){
  const th = headers.map(h=>`<th>${h}</th>`).join("");
  const tb = rows.map(r=>{
    const tds = headers.map(h=>`<td>${(r[h]??"")}</td>`).join("");
    return `<tr>${tds}</tr>`;
  }).join("");
  return `<table><thead><tr>${th}</tr></thead><tbody>${tb || `<tr><td colspan="${headers.length}">Nessun dato</td></tr>`}</tbody></table>`;
}

/* =========================
   SMART REPORT: suggerimenti ricontatto
========================= */
let smartRows = [];

function daysBetweenISO(aISO, bISO){
  if(!aISO || !bISO) return null;
  const a = new Date(aISO);
  const b = new Date(bISO);
  if(isNaN(a) || isNaN(b)) return null;
  return Math.floor((b - a) / (1000*60*60*24));
}
function maxDateISO(arr){
  const clean = (arr||[]).filter(Boolean).map(toDateISO).filter(Boolean);
  if(!clean.length) return "";
  clean.sort();
  return clean[clean.length-1];
}
function minDateISO(arr){
  const clean = (arr||[]).filter(Boolean).map(toDateISO).filter(Boolean);
  if(!clean.length) return "";
  clean.sort();
  return clean[0];
}
function sumBy(arr, fn){
  return (arr||[]).reduce((s,x)=>s+(toNum(fn(x))||0),0);
}

function buildSmartSuggestions(){
  const inactiveMin = Math.max(0, parseInt(qs("#smartInactiveDays")?.value || "90",10));
  const nextDays = Math.max(1, parseInt(qs("#smartNextDays")?.value || "30",10));
  const segFilter = upper(qs("#smartSeg")?.value || "");
  const today = todayISO();
  const valSet = loadValueSettings();
  const monthsVal = Math.max(1, parseInt(valSet.months,10));
  const mDev = (Number(valSet.marginDevPct)||0)/100;
  const mRip = (Number(valSet.marginRipPct)||0)/100;

  const byCF = (list, cf) => list.filter(x => upper(x.cf) === cf);

  const rows = [];

  anagrafica.forEach(a=>{
    const cf = upper(a.cf);
    const cons = byCF(contratti, cf);
    const devs = byCF(device, cf);
    const rips = byCF(riparazioni, cf);

    const conDates = cons.map(c=>toDateISO(c.data_contratto || c.data));
    const devDates = devs.map(d=>toDateISO(d.data));
    const ripDates = rips.map(r=>toDateISO(r.data_ingresso));

    const last = maxDateISO([...conDates, ...devDates, ...ripDates]);
    const first = minDateISO([...conDates, ...devDates, ...ripDates]);
    if(!last) return; // nessuna attivit√†

    const daysSince = daysBetweenISO(last, today);
    const tenureDays = first ? (daysBetweenISO(first, today) ?? 0) : 0;

    // spesa stimata
    const spendDev = sumBy(devs, d=>d.prezzo);
    const spendRip = sumBy(rips, r=>r.costo);
    const spend = spendDev + spendRip;
    // valore cliente (stima)
    const mrr = cons.reduce((s,c)=> s + (toNum(c.costo_offerta ?? c.costo ?? 0) || 0), 0);
    const valueContracts = mrr * monthsVal;
    const valueMargins = (spendDev * mDev) + (spendRip * mRip);
    const valueEst = valueContracts + valueMargins;


    // ‚Äúloyalty‚Äù
    const nCon = cons.length, nDev = devs.length, nRip = rips.length;
    const loyalty = (nCon*3) + (nDev*2) + (nRip*1) + (tenureDays>180 ? 2 : 0) + (spend>=500 ? 2 : 0);

    // MNP
    const mnpYes = cons.some(c => upper(c.mnp||"") === "SI");
    const lastCon = maxDateISO(conDates);

    // Scadenze: pi√π vicina tra fine vincolo offerta/telefono
    const scads = [];
    cons.forEach(c=>{
      const d1 = toDateISO(c.data_fine_vincolo_offerta);
      const d2 = toDateISO(c.data_fine_vincolo_telefono);
      if(d1) scads.push({type:"OFFERTA", date:d1});
      if(d2) scads.push({type:"TELEFONO", date:d2});
    });
    const upcoming = scads
      .filter(s => s.date >= today && (daysBetweenISO(today, s.date) ?? 999999) <= nextDays)
      .sort((x,y)=>x.date.localeCompare(y.date))[0];

    // Priorit√†: RINNOVO > WINBACK > VIP > UPSELL
    let segment = "";
    let reason = "";
    let proposal = "";
    let score = 0;
    let msg = "";

    const nome = (a.nome||"").toString().trim() || "Ciao";
    const cliente = `${a.nome||""} ${a.cognome||""}`.trim();
    const phone = a.telefono || "";

    if(upcoming){
      segment = "RINNOVO";
      const gg = daysBetweenISO(today, upcoming.date) ?? 0;
      reason = `Scadenza vincolo ${upcoming.type} tra ${gg} gg (${upcoming.date})`;
      proposal = "Rinnovo / Upgrade con promo riservata";
      score = Math.min(100, 70 + Math.max(0, 30-gg));
      msg = `Ciao ${nome}! Ti scrivo da VOLPEX: vedo una scadenza vicina (${upcoming.date}). Se vuoi, posso riservarti una promo upgrade/rinnovo dedicata. Ti va se ti chiamo 2 minuti?`;
    } else if(daysSince != null && daysSince >= inactiveMin && nCon > 0){
      segment = "WINBACK";
      reason = `Inattivo da ${daysSince} giorni (ultima attivit√† ${last})`;
      proposal = "Offerta rientro / bonus / promo esclusiva";
      score = Math.min(100, 60 + Math.min(30, Math.floor((daysSince-inactiveMin)/3)));
      msg = `Ciao ${nome}! Sono VOLPEX üôÇ √à da un po‚Äô che non attivi con noi: posso farti una promo rientro riservata (anche con bonus). Vuoi che ti mandi 2 opzioni?`;
    } else if(valueEst >= 600 || loyalty >= 10 || nCon >= 3 || spend >= 700){
      segment = "VIP";
      reason = `Cliente affezionato: contratti=${nCon}, device=${nDev}, rip=${nRip}, spesa‚âà${spend.toFixed(0)}‚Ç¨`;
      proposal = "Buono fedelt√† / offerta esclusiva clienti top";
      score = Math.min(100, 75 + Math.min(25, Math.floor(loyalty)));
      msg = `Ciao ${nome}! Grazie per essere un nostro cliente ‚Äútop‚Äù üôå Ti posso riservare un buono fedelt√† o un‚Äôofferta esclusiva. Ti va di vedere cosa conviene di pi√π?`;
    } else {
      segment = "UPSELL";
      if(mnpYes && lastCon){
        reason = `Ha fatto MNP; ultimo contratto ${lastCon}`;
        proposal = "Follow-up: convergenza / upgrade / device a rate";
        score = Math.min(100, 55 + Math.min(30, Math.floor(loyalty)));
        msg = `Ciao ${nome}! Ti scrivo da VOLPEX: ti va una proposta upgrade (es. convergenza/fibra o device) pensata per chi ha gi√† fatto MNP? Posso mandarti 2 soluzioni rapide.`;
      } else {
        reason = `Attivit√† recente ${last} ‚Ä¢ contratti=${nCon}, device=${nDev}, rip=${nRip}`;
        proposal = "Check-up: offerta migliore / accessori / estensione garanzia";
        score = Math.min(100, 50 + Math.min(30, Math.floor(loyalty)));
        msg = `Ciao ${nome}! Ti scrivo da VOLPEX: vuoi che controlliamo se oggi c‚Äô√® un‚Äôofferta migliore per te o un upgrade utile? Ti mando 2 alternative.`;
      }
    }

    // filtro segmento
    if(segFilter && segment !== segFilter) return;

    const wa = waLinkText(phone, msg);

    
    // boost score con valore stimato
    score = Math.min(100, score + Math.min(15, Math.floor(valueEst/200)));
rows.push({
      score,
      segment,
      cf,
      cliente,
      last,
      days: daysSince ?? "",
      reason,
      proposal,
      value_est: valueEst,
      value_contracts: valueContracts,
      value_margins: valueMargins,
      wa,
      phone: phone,
      msg
    });
  });

  rows.sort((a,b)=>b.score-a.score);
  smartRows = rows;

  // counters
  const ren = rows.filter(r=>r.segment==="RINNOVO").length;
  const win = rows.filter(r=>r.segment==="WINBACK").length;
  const vip = rows.filter(r=>r.segment==="VIP").length;
  const up  = rows.filter(r=>r.segment==="UPSELL").length;

  setText("smartTot", rows.length);
  setText("smartRen", ren);
  setText("smartWin", win);
  setText("smartVip", vip);
  setText("smartUp", up);

  const tb = qs("#tblSmart tbody");
  if(!tb) return;
  tb.innerHTML = rows.map(r=>{
    const bcls = r.segment==="RINNOVO" ? "bad" : (r.segment==="WINBACK" ? "warn" : (r.segment==="VIP" ? "good" : ""));
    const waBtn = (r.wa && r.wa!=="#")
      ? `<a class="btn primary small" style="text-decoration:none;display:inline-block" href="${r.wa}" target="_blank" rel="noopener">WhatsApp</a>`
      : `<span class="muted">‚Äî</span>`;
    const viewBtn = `<button class="btn secondary small" onclick="openClientFromCF('${r.cf}')">Scheda</button>`;
    return `
      <tr>
        <td><b>${Math.round(r.score)}</b></td>
        <td><span class="badge ${bcls}">${r.segment}</span></td>
        <td class="mono">${r.cf}</td>
        <td>${r.cliente}</td>
        <td>${r.last}</td>
        <td>${r.days}</td>
        <td>${r.reason}</td>
        <td>${r.proposal}</td>
        <td>${moneyFmt(r.value_est || 0)}</td>
        <td style="white-space:nowrap;display:flex;gap:6px;align-items:center">${waBtn}${viewBtn}</td>
      </tr>`;
  }).join("") || `<tr><td colspan="10" class="muted">Nessun suggerimento con questi filtri.</td></tr>`;

  toast("Suggerimenti ricontatto aggiornati ‚úÖ");
}

function exportSmartCsv(){
  if(!smartRows.length){ toast("Nessun suggerimento da esportare"); return; }
  const headers = ["score","segment","cf","cliente","last","days","reason","proposal","value_est","phone","wa"];
  downloadCSV(`ricontatti_suggeriti_${todayISO()}.csv`, headers, smartRows.map(r=>({
    score:r.score, segment:r.segment, cf:r.cf, cliente:r.cliente, last:r.last, days:r.days, reason:r.reason, proposal:r.proposal, value_est:r.value_est, phone:r.phone, wa:r.wa
  })));
}


/* =========================
   VALUE SETTINGS UI + CAMPAIGNS UI
========================= */
function syncValueSettingsUI(){
  const v = loadValueSettings();
  if(qs("#valMonths")) qs("#valMonths").value = v.months;
  if(qs("#marginDevPct")) qs("#marginDevPct").value = v.marginDevPct;
  if(qs("#marginRipPct")) qs("#marginRipPct").value = v.marginRipPct;
}
function bindValueSettings(){
  qs("#btnSaveValueSettings")?.addEventListener("click", ()=>{
    const v = {
      months: Math.max(1, parseInt(qs("#valMonths")?.value || "12",10)),
      marginDevPct: Math.max(0, Math.min(100, parseFloat(qs("#marginDevPct")?.value || "15"))),
      marginRipPct: Math.max(0, Math.min(100, parseFloat(qs("#marginRipPct")?.value || "40")))
    };
    saveValueSettings(v);
    toast("Impostazioni valore salvate ‚úÖ");
    // rigenera suggerimenti con nuovo scoring
    buildSmartSuggestions();
  });
}

function newCampaignId(){ return "CAMP-" + Math.random().toString(36).slice(2,7).toUpperCase() + "-" + Date.now().toString().slice(-5); }

function renderCampaignSelect(){
  const sel = qs("#campSelect");
  if(!sel) return;
  sel.innerHTML = "";
  if(!campaigns.length){
    const opt = document.createElement("option");
    opt.value = "";
    opt.textContent = "Nessuna campagna";
    sel.appendChild(opt);
    selectedCampaignId = "";
    renderCampaignLeads();
    return;
  }
  campaigns
    .slice()
    .sort((a,b)=>(b.created_at||"").localeCompare(a.created_at||""))
    .forEach(c=>{
      const opt = document.createElement("option");
      opt.value = c.id;
      opt.textContent = `${c.name} ‚Ä¢ ${c.segment||"TUTTI"} ‚Ä¢ ${c.leads?.length||0} lead`;
      sel.appendChild(opt);
    });
  if(!selectedCampaignId || !campaigns.some(c=>c.id===selectedCampaignId)){
    selectedCampaignId = campaigns[0].id;
  }
  sel.value = selectedCampaignId;
  renderCampaignLeads();
}

function renderCampaignLeads(){
  const tb = qs("#tblCampaignLeads tbody");
  if(!tb) return;
  const camp = campaigns.find(c=>c.id===selectedCampaignId);
  if(!camp){
    tb.innerHTML = `<tr><td colspan="10" class="muted">Seleziona o crea una campagna.</td></tr>`;
    return;
  }
  const leads = (camp.leads||[]).slice().sort((a,b)=>(b.score||0)-(a.score||0));
  tb.innerHTML = leads.map(l=>{
    const status = l.status || "DA_CONTATTARE";
    const outcome = l.outcome || "";
    const fu = l.followup || "";
    const last = l.last_contact || "";
    const wa = l.wa || "#";
    const waBtn = (wa && wa!=="#")
      ? `<a class="btn primary small" style="text-decoration:none;display:inline-block" href="${wa}" target="_blank" rel="noopener">WhatsApp</a>`
      : `<span class="muted">‚Äî</span>`;
    const viewBtn = `<button class="btn secondary small" onclick="openClientFromCF('${l.cf}')">Scheda</button>`;
    const markBtn = `<button class="btn secondary small" data-act="mark" data-cf="${l.cf}">Contattato</button>`;
    return `
      <tr>
        <td><b>${Math.round(l.score||0)}</b></td>
        <td><span class="badge">${l.segment||""}</span></td>
        <td class="mono">${l.cf}</td>
        <td>${l.cliente||""}</td>
        <td>${moneyFmt(l.value_est||0)}</td>
        <td>
          <select data-act="status" data-cf="${l.cf}">
            ${["DA_CONTATTARE","CONTATTATO","CHIUSO"].map(s=>`<option ${s===status?"selected":""}>${s}</option>`).join("")}
          </select>
        </td>
        <td>
          <select data-act="outcome" data-cf="${l.cf}">
            ${["","NON_RISPONDE","INTERESSATO","RIFIUTA","APPUNTAMENTO","RINNOVATO"].map(s=>`<option value="${s}" ${s===outcome?"selected":""}>${s||"‚Äî"}</option>`).join("")}
          </select>
        </td>
        <td><input data-act="followup" data-cf="${l.cf}" type="date" value="${fu}"/></td>
        <td class="mono">${last}</td>
        <td style="white-space:nowrap;display:flex;gap:6px;align-items:center">${waBtn}${markBtn}${viewBtn}</td>
      </tr>`;
  }).join("") || `<tr><td colspan="10" class="muted">Campagna vuota.</td></tr>`;
}

function bindCampaignUI(){
  qs("#btnCreateCampaign")?.addEventListener("click", ()=>{
    if(!smartRows || !smartRows.length){ toast("Prima genera i ricontatti suggeriti"); return; }
    const name = (qs("#campName")?.value || "").trim() || ("Campagna " + new Date().toLocaleDateString("it-IT"));
    const seg = upper(qs("#campSeg")?.value || "");
    const leads = smartRows
      .filter(r=> !seg ? true : r.segment===seg)
      .slice(0, 300)
      .map(r=>({
        cf: r.cf,
        cliente: r.cliente,
        segment: r.segment,
        score: r.score,
        value_est: r.value_est || 0,
        reason: r.reason,
        proposal: r.proposal,
        wa: r.wa,
        phone: r.phone || "",
        msg: r.msg || "",
        status: "DA_CONTATTARE",
        outcome: "",
        followup: "",
        last_contact: ""
      }));
    const camp = {
      id: newCampaignId(),
      name,
      segment: seg || "TUTTI",
      created_at: new Date().toISOString(),
      leads
    };
    campaigns.unshift(camp);
    saveCampaigns(campaigns);
    selectedCampaignId = camp.id;
    qs("#campName").value = "";
    toast("Campagna creata ‚úÖ");
    renderCampaignSelect();
  });

  qs("#campSelect")?.addEventListener("change", (e)=>{
    selectedCampaignId = e.target.value || "";
    renderCampaignLeads();
  });

  qs("#btnDeleteCampaign")?.addEventListener("click", ()=>{
    if(!selectedCampaignId){ toast("Nessuna campagna selezionata"); return; }
    campaigns = campaigns.filter(c=>c.id!==selectedCampaignId);
    saveCampaigns(campaigns);
    selectedCampaignId = "";
    toast("Campagna eliminata");
    renderCampaignSelect();
  });

  qs("#btnExportCampaignCsv")?.addEventListener("click", ()=>{
    const camp = campaigns.find(c=>c.id===selectedCampaignId);
    if(!camp){ toast("Nessuna campagna selezionata"); return; }
    const headers = ["cf","cliente","segment","score","value_est","status","outcome","followup","last_contact","reason","proposal","phone","wa"];
    downloadCSV(`campagna_${camp.name.replace(/\s+/g,"_")}_${todayISO()}.csv`, headers, (camp.leads||[]).map(l=>({
      cf:l.cf, cliente:l.cliente, segment:l.segment, score:l.score, value_est:l.value_est,
      status:l.status, outcome:l.outcome, followup:l.followup, last_contact:l.last_contact,
      reason:l.reason, proposal:l.proposal, phone:l.phone, wa:l.wa
    })));
    toast("Export campagna avviato ‚úÖ");
  });

  // Delegation: status/outcome/followup/mark
  qs("#tblCampaignLeads")?.addEventListener("change", (e)=>{
    const act = e.target?.dataset?.act;
    const cf = upper(e.target?.dataset?.cf || "");
    if(!act || !cf) return;
    const camp = campaigns.find(c=>c.id===selectedCampaignId);
    if(!camp) return;
    const lead = (camp.leads||[]).find(l=>upper(l.cf)===cf);
    if(!lead) return;

    if(act==="status") lead.status = e.target.value;
    if(act==="outcome") lead.outcome = e.target.value;
    if(act==="followup") lead.followup = e.target.value || "";

    saveCampaigns(campaigns);
  });

  qs("#tblCampaignLeads")?.addEventListener("click", (e)=>{
    const btn = e.target?.closest("button");
    if(!btn) return;
    if(btn.dataset.act !== "mark") return;
    const cf = upper(btn.dataset.cf || "");
    const camp = campaigns.find(c=>c.id===selectedCampaignId);
    const lead = camp?.leads?.find(l=>upper(l.cf)===cf);
    if(!lead) return;

    lead.status = "CONTATTATO";
    lead.last_contact = new Date().toLocaleString("it-IT");
    // followup default: +3 giorni se vuoto
    if(!lead.followup){
      const d = new Date(); d.setDate(d.getDate()+3);
      lead.followup = d.toISOString().slice(0,10);
    }
    saveCampaigns(campaigns);
    renderCampaignLeads();
    toast("Segnato come contattato ‚úÖ");
  });
}


function openClientFromCF(cf){
  try{
    if(typeof openClientSheet === "function"){
      qs("#clientSearchCF").value = cf;
      openClientSheet();
      return;
    }
  }catch(e){}
  const btn = document.querySelector('[data-view="anagrafica"]');
  if(btn) btn.click();
  const s = qs("#searchAnag");
  if(s){ s.value = cf; renderAnag(); }
}

function exportPDFReport(){
  const repImg = canvasToImgDataUrl("chartReportTypes");
  const dailyImg = canvasToImgDataUrl("chartDaily");
  const sellersImg = canvasToImgDataUrl("chartSellers");
  const compImg = canvasToImgDataUrl("chartCompanies");

  const rows = reportRows.map(r=>({
    Tipo:r.tipo, Data:r.date, CF:r.cf, Cliente:r.cliente, Contatto:r.contatto, Citt√†:r.citta, Descrizione:r.descr, Extra:r.extra
  }));
  const htmlTable = buildTableHTML(["Tipo","Data","CF","Cliente","Contatto","Citt√†","Descrizione","Extra"], rows);

  const w = window.open("", "_blank");
  if(!w){ toast("Popup bloccato: abilita popup per export PDF"); return; }

  w.document.open();
  w.document.write(`
    <!doctype html><html><head><meta charset="utf-8"/>
    <title>VOLPEX ‚Äì Report PDF</title>
    <style>

    :root{
      --bg:#f5f7fb;
      --panel:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:#e6e9f0;

      --primary:#2563eb;
      --primary-2:#1d4ed8;
      --primary-soft:#eff6ff;

      --good:#16a34a;
      --warn:#f59e0b;
      --bad:#dc2626;

      --shadow: 0 10px 25px rgba(15, 23, 42, .06);
      --shadow-sm: 0 6px 16px rgba(15, 23, 42, .05);

      --radius:16px;
      --radius-sm:12px;
      --ring: 0 0 0 4px rgba(37, 99, 235, .12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    a{color:inherit}

    /* Layout */
    .app{display:flex;min-height:100vh}
    .sidebar{
      width:290px;
      background:linear-gradient(180deg,#0b1220 0%, #0b1220 55%, #0d172a 100%);
      color:#e5e7eb;
      padding:16px;
      position:sticky;top:0;height:100vh;overflow:auto;
      border-right:1px solid rgba(255,255,255,.06);
    }
    .main{flex:1;display:flex;flex-direction:column;min-width:0}

    .content{
      max-width:1320px;
      margin:0 auto;
      width:100%;
      padding:0 18px;
    }

    /* Sidebar header */
    .logo{
      font-weight:950;
      font-size:16px;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logoMark{
      width:34px;height:34px;border-radius:12px;
      display:grid;place-items:center;
      background:rgba(37,99,235,.18);
      border:1px solid rgba(37,99,235,.35);
      box-shadow: 0 8px 18px rgba(0,0,0,.22);
      font-weight:950;
      color:#bfdbfe;
    }
    .sub{color:rgba(229,231,235,.7);font-size:12px;margin:8px 0 12px}
    .pill{
      display:inline-flex;gap:6px;align-items:center;
      font-size:11px;border:1px solid rgba(191,219,254,.35);
      background:rgba(37,99,235,.12);
      color:#bfdbfe;padding:3px 10px;border-radius:999px;font-weight:900;
      margin-left:auto;
    }

    /* Sidebar nav */
    .nav{margin-top:12px;display:flex;flex-direction:column;gap:6px}
    .nav button{
      width:100%;
      padding:10px 12px;
      border:none;
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.06);
      border-radius:12px;
      text-align:left;
      cursor:pointer;
      color:rgba(229,231,235,.85);
      display:flex;
      gap:10px;
      align-items:center;
      transition: .15s ease;
    }
    .nav button:hover{
      transform: translateY(-1px);
      background:rgba(255,255,255,.06);
      border-color: rgba(191,219,254,.25);
    }
    .nav button.active{
      background:rgba(37,99,235,.14);
      border-color: rgba(191,219,254,.35);
      color:#bfdbfe;
      box-shadow: 0 8px 18px rgba(0,0,0,.18);
      position:relative;
    }
    .nav button.active::before{
      content:"";
      position:absolute;
      left:-16px;
      top:10px;
      bottom:10px;
      width:3px;
      border-radius:999px;
      background:#60a5fa;
    }

    .sideCard{
      margin-top:14px;
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      padding:12px;
      background:rgba(255,255,255,.03);
      backdrop-filter: blur(8px);
    }
    .kv{display:flex;justify-content:space-between;gap:10px;font-size:12px;color:rgba(229,231,235,.75);margin-top:8px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}

    /* Topbar */
    .topbar{
      position:sticky;
      top:0;
      z-index:10;
      background:rgba(245,247,251,.85);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--border);
      padding:14px 0;
    }
    .topbarInner{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }
    #pageTitle{margin:0;font-size:16px;letter-spacing:-.2px}
    .right{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

    /* Views */
    .view{display:none;padding:18px 0}
    .view.active{display:block}

    /* Cards */
    .grid{display:grid;gap:14px}
    .grid-2{grid-template-columns:repeat(auto-fit,minmax(420px,1fr))}
    .grid-3{grid-template-columns:repeat(auto-fit,minmax(360px,1fr))}
    .grid-4{grid-template-columns:repeat(auto-fit,minmax(230px,1fr))}

    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:14px;
      box-shadow: var(--shadow-sm);
    }
    .card h3{margin:0 0 8px 0;font-size:14px}
    .muted{color:var(--muted);font-size:12px}
    .smallNote{font-size:11px;color:var(--muted)}
    .hr{height:1px;background:var(--border);margin:12px 0}

    /* KPI */
    .kpi-label{font-size:12px;color:var(--muted)}
    .kpi-value{font-size:30px;font-weight:950;letter-spacing:-.7px;line-height:1.05}
    .kpi-sub{font-size:12px;color:var(--muted);margin-top:2px}

    /* Inputs */
    input,select,textarea{
      width:100%;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
      color:var(--text);
      outline:none;
      transition:.12s ease;
    }
    input:focus,select:focus,textarea:focus{
      border-color: rgba(37,99,235,.55);
      box-shadow: var(--ring);
    }
    textarea{min-height:88px;resize:vertical}

    /* Buttons */
    .btn{
      border:none;
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      cursor:pointer;
      transition: .12s ease;
      box-shadow:none;
    }
    .btn.primary{background:var(--primary);color:#fff}
    .btn.primary:hover{background:var(--primary-2);transform:translateY(-1px)}
    .btn.secondary{
      background:#fff;
      color:var(--text);
      border:1px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    .btn.secondary:hover{transform:translateY(-1px)}
    .btn.danger{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}
    .btn.danger:hover{transform:translateY(-1px)}
    .btn.small{padding:8px 12px;font-size:12px}

    /* Toolbar */
    .toolbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between
    }
    .toolbar .left,.toolbar .right{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    /* Tables */
    table{width:100%;border-collapse:separate;border-spacing:0;font-size:12.5px}
    th,td{padding:10px 10px;border-bottom:1px solid var(--border);vertical-align:top}
    th{
      color:var(--muted);
      text-align:left;
      font-weight:900;
      font-size:12px;
      white-space:nowrap;
      position:sticky;
      top:0;
      background:#fff;
      z-index:2;
    }
    tbody tr:hover{background:#f7f9ff}
    tbody tr:nth-child(even){background:rgba(241,245,249,.35)}
    .tableWrap{
      overflow:auto;
      border:1px solid var(--border);
      border-radius: var(--radius);
    }
    .tableWrap table{border-radius: var(--radius);}

    /* Badges */
    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:11px;
      padding:3px 10px;
      border-radius:999px;
      background:var(--primary-soft);
      color:#1d4ed8;
      font-weight:900;
      border:1px solid #c7d2fe
    }
    .badge.good{background:#dcfce7;color:#166534;border-color:#bbf7d0}
    .badge.warn{background:#fef9c3;color:#854d0e;border-color:#fde68a}
    .badge.bad{background:#fee2e2;color:#991b1b;border-color:#fecaca}

    /* Timeline */
    .timeline{border-left:3px solid var(--border);padding-left:14px}
    .tItem{margin:12px 0}
    .tTitle{font-weight:950}
    .tMeta{color:var(--muted);font-size:12px;margin-top:3px}

    /* Charts */
    canvas{width:100%;height:260px;border:1px solid var(--border);border-radius:14px;background:#fff}

    /* Toast */
    .toast{
      position:fixed;right:16px;bottom:16px;z-index:50;
      background:#0f172a;color:#fff;padding:10px 12px;border-radius:12px;
      box-shadow:0 10px 24px rgba(0,0,0,.15);max-width:520px;display:none
    }
    .toast.show{display:block}

    /* Print */
    @media print{
      .sidebar,.topbar,.btn,.toolbar input[type="file"]{display:none!important}
      .view{display:block!important}
      body{background:#fff}
      .card{box-shadow:none;border:1px solid #ddd}
      th{position:static}
      canvas{height:220px}
    }

    /* Responsive */
    @media (max-width: 980px){
      .sidebar{position:fixed;left:-320px;top:0;bottom:0;z-index:40;transition:.2s ease}
      .sidebar.open{left:0}
      .grid-2{grid-template-columns:1fr}
      .grid-3{grid-template-columns:1fr}
      .content{padding:0 14px}
    }

  </style></head><body>
      <div class="noprint" style="display:flex;gap:10px;justify-content:flex-end;margin-bottom:10px">
        <button onclick="window.print()" style="padding:10px 12px;border-radius:999px;border:none;background:#2563eb;color:white;font-weight:800;cursor:pointer">Stampa / Salva PDF</button>
        <button onclick="window.close()" style="padding:10px 12px;border-radius:999px;border:1px solid #e5e7eb;background:white;font-weight:800;cursor:pointer">Chiudi</button>
      </div>
      <h1>VOLPEX ‚Äì Report</h1>
      <div class="muted">Generato: ${new Date().toLocaleString("it-IT")} ‚Ä¢ Righe: ${reportRows.length}</div>
      <div class="grid">
        <div class="card"><div class="muted">Grafico report (per tipo)</div>${repImg?`<img src="${repImg}"/>`:"<div class='muted'>‚Äî</div>"}</div>
        <div class="card"><div class="muted">Attivit√† giornaliera (30gg)</div>${dailyImg?`<img src="${dailyImg}"/>`:"<div class='muted'>‚Äî</div>"}</div>
        <div class="card"><div class="muted">Top venditori (30gg)</div>${sellersImg?`<img src="${sellersImg}"/>`:"<div class='muted'>‚Äî</div>"}</div>
        <div class="card"><div class="muted">Contratti per compagnia (30gg)</div>${compImg?`<img src="${compImg}"/>`:"<div class='muted'>‚Äî</div>"}</div>
      </div>
      <div class="card" style="margin-top:14px">
        <div class="muted">Tabella risultati</div>
        ${htmlTable}
      </div>
    </body></html>
  `);
  w.document.close();
  toast("PDF pronto ‚úÖ");
}
function exportPDFFull(){
  const dailyImg = canvasToImgDataUrl("chartDaily");
  const sellersImg = canvasToImgDataUrl("chartSellers");
  const compImg = canvasToImgDataUrl("chartCompanies");
  const { con30, dev30, rip30 } = compute30();

  const conRows = con30.map(x=>({Data:x.date, ID:x.id||"", CF:x.cf, Cliente:x.cliente, Compagnia:x.compagnia, Offerta:x.offerta, Tecnologia:x.tecnologia, MNP:x.mnp}));
  const devRows = dev30.map(x=>({Data:x.date, ID:x.id, CF:x.cf, Cliente:x.cliente, Modello:x.modello, IMEI:x.imei, Prezzo: (x.prezzo!=null?moneyFmt(x.prezzo):""), Venditore:x.venditore}));
  const ripRows = rip30.map(x=>({Ingresso:x.date, ID:x.id, CF:x.cf, Cliente:x.cliente, Modello:x.modello, Problema:x.problema, Stato:x.stato, Costo:(x.costo!=null?moneyFmt(x.costo):"")}));

  const w = window.open("", "_blank");
  if(!w){ toast("Popup bloccato: abilita popup per export PDF"); return; }

  w.document.open();
  w.document.write(`
    <!doctype html><html><head><meta charset="utf-8"/>
    <title>VOLPEX ‚Äì Dashboard PDF</title>
    <style>

    :root{
      --bg:#f5f7fb;
      --panel:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:#e6e9f0;

      --primary:#2563eb;
      --primary-2:#1d4ed8;
      --primary-soft:#eff6ff;

      --good:#16a34a;
      --warn:#f59e0b;
      --bad:#dc2626;

      --shadow: 0 10px 25px rgba(15, 23, 42, .06);
      --shadow-sm: 0 6px 16px rgba(15, 23, 42, .05);

      --radius:16px;
      --radius-sm:12px;
      --ring: 0 0 0 4px rgba(37, 99, 235, .12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    a{color:inherit}

    /* Layout */
    .app{display:flex;min-height:100vh}
    .sidebar{
      width:290px;
      background:linear-gradient(180deg,#0b1220 0%, #0b1220 55%, #0d172a 100%);
      color:#e5e7eb;
      padding:16px;
      position:sticky;top:0;height:100vh;overflow:auto;
      border-right:1px solid rgba(255,255,255,.06);
    }
    .main{flex:1;display:flex;flex-direction:column;min-width:0}

    .content{
      max-width:1320px;
      margin:0 auto;
      width:100%;
      padding:0 18px;
    }

    /* Sidebar header */
    .logo{
      font-weight:950;
      font-size:16px;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logoMark{
      width:34px;height:34px;border-radius:12px;
      display:grid;place-items:center;
      background:rgba(37,99,235,.18);
      border:1px solid rgba(37,99,235,.35);
      box-shadow: 0 8px 18px rgba(0,0,0,.22);
      font-weight:950;
      color:#bfdbfe;
    }
    .sub{color:rgba(229,231,235,.7);font-size:12px;margin:8px 0 12px}
    .pill{
      display:inline-flex;gap:6px;align-items:center;
      font-size:11px;border:1px solid rgba(191,219,254,.35);
      background:rgba(37,99,235,.12);
      color:#bfdbfe;padding:3px 10px;border-radius:999px;font-weight:900;
      margin-left:auto;
    }

    /* Sidebar nav */
    .nav{margin-top:12px;display:flex;flex-direction:column;gap:6px}
    .nav button{
      width:100%;
      padding:10px 12px;
      border:none;
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.06);
      border-radius:12px;
      text-align:left;
      cursor:pointer;
      color:rgba(229,231,235,.85);
      display:flex;
      gap:10px;
      align-items:center;
      transition: .15s ease;
    }
    .nav button:hover{
      transform: translateY(-1px);
      background:rgba(255,255,255,.06);
      border-color: rgba(191,219,254,.25);
    }
    .nav button.active{
      background:rgba(37,99,235,.14);
      border-color: rgba(191,219,254,.35);
      color:#bfdbfe;
      box-shadow: 0 8px 18px rgba(0,0,0,.18);
      position:relative;
    }
    .nav button.active::before{
      content:"";
      position:absolute;
      left:-16px;
      top:10px;
      bottom:10px;
      width:3px;
      border-radius:999px;
      background:#60a5fa;
    }

    .sideCard{
      margin-top:14px;
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      padding:12px;
      background:rgba(255,255,255,.03);
      backdrop-filter: blur(8px);
    }
    .kv{display:flex;justify-content:space-between;gap:10px;font-size:12px;color:rgba(229,231,235,.75);margin-top:8px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}

    /* Topbar */
    .topbar{
      position:sticky;
      top:0;
      z-index:10;
      background:rgba(245,247,251,.85);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--border);
      padding:14px 0;
    }
    .topbarInner{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }
    #pageTitle{margin:0;font-size:16px;letter-spacing:-.2px}
    .right{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

    /* Views */
    .view{display:none;padding:18px 0}
    .view.active{display:block}

    /* Cards */
    .grid{display:grid;gap:14px}
    .grid-2{grid-template-columns:repeat(auto-fit,minmax(420px,1fr))}
    .grid-3{grid-template-columns:repeat(auto-fit,minmax(360px,1fr))}
    .grid-4{grid-template-columns:repeat(auto-fit,minmax(230px,1fr))}

    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:14px;
      box-shadow: var(--shadow-sm);
    }
    .card h3{margin:0 0 8px 0;font-size:14px}
    .muted{color:var(--muted);font-size:12px}
    .smallNote{font-size:11px;color:var(--muted)}
    .hr{height:1px;background:var(--border);margin:12px 0}

    /* KPI */
    .kpi-label{font-size:12px;color:var(--muted)}
    .kpi-value{font-size:30px;font-weight:950;letter-spacing:-.7px;line-height:1.05}
    .kpi-sub{font-size:12px;color:var(--muted);margin-top:2px}

    /* Inputs */
    input,select,textarea{
      width:100%;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
      color:var(--text);
      outline:none;
      transition:.12s ease;
    }
    input:focus,select:focus,textarea:focus{
      border-color: rgba(37,99,235,.55);
      box-shadow: var(--ring);
    }
    textarea{min-height:88px;resize:vertical}

    /* Buttons */
    .btn{
      border:none;
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      cursor:pointer;
      transition: .12s ease;
      box-shadow:none;
    }
    .btn.primary{background:var(--primary);color:#fff}
    .btn.primary:hover{background:var(--primary-2);transform:translateY(-1px)}
    .btn.secondary{
      background:#fff;
      color:var(--text);
      border:1px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    .btn.secondary:hover{transform:translateY(-1px)}
    .btn.danger{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}
    .btn.danger:hover{transform:translateY(-1px)}
    .btn.small{padding:8px 12px;font-size:12px}

    /* Toolbar */
    .toolbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between
    }
    .toolbar .left,.toolbar .right{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    /* Tables */
    table{width:100%;border-collapse:separate;border-spacing:0;font-size:12.5px}
    th,td{padding:10px 10px;border-bottom:1px solid var(--border);vertical-align:top}
    th{
      color:var(--muted);
      text-align:left;
      font-weight:900;
      font-size:12px;
      white-space:nowrap;
      position:sticky;
      top:0;
      background:#fff;
      z-index:2;
    }
    tbody tr:hover{background:#f7f9ff}
    tbody tr:nth-child(even){background:rgba(241,245,249,.35)}
    .tableWrap{
      overflow:auto;
      border:1px solid var(--border);
      border-radius: var(--radius);
    }
    .tableWrap table{border-radius: var(--radius);}

    /* Badges */
    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:11px;
      padding:3px 10px;
      border-radius:999px;
      background:var(--primary-soft);
      color:#1d4ed8;
      font-weight:900;
      border:1px solid #c7d2fe
    }
    .badge.good{background:#dcfce7;color:#166534;border-color:#bbf7d0}
    .badge.warn{background:#fef9c3;color:#854d0e;border-color:#fde68a}
    .badge.bad{background:#fee2e2;color:#991b1b;border-color:#fecaca}

    /* Timeline */
    .timeline{border-left:3px solid var(--border);padding-left:14px}
    .tItem{margin:12px 0}
    .tTitle{font-weight:950}
    .tMeta{color:var(--muted);font-size:12px;margin-top:3px}

    /* Charts */
    canvas{width:100%;height:260px;border:1px solid var(--border);border-radius:14px;background:#fff}

    /* Toast */
    .toast{
      position:fixed;right:16px;bottom:16px;z-index:50;
      background:#0f172a;color:#fff;padding:10px 12px;border-radius:12px;
      box-shadow:0 10px 24px rgba(0,0,0,.15);max-width:520px;display:none
    }
    .toast.show{display:block}

    /* Print */
    @media print{
      .sidebar,.topbar,.btn,.toolbar input[type="file"]{display:none!important}
      .view{display:block!important}
      body{background:#fff}
      .card{box-shadow:none;border:1px solid #ddd}
      th{position:static}
      canvas{height:220px}
    }

    /* Responsive */
    @media (max-width: 980px){
      .sidebar{position:fixed;left:-320px;top:0;bottom:0;z-index:40;transition:.2s ease}
      .sidebar.open{left:0}
      .grid-2{grid-template-columns:1fr}
      .grid-3{grid-template-columns:1fr}
      .content{padding:0 14px}
    }

  </style></head><body>
      <div class="noprint" style="display:flex;gap:10px;justify-content:flex-end;margin-bottom:10px">
        <button onclick="window.print()" style="padding:10px 12px;border-radius:999px;border:none;background:#2563eb;color:white;font-weight:800;cursor:pointer">Stampa / Salva PDF</button>
        <button onclick="window.close()" style="padding:10px 12px;border-radius:999px;border:1px solid #e5e7eb;background:white;font-weight:800;cursor:pointer">Chiudi</button>
      </div>
      <h1>VOLPEX ‚Äì Dashboard</h1>
      <div class="muted">Generato: ${new Date().toLocaleString("it-IT")}</div>

      <div class="grid">
        <div class="card"><div class="muted">Attivit√† giornaliera (30gg)</div>${dailyImg?`<img src="${dailyImg}"/>`:""}</div>
        <div class="card"><div class="muted">Top venditori (30gg)</div>${sellersImg?`<img src="${sellersImg}"/>`:""}</div>
        <div class="card"><div class="muted">Contratti per compagnia (30gg)</div>${compImg?`<img src="${compImg}"/>`:""}</div>
        <div class="card">
          <div class="muted">KPI</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px">
            <div><b>Contratti 30gg</b><div>${con30.length}</div></div>
            <div><b>Device 30gg</b><div>${dev30.length}</div></div>
            <div><b>Riparazioni 30gg</b><div>${rip30.length}</div></div>
            <div><b>Clienti</b><div>${anagrafica.length}</div></div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:14px">
        <div class="muted">Contratti ultimi 30gg</div>
        ${buildTableHTML(["Data","ID","CF","Cliente","Compagnia","Offerta","Tecnologia","MNP"], conRows)}
      </div>
      <div class="card" style="margin-top:14px">
        <div class="muted">Device ultimi 30gg</div>
        ${buildTableHTML(["Data","ID","CF","Cliente","Modello","IMEI","Prezzo","Venditore"], devRows)}
      </div>
      <div class="card" style="margin-top:14px">
        <div class="muted">Riparazioni ultimi 30gg</div>
        ${buildTableHTML(["Ingresso","ID","CF","Cliente","Modello","Problema","Stato","Costo"], ripRows)}
      </div>
    </body></html>
  `);
  w.document.close();
  toast("PDF Dashboard pronto ‚úÖ");
}

/* =========================
   IMPORT buttons wiring
========================= */
document.getElementById("btnImportAnag").addEventListener("click", async ()=>{
  try{
    const txt = await readFileText(document.getElementById("fileAnag"));
    const {rows} = parseCSV(txt);
    const res = importAnagFromRows(rows);
    saveStore(); refreshAll();
    toast(`Import Anagrafica: OK=${res.ok} ‚Ä¢ Skip=${res.skip}`);
  }catch(e){ toast("Errore import: " + e.message); }
});
document.getElementById("btnImportCon").addEventListener("click", async ()=>{
  try{
    const txt = await readFileText(document.getElementById("fileCon"));
    const {rows} = parseCSV(txt);
    const res = importConFromRows(rows);
    saveStore(); refreshAll();
    toast(`Import Contratti: OK=${res.ok} ‚Ä¢ Skip=${res.skip} ‚Ä¢ FK fail=${res.fk}`);
  }catch(e){ toast("Errore import: " + e.message); }
});
document.getElementById("btnImportDev").addEventListener("click", async ()=>{
  try{
    const txt = await readFileText(document.getElementById("fileDev"));
    const {rows} = parseCSV(txt);
    const res = importDevFromRows(rows);
    saveStore(); refreshAll();
    toast(`Import Device: OK=${res.ok} ‚Ä¢ Skip=${res.skip} ‚Ä¢ FK fail=${res.fk}`);
  }catch(e){ toast("Errore import: " + e.message); }
});
document.getElementById("btnImportRip").addEventListener("click", async ()=>{
  try{
    const txt = await readFileText(document.getElementById("fileRip"));
    const {rows} = parseCSV(txt);
    const res = importRipFromRows(rows);
    saveStore(); refreshAll();
    toast(`Import Riparazioni: OK=${res.ok} ‚Ä¢ Skip=${res.skip} ‚Ä¢ FK fail=${res.fk}`);
  }catch(e){ toast("Errore import: " + e.message); }
});

/* =========================
   Templates (CSV)
========================= */
document.getElementById("btnTplAnag").addEventListener("click", ()=>{
  downloadCSV("template_anagrafica.csv",
    ["Codice fiscale","Nome","Cognome","Tipo cliente","Telefono","Email","Citt√†","Indirizzo"],
    [{"Codice fiscale":"RSSMRA80X01H501Z","Nome":"Mario","Cognome":"Rossi","Tipo cliente":"PRIVATO","Telefono":"+39 333...","Email":"mario@email.it","Citt√†":"Roma","Indirizzo":"Via Roma 1"}]
  );
});
document.getElementById("btnTplCon").addEventListener("click", ()=>{
  downloadCSV("template_contratti.csv",
    ["ID contratto","ID cliente","Codice fiscale","Data contratto","Tipo cliente","Tipo attivazione","Tecnologia","Convergenza","MNP","Data attivazione","Data portabilit√†","Numero lavorato","Nome offerta","Costo offerta","Vincolo offerta (mesi)","Telefono incluso","IMEI","Modello","Tipo pagamento","Mesi vincolo telefono","Data fine vincolo offerta","Data fine vincolo telefono","Compagnia","ICCID_vecchio","ICCID_nuovo","created_at","updated_at"],
    [{
      "ID contratto":"C-0001","ID cliente":"C001","Codice fiscale":"RSSMRA80X01H501Z","Data contratto":todayISO(),
      "Tipo cliente":"PRIVATO","Tipo attivazione":"MNP","Tecnologia":"SIM","Convergenza":"NO","MNP":"SI",
      "Data attivazione":todayISO(),"Data portabilit√†":"","Numero lavorato":"333123456","Nome offerta":"OFFERTA X","Costo offerta":"9.99",
      "Vincolo offerta (mesi)":"24","Telefono incluso":"SI","IMEI":"123456789012345","Modello":"IPHONE 13","Tipo pagamento":"CARTA",
      "Mesi vincolo telefono":"24","Data fine vincolo offerta":"","Data fine vincolo telefono":"","Compagnia":"VODAFONE","ICCID_vecchio":"","ICCID_nuovo":"",
      "created_at":"","updated_at":""
    }]
  );
});
document.getElementById("btnTplDev").addEventListener("click", ()=>{
  downloadCSV("template_device.csv",
    ["ID","Codice fiscale","Data vendita","Modello","IMEI","Prezzo","Venditore","Tipo pagamento"],
    [{"ID":"D-1001","Codice fiscale":"RSSMRA80X01H501Z","Data vendita":todayISO(),"Modello":"IPHONE 13","IMEI":"123456789012345","Prezzo":"699","Venditore":"AUGUSTO","Tipo pagamento":"CARTA"}]
  );
});
document.getElementById("btnTplRip").addEventListener("click", ()=>{
  downloadCSV("template_riparazioni.csv",
    ["ID","Codice fiscale","Data ingresso","Modello","IMEI","Problema","Stato riparazione","Costo"],
    [{"ID":"R-9001","Codice fiscale":"RSSMRA80X01H501Z","Data ingresso":todayISO(),"Modello":"IPHONE 13","IMEI":"123456789012345","Problema":"BATTERIA","Stato riparazione":"APERTA","Costo":"49"}]
  );
});

/* =========================
   EXPORT buttons wiring
========================= */
document.getElementById("btnExportAll").addEventListener("click", ()=>{ exportAnag(); exportCon(); exportDev(); exportRip(); toast("Export avviato (CSV multipli) ‚úÖ"); });
document.getElementById("btnExportAnagAll").addEventListener("click", exportAnag);
document.getElementById("btnExportConAll").addEventListener("click", exportCon);
document.getElementById("btnExportDevAll").addEventListener("click", exportDev);
document.getElementById("btnExportRipAll").addEventListener("click", exportRip);
document.getElementById("btnExportFullPdf").addEventListener("click", exportPDFFull);

document.getElementById("btnExportAnagCsv").addEventListener("click", exportAnag);

// Scheda cliente
document.getElementById("btnClientLoad").addEventListener("click", ()=>openClientSheet());
document.getElementById("btnClientGoTimeline").addEventListener("click", ()=>{
  if(!currentClientCF){ toast("Seleziona un cliente"); return; }
  openTimeline(currentClientCF);
});
document.getElementById("btnCS_SaveCon").addEventListener("click", csSaveCon);
document.getElementById("btnCS_SaveDev").addEventListener("click", csSaveDev);
document.getElementById("btnCS_SaveRip").addEventListener("click", csSaveRip);
document.getElementById("btnCS_OpenCon").addEventListener("click", ()=>csOpenFull("contratti"));
document.getElementById("btnCS_OpenDev").addEventListener("click", ()=>csOpenFull("device"));
document.getElementById("btnCS_OpenRip").addEventListener("click", ()=>csOpenFull("riparazioni"));
qs("#cs_search_cf").addEventListener("keydown",(e)=>{ if(e.key==="Enter"){ e.preventDefault(); openClientSheet(); }});

document.getElementById("btnExportConCsv").addEventListener("click", exportCon);
document.getElementById("btnExportDevCsv").addEventListener("click", exportDev);
document.getElementById("btnExportRipCsv").addEventListener("click", exportRip);

document.getElementById("btnExportReportCsv").addEventListener("click", ()=>{
  if(!reportRows.length){ toast("Nessun report da esportare"); return; }
  exportReport();
});
document.getElementById("btnExportReportPdf").addEventListener("click", ()=>{
  if(!reportRows.length){ toast("Prima genera il report (Applica filtri)"); return; }
  exportPDFReport();
});


document.getElementById("btnRunSmart")?.addEventListener("click", buildSmartSuggestions);
document.getElementById("btnExportSmartCsv")?.addEventListener("click", exportSmartCsv);


/* =========================
   Search filters
========================= */
document.getElementById("searchAnag").addEventListener("input", renderAnag);
document.getElementById("searchCon").addEventListener("input", renderCon);
document.getElementById("searchDev").addEventListener("input", renderDev);
document.getElementById("searchRip").addEventListener("input", renderRip);

/* =========================
   Buttons CRUD
========================= */
document.getElementById("btnSaveAnag").addEventListener("click", saveAnag);
document.getElementById("btnClearAnag").addEventListener("click", clearAnagForm);

document.getElementById("btnSaveCon").addEventListener("click", saveCon);
document.getElementById("btnClearCon").addEventListener("click", clearConForm);

document.getElementById("btnConFindClient").addEventListener("click", conFindClient);
qs("#c_tecnologia")?.addEventListener("change", toggleModemBox);
document.getElementById("btnQASave").addEventListener("click", createClientFromQuick);
document.getElementById("btnQACancel").addEventListener("click", cancelQuickClient);
qs("#c_cf").addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ e.preventDefault(); conFindClient(); }});


document.getElementById("btnSaveDev").addEventListener("click", saveDev);
document.getElementById("btnClearDev").addEventListener("click", clearDevForm);

document.getElementById("btnSaveRip").addEventListener("click", saveRip);
document.getElementById("btnClearRip").addEventListener("click", clearRipForm);

document.getElementById("btnRunReport").addEventListener("click", runReport);

// Compleanni
document.getElementById("btnRunBirthdays").addEventListener("click", runBirthdays);
document.getElementById("btnExportBirthdaysCsv").addEventListener("click", exportBirthdaysCSV);

// Scadenze
document.getElementById("btnRunScadenze").addEventListener("click", runScadenze);
document.getElementById("btnExportScadenzeCsv").addEventListener("click", exportScadenzeCSV);

document.getElementById("btnResetReport").addEventListener("click", resetReport);
document.getElementById("btnTimeline").addEventListener("click", loadTimeline);

// Stampa ricevute
const btnPC=document.getElementById("btnPrintConReceipt");
if(btnPC){ btnPC.addEventListener("click", ()=>{ if(lastSaved.con) printReceipt("CONTRATTO", lastSaved.con); }); }
const btnPD=document.getElementById("btnPrintDevReceipt");
if(btnPD){ btnPD.addEventListener("click", ()=>{ if(lastSaved.dev) printReceipt("DEVICE", lastSaved.dev); }); }
const btnPR=document.getElementById("btnPrintRipReceipt");
if(btnPR){ btnPR.addEventListener("click", ()=>{ if(lastSaved.rip) printReceipt("RIPARAZIONE", lastSaved.rip); }); }


/* =========================
   Top actions
========================= */
function setLastSync(){ setText("lastSync", new Date().toLocaleString("it-IT")); }
function refreshAll(){
  setLastSync();
  renderDashboardAndConsole();
  renderAnag();
  renderCon();
  renderDev();
  renderRip();
  drawAllCharts();
  try{ runBirthdays(); }catch(e){}
  try{ runScadenze(); }catch(e){}
  toast("Refresh completato ‚úÖ", 1200);
}
document.getElementById("btnRefresh").addEventListener("click", ()=>{ saveStore(); refreshAll(); });
document.getElementById("btnSaveNow").addEventListener("click", ()=>{ saveStore(); toast("Salvato ‚úÖ"); });
document.getElementById("btnResetDemo").addEventListener("click", ()=>{
  seedDemo(); saveStore(); refreshAll(); toast("Demo ripristinata ‚úÖ");
});


/* =========================
   RICEVUTE / SCONTRINI (stampa)
========================= */
let lastSaved = { con:null, dev:null, rip:null };

function sanitizePhoneForWA(phone){
  let p = (phone||"").toString().trim();
  if(!p) return "";
  p = p.replace(/[^0-9+]/g,"");
  if(p.startsWith("+")) return p.replace("+","");
  // se non ha prefisso, aggiungi 39
  if(p.startsWith("00")) return p.slice(2);
  if(p.startsWith("39")) return p;
  return "39" + p;
}

function openReceiptWindow(title, html){
  const w = window.open("", "_blank", "width=420,height=720");
  if(!w){ toast("Popup bloccato: abilita popup per stampa ricevuta"); return; }
  w.document.open();
  w.document.write(`
    <!doctype html>
    <html><head><meta charset="utf-8"/>
    <title>${title}</title>
    <style>
      body{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;margin:14px;color:#0f172a}
      .paper{max-width:360px;margin:0 auto;border:1px dashed #cbd5e1;padding:12px}
      h1{font-size:14px;margin:0 0 6px 0;text-align:center}
      .muted{color:#64748b;font-size:11px;text-align:center;margin-bottom:10px}
      .row{display:flex;justify-content:space-between;gap:10px;font-size:12px;margin:3px 0}
      .k{color:#64748b}
      .hr{height:1px;background:#e5e7eb;margin:10px 0}
      .btns{display:flex;gap:8px;justify-content:center;margin-bottom:10px}
      button{border:none;border-radius:999px;padding:8px 10px;font-weight:800;cursor:pointer}
      .p{background:#2563eb;color:#fff}
      .s{background:#f1f5f9;color:#0f172a}
      @media print{ .btns{display:none} body{margin:0} .paper{border:none} }
    </style></head>
    <body>
      <div class="btns">
        <button class="p" onclick="window.print()">Stampa</button>
        <button class="s" onclick="window.close()">Chiudi</button>
      </div>
      <div class="paper">
        <h1>VOLPEX ‚Äì Ricevuta</h1>
        <div class="muted">${new Date().toLocaleString("it-IT")}</div>
        ${html}
      </div>
    </body></html>
  `);
  w.document.close();
}

function kv(k,v){
  const val = (v===null || v===undefined || v==="") ? "‚Äî" : String(v);
  return `<div class="row"><div class="k">${k}</div><div>${val}</div></div>`;
}

function printReceipt(type, id){
  let rec=null;
  if(type==="CONTRATTO"){ rec = contratti.find(x=>x.id===id); }
  if(type==="DEVICE"){ rec = device.find(x=>x.id===id); }
  if(type==="RIPARAZIONE"){ rec = riparazioni.find(x=>x.id===id); }
  if(!rec){ toast("Record non trovato"); return; }

  const cf = upper(rec.cf);
  const a = anagByCF(cf);
  const cliente = clienteNome(cf) || "‚Äî";
  const tel = a?.telefono || "";
  const email = a?.email || "";

  let body = "";
  body += kv("Tipo", type);
  body += kv("ID", id);
  body += kv("Cliente", cliente);
  body += kv("CF", cf);
  body += kv("Telefono", tel);
  body += kv("Email", email);
  body += `<div class="hr"></div>`;

  if(type==="CONTRATTO"){
    body += kv("Data contratto", rec.data_contratto || rec.data || "");
    body += kv("Compagnia", rec.compagnia || "");
    body += kv("Tecnologia", rec.tecnologia || "");
    body += kv("Tipo attivazione", rec.tipo_attivazione || "");
    body += kv("Numero lavorato", rec.numero_lavorato || "");
    body += kv("MNP", rec.mnp || "");
    body += kv("Prov. da", rec.compagnia_provenienza || "");
    body += kv("ICCID vecchio", rec.iccid_vecchio || "");
    body += kv("ICCID nuovo", rec.iccid_nuovo || "");
    body += `<div class="hr"></div>`;
    body += kv("Offerta", rec.nome_offerta || "");
    body += kv("Costo offerta", rec.costo_offerta || "");
    body += kv("Pagamento", rec.tipo_pagamento || "");
    body += kv("Vincolo (mesi)", rec.vincolo_offerta_mesi || "");
    body += kv("Convergenza", rec.convergenza || "");
    body += `<div class="hr"></div>`;
    body += kv("Telefono incluso", rec.telefono_incluso || "");
    body += kv("IMEI", rec.imei || "");
    body += kv("Marca", rec.marca || "");
    body += kv("Modello", rec.modello || "");
    body += kv("Vincolo tel (mesi)", rec.mesi_vincolo_telefono || "");
    body += kv("Rate tel (modo)", rec.modalita_pagamento_rate || "");
    body += kv("Anticipo", rec.anticipo || "");
    body += kv("Modem spedito da", rec.modem_spedito_da || "");
    body += kv("Venditore", rec.venditore || "");
  }else if(type==="DEVICE"){
    body += kv("Data vendita", rec.data || "");
    body += kv("Modello", rec.modello || "");
    body += kv("IMEI", rec.imei || "");
    body += kv("Prezzo", rec.prezzo || "");
    body += kv("Pagamento", rec.pagamento || "");
    body += kv("Venditore", rec.venditore || "");
  }else{
    body += kv("Data ingresso", rec.data_ingresso || "");
    body += kv("Modello", rec.modello || "");
    body += kv("IMEI", rec.imei || "");
    body += kv("Problema", rec.problema || "");
    body += kv("Stato", rec.stato || "");
    body += kv("Costo", rec.costo || "");
  }

  // CTA WhatsApp se telefono disponibile
  const wa = sanitizePhoneForWA(tel);
  if(wa){
    const msg = encodeURIComponent(`Ciao ${cliente}, ti invio la ricevuta ${type} (${id}). Grazie!`);
    body += `<div class="hr"></div>`;
    body += `<div class="row"><div class="k">WhatsApp</div><div><a href="https://wa.me/${wa}?text=${msg}" target="_blank">Apri chat</a></div></div>`;
  }

  openReceiptWindow(`Ricevuta ${type} ${id}`, body);
}

/* =========================
   BOOT
========================= */
(function boot(){
  const ok = loadStore();
  if(!ok){ seedDemo(); saveStore(); }
  qs("#c_data_contratto").value = todayISO();
  qs("#d_data").value = todayISO();
  qs("#r_ingresso").value = todayISO();
  syncValueSettingsUI();
  bindValueSettings();
  bindCampaignUI();
  renderCampaignSelect();
  refreshAll();
  // Dopo refresh, rigenera suggerimenti per avere score aggiornati
  try{ buildSmartSuggestions(); renderCampaignSelect(); }catch(e){}
})();


/* ===== RICEVUTA A4 (v24) - override stabile ===== */
const LOGO_DATA_URI = "data:image/jpeg;base64," +
  "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" +
  "buu2rifAf/Ix+LP+wkP/AEbd121ABRRRQB//2Q==";


function buildReceiptHTML(kind, rec){
  const cliente = (typeof byCF === "function") ? (byCF((rec?.cf)||"") || null) : null;

  const shop = {
    name: "SAGAM",
    tagline: "REPAIR ‚Ä¢ SMARTPHONE SHOP ‚Ä¢ ENERGY",
    address: "Indirizzo: ______________________________",
    phone: "Tel: __________________",
    email: "Email: __________________",
    socials: "Social: Instagram ______  Facebook ______  TikTok ______  Sito ______",
    thanks: "Grazie per aver scelto SAGAM! Per assistenza o informazioni contattaci ai recapiti sopra indicati.",
    privacy: "Informativa Privacy (GDPR): i dati personali sono trattati ai sensi del Reg. UE 2016/679 e normativa italiana applicabile esclusivamente per finalit√† contrattuali, amministrative e fiscali. L‚Äôinteressato pu√≤ esercitare i diritti previsti dagli artt. 15-22 GDPR contattando il Titolare ai recapiti indicati."
  };

  const fmt = (v)=> (v===undefined || v===null) ? "" : String(v);
  const line = (k,v)=> `<tr><td class="k">${k}</td><td class="v">${fmt(v)}</td></tr>`;
  const fullName = cliente ? `${fmt(cliente.cognome||"")} ${fmt(cliente.nome||"")}`.trim() : "";
  const cf = fmt(rec?.cf||"");
  const tel = cliente ? fmt(cliente.telefono||cliente.tel||"") : "";
  const stamp = new Date().toLocaleString();

  let rows = "";
  if(kind==="CONTRATTO"){
    rows += line("ID Contratto", rec.id);
    rows += line("Data contratto", rec.data_contratto||rec.data||"");
    rows += line("Tipo cliente", rec.tipo_cliente||"");
    rows += line("Compagnia", rec.compagnia||"");
    rows += line("Tecnologia", rec.tecnologia||"");
    rows += line("Tipo attivazione", rec.tipo_attivazione||"");
    rows += line("Numero lavorato", rec.numero_lavorato||"");
    rows += line("MNP", rec.mnp||"");
    rows += line("Compagnia provenienza", rec.compagnia_provenienza||rec.provenienza||"");
    rows += line("ICCID vecchio", rec.iccid_vecchio||"");
    rows += line("ICCID nuovo", rec.iccid_nuovo||"");
    rows += line("Nome offerta", rec.nome_offerta||"");
    rows += line("Costo offerta", rec.costo_offerta||"");
    rows += line("Tipo pagamento", rec.tipo_pagamento||"");
    rows += line("Vincolo (mesi)", rec.vincolo_offerta_mesi||"");
    rows += line("Convergenza", rec.convergenza||"");
    rows += line("Telefono incluso", rec.telefono_incluso||"");
    rows += line("IMEI", rec.imei||"");
    rows += line("Marca", rec.marca||"");
    rows += line("Modello", rec.modello||"");
    rows += line("Mesi vincolo telefono", rec.mesi_vincolo_telefono||"");
    rows += line("Pagamento rate telefono", rec.pagamento_rate||rec.modalita_rate||"");
    rows += line("Anticipo", rec.anticipo||"");
    rows += line("Note", rec.note||"");
  } else if(kind==="DEVICE"){
    rows += line("ID Device", rec.id);
    rows += line("Data", rec.data||rec.created_at||"");
    rows += line("Tipo", rec.tipo||"");
    rows += line("Marca", rec.marca||"");
    rows += line("Modello", rec.modello||"");
    rows += line("IMEI", rec.imei||"");
    rows += line("Prezzo", rec.prezzo||"");
    rows += line("Metodo pagamento", rec.pagamento||rec.tipo_pagamento||"");
    rows += line("Venditore", rec.venditore||"");
    rows += line("Note", rec.note||"");
  } else {
    rows += line("ID Riparazione", rec.id);
    rows += line("Data accettazione", rec.data||rec.data_accettazione||"");
    rows += line("Marca", rec.marca||"");
    rows += line("Modello", rec.modello||"");
    rows += line("IMEI", rec.imei||"");
    rows += line("Guasto", rec.guasto||"");
    rows += line("Preventivo", rec.preventivo||"");
    rows += line("Stato", rec.stato||"");
    rows += line("Consegna prevista", rec.data_consegna||"");
    rows += line("Note", rec.note||"");
  }

  return `<!doctype html><html><head><meta charset="utf-8" />
  <title>Ricevuta ${kind}</title>
  <style>
    @page { size: A4; margin: 12mm; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; color:#0f172a; }
    .noprint { position: sticky; top: 0; background: #fff; padding: 10px 0; z-index: 9; }
    .btn { padding: 9px 14px; border: 1px solid #e2e8f0; border-radius: 10px; background: #0f172a; color: #fff; font-weight: 800; cursor: pointer; }
    @media print { .noprint { display:none !important; } }

    .head { display:flex; gap:14px; align-items:center; border-bottom:2px solid #e2e8f0; padding-bottom:10px; }
    .logo { width: 160px; height:auto; }
    .meta h1 { margin:0; font-size:20px; }
    .meta .sub { color:#475569; font-size:12px; margin-top:2px; }
    .topgrid { display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-top:10px; }
    .card { border:1px solid #e2e8f0; border-radius:12px; padding:10px; }
    .card .t { font-weight:800; font-size:12px; color:#334155; margin-bottom:6px; text-transform:uppercase; letter-spacing:.04em; }
    table { width:100%; border-collapse:collapse; }
    td { border-bottom:1px solid #eef2f7; padding:7px 6px; vertical-align:top; font-size:12px; }
    td.k { width: 38%; color:#334155; font-weight:700; }
    .thanks { margin-top:10px; border-top:2px dashed #e2e8f0; padding-top:10px; font-size:12px; color:#334155; }
    .privacy { margin-top:10px; font-size:10.5px; color:#475569; line-height:1.35; }
    .foot { margin-top:8px; font-size:11px; color:#475569; }
  </style></head><body>
  <div class="noprint">
    <button class="btn" onclick="window.print()">Stampa / Salva PDF</button>
  </div>

  <div class="head">
    <img class="logo" src="${LOGO_DATA_URI}" alt="Logo" />
    <div class="meta">
      <h1>${shop.name} ‚Äî Ricevuta ${kind}</h1>
      <div class="sub">${shop.tagline}</div>
      <div class="sub">${shop.address} ‚Ä¢ ${shop.phone} ‚Ä¢ ${shop.email}</div>
      <div class="sub">${shop.socials}</div>
    </div>
  </div>

  <div class="topgrid">
    <div class="card">
      <div class="t">Cliente</div>
      <div style="font-size:12px;">
        <div><b>${fullName || "‚Äî"}</b></div>
        <div>CF: <b>${cf || "‚Äî"}</b></div>
        <div>Telefono: <b>${tel || "‚Äî"}</b></div>
      </div>
    </div>
    <div class="card">
      <div class="t">Dati ricevuta</div>
      <div style="font-size:12px;">
        <div>Stampata il: <b>${stamp}</b></div>
        <div>Operatore: <b>${fmt(rec?.venditore || rec?.operatore || "‚Äî")}</b></div>
        <div>Riferimento: <b>${fmt(rec?.id || "‚Äî")}</b></div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:12px;">
    <div class="t">Dettagli operazione</div>
    <table>${rows}</table>
  </div>

  <div class="thanks"><b>${shop.thanks}</b></div>
  <div class="privacy">${shop.privacy}</div>
  <div class="foot">Documento generato automaticamente. Conservare per eventuali necessit√†.</div>
</body></html>`;
}

function openReceiptPage(kind, rec){
  const html = buildReceiptHTML(kind, rec);
  const blob = new Blob([html], {type:"text/html;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const w = window.open(url, "_blank");
  if(!w){ alert("Popup bloccato: consenti l'apertura di nuove schede per stampare."); return; }
  setTimeout(()=>{ try{ URL.revokeObjectURL(url); }catch(e){} }, 20000);
}

// Override: la stampa ora apre una pagina A4 dedicata
function printReceipt(kind, rec){
  if(!rec){ toast("Nessun dato per la ricevuta"); return; }
  openReceiptPage(kind, rec);
}
/* ===== FINE RICEVUTA A4 (v24) ===== */


/* =========================
   BACKEND GOOGLE SHEETS (VOLPEX API) - v29
   - Imposta API_URL
   - Sync iniziale dati (anagrafica/contratti/device/riparazioni)
   - Wrapper salvataggi: quando salvi, invia al backend + risincronizza
   NOTE: se la dashboard √® aperta da file:/// (locale) il browser pu√≤ bloccare fetch.
         Consigliato: pubblicarla su GitHub Pages/Netlify/HTTPS.
   ========================= */
const API_URL = "https://script.google.com/macros/s/AKfycbzOQbt8M6-6PSLgKBR-vFwVnLUYMzYqiS1BXLL65bUNmiQnKZQnxS9pTeDgNECT0hYT/exec";
const USE_BACKEND = true;

async function apiGet(params){
  const url = API_URL + "?" + new URLSearchParams(params).toString();
  const res = await fetch(url, { method:"GET" });
  return await res.json();
}
async function apiPost(payload){
  const res = await fetch(API_URL, {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(payload)
  });
  return await res.json();
}

async function syncAllFromBackend() {
  if(!USE_BACKEND) return;
  try {
    const [a,c,d,r] = await Promise.all([
      apiGet({action:"list", entity:"anagrafica"}),
      apiGet({action:"list", entity:"contratti"}),
      apiGet({action:"list", entity:"device"}),
      apiGet({action:"list", entity:"riparazioni"}),
    ]);
    if(a?.ok && Array.isArray(a.rows)) window.anagrafica = a.rows;
    if(c?.ok && Array.isArray(c.rows)) window.contratti = c.rows;
    if(d?.ok && Array.isArray(d.rows)) window.device = d.rows;
    if(r?.ok && Array.isArray(r.rows)) window.riparazioni = r.rows;

    try{ if(typeof renderAll === "function") renderAll(); }catch(_){}
    try{ if(typeof renderDashboard === "function") renderDashboard(); }catch(_){}
    try{ if(typeof refreshTables === "function") refreshTables(); }catch(_){}
    try{ if(typeof renderAnagTable === "function") renderAnagTable(); }catch(_){}
    try{ if(typeof renderConTable === "function") renderConTable(); }catch(_){}
    try{ if(typeof renderDevTable === "function") renderDevTable(); }catch(_){}
    try{ if(typeof renderRipTable === "function") renderRipTable(); }catch(_){}
    try{ if(typeof renderReport === "function") renderReport(); }catch(_){}

    if(typeof toast === "function") toast("Sync completato ‚úÖ");
  } catch(err) {
    console.error(err);
    alert("Errore sync backend. Se stai usando file://, prova a pubblicare su HTTPS (GitHub Pages).\nDettaglio: " + err);
  }
}

async function backendGetCustomerByCF(cf){
  const res = await apiGet({action:"getCustomer", cf:(cf||"").toUpperCase()});
  return res?.customer || null;
}

/* ===== Override lookup cliente (se presente) ===== */
(function(){
  const oldByCF = (typeof byCF === "function") ? byCF : null;
  window.byCF = function(cf){
    const c = String(cf||"").trim().toUpperCase();
    if(oldByCF){
      const local = oldByCF(c);
      if(local) return local;
    } else if(Array.isArray(window.anagrafica)) {
      const local = window.anagrafica.find(x => String(x["Codice fiscale"]||x.cf||"").toUpperCase()===c);
      if(local) return local;
    }
    return null;
  };
})();

/* ===== Wrapper salvataggi: usa le action del backend ===== */
async function backendUpsertCustomer(customerObj){
  const res = await apiPost({action:"upsertCustomer", data: customerObj});
  if(!res?.ok) throw new Error(res?.error || "Errore upsertCustomer");
  return res.result;
}
async function backendCreateContract(contractObj){
  const res = await apiPost({action:"createContract", data: contractObj});
  if(!res?.ok) throw new Error(res?.error || "Errore createContract");
  return res.result;
}
async function backendCreateDevice(deviceObj, autoCreate=true){
  const res = await apiPost({action:"createDevice", data: deviceObj, autoCreate});
  if(!res?.ok) throw new Error(res?.error || "Errore createDevice");
  return res.result;
}
async function backendCreateRepair(repairObj, autoCreate=true){
  const res = await apiPost({action:"createRepair", data: repairObj, autoCreate});
  if(!res?.ok) throw new Error(res?.error || "Errore createRepair");
  return res.result;
}

function pickVal(id){
  const el = document.getElementById(id);
  if(!el) return "";
  return (el.value ?? "").toString().trim();
}

async function tryHookBackendSaves(){
  if(!USE_BACKEND) return;

  // Pulsante sync rapido
  try{
    const actions = document.querySelector(".pagehead__actions");
    if(actions && !document.getElementById("btnSyncBackend")){
      const b = document.createElement("button");
      b.id = "btnSyncBackend";
      b.className = "btn";
      b.textContent = "Sync";
      b.onclick = ()=>syncAllFromBackend();
      actions.appendChild(b);
    }
  }catch(_){}

  // ANAGRAFICA
  const btnA = document.getElementById("btnSaveAnag") || document.getElementById("btnSaveCustomer") || document.querySelector("[data-action='save-anag']");
  if(btnA && !btnA.dataset.backendHooked){
    btnA.dataset.backendHooked = "1";
    btnA.addEventListener("click", ()=>{
      setTimeout(async ()=>{
        try{
          const cf = (pickVal("anag_cf")||pickVal("cf")||pickVal("customerCF")).toUpperCase();
          const nome = pickVal("anag_nome")||pickVal("nome")||pickVal("customerNome");
          const cognome = pickVal("anag_cognome")||pickVal("cognome")||pickVal("customerCognome");
          if(cf && nome && cognome){
            await backendUpsertCustomer({
              "Codice fiscale": cf, "Nome": nome, "Cognome": cognome,
              "Telefono": pickVal("anag_tel")||pickVal("telefono"),
              "Email": pickVal("anag_email")||pickVal("email"),
              "Data nascita": pickVal("anag_dn")||pickVal("data_nascita"),
              "Citt√†": pickVal("anag_citta")||pickVal("citta"),
              "Indirizzo": pickVal("anag_indirizzo")||pickVal("indirizzo"),
              "CAP": pickVal("anag_cap")||pickVal("cap"),
              "Note": pickVal("anag_note")||pickVal("note")
            });
            await syncAllFromBackend();
          }
        }catch(err){ console.error(err); if(typeof toast==="function") toast("Backend: " + err.message); }
      }, 50);
    }, true);
  }

  // CONTRATTI
  const btnC = document.getElementById("btnSaveCon") || document.getElementById("btnSaveContract") || document.querySelector("[data-action='save-contract']");
  if(btnC && !btnC.dataset.backendHooked){
    btnC.dataset.backendHooked = "1";
    btnC.addEventListener("click", ()=>{
      setTimeout(async ()=>{
        try{
          const cf = (pickVal("con_cf")||pickVal("contr_cf")||pickVal("cf_contratto")||pickVal("cf")).toUpperCase();
          if(!cf) return;

          const existing = window.byCF(cf);
          if(!existing){
            const nome = pickVal("qc_nome")||pickVal("con_nome")||pickVal("nome");
            const cognome = pickVal("qc_cognome")||pickVal("con_cognome")||pickVal("cognome");
            if(nome && cognome){
              await backendUpsertCustomer({"Codice fiscale":cf,"Nome":nome,"Cognome":cognome,"Telefono":pickVal("qc_tel")||pickVal("telefono")});
            }
          }

          await backendCreateContract({
            "Codice fiscale": cf,
            "Data contratto": pickVal("con_data")||pickVal("data_contratto"),
            "Tipo cliente": pickVal("con_tipo_cliente")||pickVal("tipo_cliente"),
            "Tipo attivazione": pickVal("con_tipo_att")||pickVal("tipo_attivazione"),
            "Tecnologia": pickVal("con_tecnologia")||pickVal("tecnologia"),
            "Convergenza": pickVal("con_convergenza")||pickVal("convergenza"),
            "MNP": pickVal("con_mnp")||pickVal("mnp"),
            "Numero lavorato": pickVal("con_numero")||pickVal("numero_lavorato"),
            "Compagnia": pickVal("con_compagnia")||pickVal("compagnia"),
            "Compagnia di provenienza": pickVal("con_provenienza")||pickVal("compagnia_provenienza"),
            "ICCID_vecchio": pickVal("con_iccid_old")||pickVal("iccid_vecchio"),
            "ICCID_nuovo": pickVal("con_iccid_new")||pickVal("iccid_nuovo"),
            "Nome offerta": pickVal("con_offerta")||pickVal("nome_offerta"),
            "Costo offerta": pickVal("con_costo")||pickVal("costo_offerta"),
            "Vincolo offerta (mesi)": pickVal("con_vincolo")||pickVal("vincolo_offerta_mesi"),
            "Tipo pagamento": pickVal("con_tipo_pag")||pickVal("tipo_pagamento"),
            "Telefono incluso": pickVal("con_tel_incluso")||pickVal("telefono_incluso"),
            "IMEI": pickVal("con_imei")||pickVal("imei"),
            "Marca": pickVal("con_marca")||pickVal("marca"),
            "Modello": pickVal("con_modello")||pickVal("modello"),
            "Mesi vincolo telefono": pickVal("con_vincolo_tel")||pickVal("mesi_vincolo_telefono"),
            "Modalit√† pagamento rate telefono": pickVal("con_rate_pag")||pickVal("pagamento_rate"),
            "Anticipo": pickVal("con_anticipo")||pickVal("anticipo"),
            "Modem spedito da": pickVal("con_modem")||pickVal("modem_spedito_da"),
            "Note": pickVal("con_note")||pickVal("note")
          });

          await syncAllFromBackend();
        }catch(err){ console.error(err); if(typeof toast==="function") toast("Backend: " + err.message); }
      }, 80);
    }, true);
  }

  // DEVICE
  const btnD = document.getElementById("btnSaveDev") || document.getElementById("btnSaveDevice") || document.querySelector("[data-action='save-device']");
  if(btnD && !btnD.dataset.backendHooked){
    btnD.dataset.backendHooked = "1";
    btnD.addEventListener("click", ()=>{
      setTimeout(async ()=>{
        try{
          const cf = (pickVal("dev_cf")||pickVal("cf_device")||pickVal("cf")).toUpperCase();
          if(!cf) return;
          await backendCreateDevice({
            "Codice fiscale": cf,
            "Data": pickVal("dev_data")||pickVal("data"),
            "Tipo": pickVal("dev_tipo")||pickVal("tipo"),
            "Marca": pickVal("dev_marca")||pickVal("marca"),
            "Modello": pickVal("dev_modello")||pickVal("modello"),
            "IMEI": pickVal("dev_imei")||pickVal("imei"),
            "Prezzo": pickVal("dev_prezzo")||pickVal("prezzo"),
            "Metodo pagamento": pickVal("dev_pagamento")||pickVal("metodo_pagamento"),
            "Venditore": pickVal("dev_venditore")||pickVal("venditore"),
            "Note": pickVal("dev_note")||pickVal("note")
          }, true);
          await syncAllFromBackend();
        }catch(err){ console.error(err); if(typeof toast==="function") toast("Backend: " + err.message); }
      }, 80);
    }, true);
  }

  // RIPARAZIONI
  const btnR = document.getElementById("btnSaveRip") || document.getElementById("btnSaveRepair") || document.querySelector("[data-action='save-repair']");
  if(btnR && !btnR.dataset.backendHooked){
    btnR.dataset.backendHooked = "1";
    btnR.addEventListener("click", ()=>{
      setTimeout(async ()=>{
        try{
          const cf = (pickVal("rip_cf")||pickVal("cf_riparazione")||pickVal("cf")).toUpperCase();
          if(!cf) return;
          await backendCreateRepair({
            "Codice fiscale": cf,
            "Data accettazione": pickVal("rip_data")||pickVal("data_accettazione"),
            "Marca": pickVal("rip_marca")||pickVal("marca"),
            "Modello": pickVal("rip_modello")||pickVal("modello"),
            "IMEI": pickVal("rip_imei")||pickVal("imei"),
            "Guasto": pickVal("rip_guasto")||pickVal("guasto"),
            "Preventivo": pickVal("rip_prev")||pickVal("preventivo"),
            "Stato": pickVal("rip_stato")||pickVal("stato"),
            "Data consegna prevista": pickVal("rip_consegna")||pickVal("data_consegna"),
            "Note": pickVal("rip_note")||pickVal("note")
          }, true);
          await syncAllFromBackend();
        }catch(err){ console.error(err); if(typeof toast==="function") toast("Backend: " + err.message); }
      }, 80);
    }, true);
  }
}

document.addEventListener("DOMContentLoaded", async ()=>{
  await syncAllFromBackend();
  setTimeout(()=>{ tryHookBackendSaves(); }, 250);
});
</script>
</body>
</html>
